(window.webpackJsonp=window.webpackJsonp||[]).push([["desktop-feed-edgenext"],{"2H+z":function(e,t,i){"use strict";var s=i("yvDU"),n=i("rkDk"),a=i("wh7w"),r=i("btVS"),o=i("SEb4");t.a=function(e,t,i){var c=Object(o.a)(e)?s.a:r.a,d=arguments.length<3;return c(e,Object(a.a)(t,4),i,d,n.a)}},"5xIM":function(e,t,i){var s,n,a;n=[t,e],void 0===(a="function"==typeof(s=function(e,t){"use strict";var i=5e3,s="callback";function n(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function a(e){try{delete window[e]}catch(t){window[e]=void 0}}function r(e){var t=document.getElementById(e);t&&document.getElementsByTagName("head")[0].removeChild(t)}t.exports=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=e,c=t.timeout||i,d=t.jsonpCallback||s,l=void 0;return new Promise((function(i,s){var h=t.jsonpCallbackFunction||n(),u=d+"_"+h;window[h]=function(e){i({ok:!0,json:function(){return Promise.resolve(e)}}),l&&clearTimeout(l),r(u),a(h)},o+=-1===o.indexOf("?")?"?":"&";var g=document.createElement("script");g.setAttribute("src",""+o+d+"="+h),t.charset&&g.setAttribute("charset",t.charset),g.id=u,document.getElementsByTagName("head")[0].appendChild(g),l=setTimeout((function(){s(new Error("JSONP request to "+e+" timed out")),a(h),r(u),window[h]=function(){a(h)}}),c),g.onerror=function(){s(new Error("JSONP request to "+e+" failed")),a(h),r(u),l&&clearTimeout(l)}}))}})?s.apply(t,n):s)||(e.exports=a)},"6I6u":function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var s=i("D57K"),n=i("5Aq4"),a=i("tERu"),r=i("BQg2"),o=i("rvYQ"),c=i("VbA2"),d=i("msIb"),l=i("KETb"),h=i("XMfh"),u=i("HxRh"),g=i("ac9z"),p=i("u5KZ"),m=i("/+Un");class f{constructor(e){this.config=e}fetch(e){return Object(s.b)(this,void 0,void 0,(function*(){let t=this.config.initialRequest;if(e&&(t=Object.assign(Object.assign({},t),e)),!t)return p.a.sendAppErrorEvent(Object.assign(Object.assign({},u.sh),{message:"default SDService fetch configuration was invalid"})),this.responseStatus=h.a.InvalidRequest,{status:this.responseStatus,cards:void 0};return yield this.fetchSDCards(t)}))}fetchSDCards(e){return Object(s.b)(this,void 0,void 0,(function*(){const t={credentials:"include",headers:yield d.a.getOneServiceFeedCallHeaders(),method:"GET"},i=new URL(n.m,n.b),f=Object(g.b)();this.requestQueryParams=new r.a,Object(n.q)(e,this.requestQueryParams);const b=(yield Object(m.d)())===a.c.SignedIn?d.a.getOneServiceParamsWithAuth(o.b.UserId,e.ocid,!1):d.a.getOneServiceParamsWithoutAuth(o.b.UserId,e.ocid,!1);for(let e=0;e<b.length;e++)this.requestQueryParams.set(b[e].key,b[e].value);let v;o.b.SendFeedCallActivityIdInHeader&&this.requestQueryParams.delete(n.o.activityId),this.requestQueryParams.set(n.o.market,o.b.CurrentMarket),f>0&&this.requestQueryParams.set(g.a,f.toString()),this.requestQueryParams.get("$top")||this.requestQueryParams.set("$top","1"),this.requestQueryParams.get("User")||(this.requestQueryParams.set("User",o.b.UserId),this.requestQueryParams.delete(n.o.user)),i.search=this.requestQueryParams.toString();try{const e=1e4,n=yield Object(l.a)(()=>Object(s.b)(this,void 0,void 0,(function*(){return yield Object(c.a)(decodeURIComponent(i.href),e,t)})),"SDCardProvider.fetch");if(!n||!n.ok){const e=n?`SDService returned error response. status: ${n.status} - ${n.statusText}`:"SDService response was null";return p.a.sendAppErrorEvent(Object.assign(Object.assign({},u.uh),{message:e,pb:Object.assign(Object.assign({},u.uh.pb),{customMessage:`ServiceUrl: [${i.href}], requestHeaders: [${JSON.stringify(t&&t.headers)}]`})})),void(this.responseStatus=h.a.Failed)}v=yield n.json()}catch(e){return p.a.sendAppErrorEvent(Object.assign(Object.assign({},u.th),{message:"Error while fetching SDService response",pb:Object.assign(Object.assign({},u.th.pb),{customMessage:`Error: ${e} serviceUrl: ${i.href} headers: ${JSON.stringify(t.headers)} activityId: ${o.b.ActivityId}`})})),void(this.responseStatus=h.a.Failed)}return v&&v.cards&&v.cards.length>0?this.responseStatus=h.a.Success:this.responseStatus=h.a.NoContent,v}))}}},"7oW3":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var s=i("G82u");class n{}function a(){n.updateLocationDisplayName.unregisterObservers(),n.fetchWeatherSummarySuccess.unregisterObservers(),n.fetchWeatherSummaryFailure.unregisterObservers(),n.patchHourlyForecastSuccess.unregisterObservers(),n.updateLocationDetectionState.unregisterObservers(),n.updateWeatherUserProfile.unregisterObservers(),n.updateCurrentLocation.unregisterObservers(),n.updateWeatherSettings.unregisterObservers(),n.updateNonmapComponmentsReadiness.unregisterObservers(),n.updateOperationFailure.unregisterObservers(),n.updateFallbackStatus.unregisterObservers(),n.updateOverviewRequestDuration.unregisterObservers(),n.updateHyperlocal.unregisterObservers()}n.updateLocationDisplayName=new s.a("UpdateLocationDisplayName"),n.fetchWeatherSummarySuccess=new s.a("FetchWeatherSummarySuccess"),n.fetchWeatherSummaryFailure=new s.a("FetchWeatherSummaryFailure"),n.patchHourlyForecastSuccess=new s.a("FetchHourlyForecastSuccess"),n.updateLocationDetectionState=new s.a("UpdateLocationDetectionState"),n.updateWeatherUserProfile=new s.a("UpdateWeatherUserProfile"),n.updateCurrentLocation=new s.a("UpdateCurrentLocation"),n.updateWeatherSettings=new s.a("UpdateWeatherSettings"),n.updateNonmapComponmentsReadiness=new s.a("UpdateNonmapComponmentsReadiness"),n.updateOperationFailure=new s.a("updateOperationFailure"),n.updateFallbackStatus=new s.a("updateFallbackStatus"),n.updateOverviewRequestDuration=new s.a("updateOverviewRequestDuration"),n.updateHyperlocal=new s.a("updateHyperlocal")},"8+qV":function(e,t){},"8ntK":function(e,t,i){"use strict";var s;i.d(t,"a",(function(){return s})),function(e){e.Save="Save",e.Mute="Mute",e.Follow="Follow",e.Unfollow="Unfollow",e.InterestFailure="InterestFailure",e.ShowMore="ShowMore",e.ShowFewer="ShowFewer",e.Hide="Hide",e.DisableNotification="DisableNotification",e.EnableNotification="EnableNotification"}(s||(s={}))},Cj5D:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return d}));var s,n,a=i("C4R5"),r=i("HS3Q"),o=i("+qLX"),c=i("w0HK");function d(e,t){e&&t?Object(a.a)().pushHistory(r.b.Personalize,"",{isRequestFromSdCardAddRemoveClick:!0}):e&&Object(c.a)().switchPivot({pivotId:e.pivotId,configIndexHref:e.configIndexHref,configIndexRef:e.configIndexRef,context:{isRequestFromSdCardAddRemoveClick:!0},telemetryPageName:o.a.Interests,display:e.displayName})}!function(e){e.SwitchToPageSettings="SwitchToPageSettings",e.SwitchToNewsSettingsInPersonalizePivot="SwitchToNewsSettingsInPersonalizePivot"}(s||(s={})),function(e){e.edgePageSettings="EdgePageSettings",e.chromiumPageSettings="ChromiumPageSettings",e.proActiveCanvasSettingHandler="ProActiveCanvasHandler",e.localStorageSettings="LocalStorageSettings"}(n||(n={}))},Cn94:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var s,n=i("G82u");!function(e){e.SaveCard="SaveCard",e.UnsaveCard="UnsaveCard",e.HideCard="HideCard",e.UnhideCard="UnhideCard"}(s||(s={}));class a{}a.Init=new n.a("Init"),a.DisableMenu=new n.a("DisableMenu")},FfXy:function(e,t,i){"use strict";var s;i.d(t,"a",(function(){return s})),function(e){e[e.none=0]="none",e[e.enabled=1]="enabled",e[e.saved=2]="saved",e[e.hide=4]="hide",e[e.showMore=8]="showMore",e[e.showFewer=16]="showFewer",e[e.mute=32]="mute",e[e.hidden=64]="hidden",e[e.report=128]="report",e[e.adFeedbackSubmitted=256]="adFeedbackSubmitted"}(s||(s={}))},HFPz:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var s=i("D57K"),n=i("KHt8"),a=i("P4Ao"),r=i("QBS5"),o=i("oePG");class c extends n.b{constructor(){super(...arguments),this.addCloseButton=!1,this.handleCloseButton=()=>{this.hidden=!0,this.sourceLink="",this.$emit("bing-video-embed-player_close-player")}}}Object(s.e)([r.b],c.prototype,"sourceLink",void 0),Object(s.e)([r.b],c.prototype,"addCloseButton",void 0),Object(s.e)([o.d],c.prototype,"closeButtonAriaLabel",void 0),Object(s.e)([o.d],c.prototype,"closeButtonTelemetryTag",void 0),Object(s.e)([o.d],c.prototype,"videoEmbedPlayerHeight",void 0),Object(s.e)([o.d],c.prototype,"videoEmbedPlayerWidth",void 0);const d=i("4X57").a`
fluent-dialog::part(control) {
    padding: 0;
    display: flex;
    flex-direction: column;
    position: relative;
}

fluent-dialog::part(positioning-region) {
    z-index: 700;
}

.bing-iframe-player {
    width: 100%;
    height: 100%;
    overflow: hidden;
    border-radius: calc(var(--elevated-corner-radius) * 1px);
}

.close-button {
    position: absolute;
    top: 12px;
    right: 12px;
    align-items: center;
    width: 32px;
    height: 32px;
    border-radius: 20px;
    backdrop-filter: blur(4px);
    background: rgba(255, 255, 255, 0.08);
    fill: #ffffff;
    fill-opacity: 0.7;
}

.close-button:hover {
    background: rgba(255, 255, 255, 0.18);
    fill-opacity: 1;
}
`;var l=i("m1Vi"),h=i("6BDD"),u=i("6vBc"),g=i("eUhr");l.b,n.b;const p=h.b`
<style>
    fluent-dialog::part(control) {
        width: ${e=>e.videoEmbedPlayerWidth};
        height: ${e=>e.videoEmbedPlayerHeight};
    }
</style>
<fluent-dialog ?hidden=${e=>e.hidden}>
    ${Object(u.a)(e=>e.addCloseButton,h.b`
        <fluent-button
            tabindex="0"
            appearance="stealth"
            class="close-button"
            part="close-button"
            aria-label=${e=>e.closeButtonAriaLabel}

            @click=${e=>e.handleCloseButton()}
            @keypress=${e=>e.handleCloseButton()}
            ${Object(g.b)(e=>e.closeButtonTelemetryTag)}
        >
            <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M14.1016 1.60156L8.20312 7.5L14.1016 13.3984L13.3984 14.1016L7.5 8.20312L1.60156 14.1016L0.898438 13.3984L6.79688 7.5L0.898438 1.60156L1.60156 0.898438L7.5 6.79688L13.3984 0.898438L14.1016 1.60156Z"
                ></path>
            </svg>
        </fluent-button>
    `)}
    <iframe
        src=${e=>e.sourceLink}
        class="bing-iframe-player"
        frameborder="0"
    />
</fluent-dialog>
`;let m=class extends c{};m=Object(s.e)([Object(a.b)({name:"msn-bing-video-embed-player",template:p,styles:[n.a,d]})],m)},HcI6:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var s=i("D57K"),n=i("/FrS"),a=i("X9Vi"),r=i("u8F0"),o=i("CgWR"),c=i("hSGL"),d=i("XlyT"),l=i("HxRh"),h=i("I6Lx"),u=i("xYH4");function g(e){return!!e&&"null"!==e&&"undefined"!==e&&"false"!==e}function p(e,t){return new Date(t.updatedDateTime).valueOf()-new Date(e.updatedDateTime).valueOf()}class m{constructor(){this.PdpDefaultLocation="DefaultLocation",this.PdpFavoriteLocation="FavoriteLocation",this.instance=c.a}read(){return Object(s.b)(this,void 0,void 0,(function*(){let e=null;try{const t=yield this.instance.readPdpWithTargetType(r.a.Location),{value:i=[]}=t||{value:[]};e=this.convertPdpDataToPdpResponse(i)}catch(e){Object(d.c)(e,l.Vj,"Weather PDP Read Failed")}if(!e)try{const t=yield this.instance.getPdpUserPreference(),{value:i=[]}=t||{value:[]};e=this.parseUserProfileFromPdpData(i)}catch(e){Object(d.c)(e,l.Vj,"Weather PDP User Read Failed")}return e||{}}))}setDisplayUnit(e){return Object(s.b)(this,void 0,void 0,(function*(){let t=!1;try{t=yield this.instance.updateWeatherSettings(e.toString(),null)}catch(e){Object(d.c)(e,l.Tj,"Display unit Update failed"),t=!1}return t}))}updateUserSettings(e,t,i){return Object(s.b)(this,void 0,void 0,(function*(){let s=!1;try{s=yield this.instance.updateWeatherSettings(e,t,i)}catch(e){Object(d.c)(e,l.Wj,"Weather user settings update failed"),s=!1}return s}))}enableDisableWeatherCard(e){return Object(s.b)(this,void 0,void 0,(function*(){let t=!1;try{t=yield this.instance.updateSegmentCardsEnableStatus([{cardType:o.a.WeatherCard,enabled:e}])}catch(i){Object(d.c)(i,l.Wj,(e?"Enable":"Disable")+" weather segment card failed"),t=!1}return t}))}setHomeLocation(e,t){return Object(s.b)(this,void 0,void 0,(function*(){let i=!1;try{i=yield this.instance.updatePdpHomeLocation(m.buildMetaData(e),`${e.latitude},${e.longitude}`,t)}catch(e){Object(d.c)(e,l.Uj,"Home Location Update Failed"),i=!1}return i}))}addFavoriteLocation(e){return Object(s.b)(this,void 0,void 0,(function*(){const t=`${e.latitude},${e.longitude}`;return yield this.instance.addToFavoriteLocation(m.buildMetaData(e),t)}))}removeFavoriteLocation(e){return Object(s.b)(this,void 0,void 0,(function*(){const t=e.definitionName||`${e.latitude},${e.longitude}`,i=yield this.instance.removeFavoriteLocation(t);return i&&(e.definitionName=null),i}))}convertPdpDataToPdpResponse(e){if(e&&e[0]){const t=e.filter(e=>e.degree===this.PdpDefaultLocation).sort(p)[0],i=m.parseLocationFromPdpValue(t);return i&&(i.from=n.e.HomeFromPdp,i.displayName=a.b.getDisplayName(i)),Object.assign(Object.assign({},m.parseUnitAndMode(t)),{home:i,favorites:e.filter(e=>e.degree===this.PdpFavoriteLocation).map(m.parseLocationFromPdpValue).filter(e=>!!e),recents:void 0})}return null}parseUserProfileFromPdpData(e){if(e&&e[0]){const t=e.find(e=>e.weatherDisplayUnit);if(!(t&&(t.weatherDisplayUnit||t.userSettings&&t.userSettings.weatherLocationSettingMode)))return null;let i=void 0;t.weatherDisplayUnit&&(i="2"===t.weatherDisplayUnit?n.g.Celsius:n.g.Fahrenheit);let s=void 0;return t.userSettings&&t.userSettings.weatherLocationSettingMode&&(s="2"===t.userPreference.userSettings.weatherLocationSettingMode?n.a.SpecifyLocation:n.a.DetectCurrentLocation),{home:void 0,unit:i,locationMode:s,favorites:void 0,recents:void 0}}return null}static buildMetaData(e){const t=e.language||h.b.Locale||"";return JSON.parse(JSON.stringify({geoCoordinates:{latitude:parseFloat(e.latitude),longitude:parseFloat(e.longitude)},addressLine:e.addressLine,subRegion:e.subRegion,readLink:e.readLink,city:e.locality,state:e.region,countryRegion:e.country,postalCode:e.postalCode,isoCode:e.isoCode,locationType:"number"==typeof e.locationType?e.locationType||1:Object(u.a)(""+e.locationType,1),locationTypeId:[e.locality,e.region,e.country].filter(e=>!!e).join(","),language:t||void 0}))}static parseUnitAndMode(e){let t=0,i=0;return e&&e.metadata&&("2"!==e.metadata.displayunit&&"1"!==e.metadata.displayunit||(t="2"===e.metadata.displayunit?n.g.Celsius:n.g.Fahrenheit),"1"!==e.metadata.locationSettingMode&&"2"!==e.metadata.locationSettingMode||(i="1"===e.metadata.locationSettingMode?n.a.DetectCurrentLocation:n.a.SpecifyLocation)),{unit:t,locationMode:i}}static parseLocationFromPdpValue(e){let t=null;if(e&&e.definitionName&&e.metadata){t={latitude:e.definitionName.split(",")[0],longitude:e.definitionName.split(",")[1],addressLine:g(e.metadata.addressLine)?e.metadata.addressLine:void 0,locality:g(e.metadata.city)?e.metadata.city:void 0,subRegion:g(e.metadata.subRegion)?e.metadata.subRegion:void 0,region:g(e.metadata.state)?e.metadata.state:void 0,country:g(e.metadata.countryRegion)?e.metadata.countryRegion:void 0,displayName:"",isoCode:g(e.metadata.isoCode)?e.metadata.isoCode:void 0,locationTypeId:e.metadata.locationTypeId,postalCode:e.metadata.postalCode,language:(e.metadata.language||a.b.extractLanguageTag(e.metadata.locationTypeId)||h.b.Locale).toLocaleLowerCase(),definitionName:e.definitionName,readLink:g(e.metadata.readLink)?e.metadata.readLink:void 0},t.region=a.d.abbreviateUSState(t.region,t.language,t.isoCode),t.locationType=1,"number"!=typeof e.metadata.locationType&&void 0!==e.metadata.locationType||(t.locationType=e.metadata.locationType||1),"string"==typeof e.metadata.locationType&&g(e.metadata.locationType)&&(t.locationType=Object(u.a)(""+e.metadata.locationType,1));const i=e.metadata.geoCoordinates;!i||0===i.latitude&&0===i.longitude||(t.latitude=""+i.latitude,t.longitude=""+i.longitude),t.addressLine||t.locality||t.region||(t=null),t&&!a.b.isValid(t)&&(t=null),t&&"0"===t.latitude&&"0"===t.longitude&&(e.metadata.name||e.metadata.countryRegion||e.metadata.city||e.metadata.state||(t=null))}return t}}},JFdr:function(e,t,i){"use strict";var s=Math.floor,n=Math.random;t.a=function(e,t){return e+s(n()*(t-e+1))}},KPQt:function(e,t,i){"use strict";var s=i("XAMW"),n=i("b8Mt"),a=i("wh7w");t.a=function(e,t){return Object(s.a)(e,Object(a.a)(t,3),n.a)}},KmUD:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return a})),i.d(t,"e",(function(){return g})),i.d(t,"f",(function(){return p})),i.d(t,"c",(function(){return m})),i.d(t,"d",(function(){return f})),i.d(t,"k",(function(){return b})),i.d(t,"g",(function(){return v})),i.d(t,"j",(function(){return y})),i.d(t,"i",(function(){return C})),i.d(t,"h",(function(){return S}));var s,n,a,r=i("YJhp"),o=i("Am8i"),c=i("dMmp"),d=i("uZl+"),l=i("kpPY"),h=i("XgsJ"),u=i("vhqU");!function(e){e.Email="email",e.Facebook="facebook",e.Line="line",e.LinkedIn="linkedin",e.Skype="skype",e.Twitter="twitter",e.VK="vk",e.WhatsApp="whatsapp"}(s||(s={})),function(e){e.Share="share",e.Mute="mute",e.Report="report",e.ReportAd="reportad"}(n||(n={})),function(e){e.Hide="Hide",e.Like="Like",e.Dislike="Dislike",e.Mute="Mute",e.Save="Save",e.Share="Share",e.ShowMore="ShowMore",e.ShowFewer="ShowFewer",e.Divider="Divider",e.Report="Report",e.ReportAd="ReportAd",e.AdPrivacy="AdPrivacy"}(a||(a={}));const g=e=>({[a.Save]:{title:e.localizedStrings.cardActionMenuItemSave,glyph:r.b.Save,undoGlyph:r.a.Saved,onClickPropKey:a.Save,undoText:e.localizedStrings.cardActionMenuItemUndoSave,key:a.Save,telemetryName:d.b.saveMenuItemTelemetryName,telemetryBehavior:o.c.Save,telemetryType:o.f.ActionButton,undoTelemetryType:o.f.ActionButton},[a.Share]:{title:e.localizedStrings.cardActionMenuItemShare,glyph:r.b.Share,onClickPropKey:a.Save,key:a.Share,telemetryName:d.b.shareDialogTelemetryName,telemetryBehavior:o.c.Share,telemetryType:o.f.ActionButton},[a.ShowMore]:{title:e.localizedStrings.cardActionMenuItemShowMore,glyph:r.b.ThumbUp,undoGlyph:r.b.ThumbUpBlue,onClickPropKey:a.ShowMore,undoText:e.localizedStrings.cardActionMenuItemUndoShowMore,key:a.ShowMore,telemetryName:d.b.showMoreMenuItemTelemetryName,telemetryBehavior:o.c.Like,telemetryType:o.f.ActionButton,telemetryContentHeadline:d.b.showMoreHeadlineTelemetryName,undoTelemetryType:o.f.ActionButton},[a.ShowFewer]:{title:e.localizedStrings.cardActionMenuItemShowFewer,glyph:r.b.ThumbDown,undoGlyph:r.b.ThumbDownBlue,onClickPropKey:a.ShowFewer,undoText:e.localizedStrings.cardActionMenuItemUndoShowFewer,key:a.ShowFewer,telemetryName:d.b.showFewerMenuItemTelemetryName,telemetryBehavior:o.c.Dislike,telemetryType:o.f.ActionButton,telemetryContentHeadline:d.b.showFewerHeadlineTelemetryName,undoTelemetryType:o.f.ActionButton},[a.Hide]:{title:e.localizedStrings.cardActionMenuItemHide,glyph:r.b.HideStory,onClickPropKey:a.Save,key:a.Hide,telemetryName:d.b.hideMenuItemTelemetryName,telemetryBehavior:o.c.Hide,telemetryType:o.c.Hide,telemetryContentHeadline:d.b.hideHeadlineTelemetryName},[a.Mute]:{title:e.localizedStrings.cardActionMenuItemMute,glyph:r.b.Hide,onClickPropKey:a.Save,key:a.Mute,telemetryName:d.b.muteMenuItemTelemetryName,telemetryBehavior:o.c.Mute,telemetryType:o.c.Mute},[a.Report]:{title:e.localizedStrings.cardActionMenuItemReport,glyph:r.b.Flag,onClickPropKey:a.Report,key:a.Report,telemetryName:d.b.reportMenuItemTelemetryName,telemetryBehavior:o.c.Report,telemetryType:o.f.ActionButton,telemetryContentHeadline:d.b.reportHeadlineTelemetryName},[a.ReportAd]:{title:e.localizedStrings.cardActionMenuItemReportAd,glyph:r.b.Flag,onClickPropKey:a.ReportAd,key:a.ReportAd}}),p=(e,t,i,n)=>({[s.Email]:{tooltip:Object(l.a)(e.localizedStrings.socialMediaEmailAriaLabel,e.localizedStrings.socialMediaEmailLabel),backgroundColor:"#0078D7",image:{alt:e.localizedStrings.socialMediaEmailLabel,src:r.a.Mail},source:e.localizedStrings.socialMediaEmailLabel,target:"_self",href:c.String.Format("mailto:?subject={title}&body={body}",{title:encodeURIComponent(i),body:encodeURIComponent(Object(l.a)(e.localizedStrings.shareDialogEmailBodyText,i,t))}),telemetryTag:n&&n[s.Email]},[s.Facebook]:{tooltip:Object(l.a)(e.localizedStrings.socialMediaIconsAriaLabel,"Facebook"),backgroundColor:"#4267B2",image:{alt:"Facebook",src:r.a.Facebook},source:"Facebook",target:"_blank",href:c.String.Format("https://www.facebook.com/sharer.php?u={url}&amp;t={title}",{url:encodeURIComponent(t),title:encodeURIComponent(i)}),telemetryTag:n&&n[s.Facebook]},[s.LinkedIn]:{tooltip:Object(l.a)(e.localizedStrings.socialMediaIconsAriaLabel,"LinkedIn"),backgroundColor:"#0083BE",image:{alt:"LinkedIn",src:r.a.LinkedIn},source:"LinkedIn",target:"_blank",href:c.String.Format("https://www.linkedin.com/shareArticle?mini=true&url={url}&title={title}&source={refererUrl}",{url:encodeURIComponent(t),title:encodeURIComponent(i),refererUrl:Object(h.l)()}),telemetryTag:n&&n[s.LinkedIn]},[s.Skype]:{tooltip:Object(l.a)(e.localizedStrings.socialMediaIconsAriaLabel,"Skype"),backgroundColor:"#33BFFC",image:{alt:"Skype",src:r.a.Skype},source:"Skype",target:"_blank",href:c.String.Format("https://web.skype.com/share?url={url}&flow_id={flowid}&source=msn",{url:encodeURIComponent(t),flowid:Object(u.a)()}),telemetryTag:n&&n[s.Skype]},[s.Twitter]:{tooltip:Object(l.a)(e.localizedStrings.socialMediaIconsAriaLabel,"Twitter"),backgroundColor:"#20A2F2",image:{alt:"Twitter",src:r.a.Twitter},source:"Twitter",target:"_blank",href:c.String.Format("https://twitter.com/share?url={url}&text={title}&original_referer={refererUrl}",{url:encodeURIComponent(t),title:encodeURIComponent(i),refererUrl:Object(h.l)()}),telemetryTag:n&&n[s.Twitter]},[s.WhatsApp]:{tooltip:Object(l.a)(e.localizedStrings.socialMediaIconsAriaLabel,"WhatsApp"),backgroundColor:"#25D366",image:{alt:"WhatsApp",src:r.a.WhatsApp},source:"WhatsApp",target:"_blank",href:c.String.Format("https://web.whatsapp.com/send?text={url}",{url:encodeURIComponent(t)}),telemetryTag:n&&n[s.WhatsApp]}}),m={personalize:"Personalize",myInterests:"MyInterests"},f=5e3,b="/{locale}/feed/personalize#mutedPublishers",v="{locale}",y="https://www.msn.com",C="https://go.microsoft.com/fwlink/?LinkId=521839",S="https://petrol.office.microsoft.com/v1/feedback"},OTRt:function(e,t,i){"use strict";var s,n;i.d(t,"a",(function(){return s})),function(e){e.CardView="cardview",e.FlatView="flatview"}(s||(s={})),function(e){e.t3="T3",e.t6="T6"}(n||(n={}))},Qo3E:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));class s{static renderToast(e){this.renderToastCallback&&this.renderToastCallback(e)}static setRenderToastCallback(e){this.renderToastCallback=e}static expireToast(e){this.expireToastCallback&&this.expireToastCallback(e)}static setExpireToastCallback(e){this.expireToastCallback=e}static setCurrentToast(e,t){this.currentToastId!==e&&(this.currentToastId=e,this.renderToastCallback=t,this.currentToastIdChangeCallbacks.forEach(t=>t(e)),this.renderToast())}static addCurrentToastIdChangeCallback(e){e&&this.currentToastIdChangeCallbacks.push(e)}}s.currentToastIdChangeCallbacks=[]},XAMW:function(e,t,i){"use strict";t.a=function(e,t,i){var s;return i(e,(function(e,i,n){if(t(e,i,n))return s=i,!1})),s}},bYbF:function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));var s,n=i("D57K"),a=i("KmUD"),r=i("ypwz"),o=i("tERu"),c=i("HxRh"),d=i("XlyT");!function(e){e[e.feedbackDefault=2224]="feedbackDefault",e[e.windowsFeed=2475]="windowsFeed"}(s||(s={}));class l{constructor(){this.manifestType="Sas",this.appId=s.feedbackDefault,this.source="Client",this.type="Idea"}}var h=i("I6Lx"),u=i("rvYQ"),g=i("1I/+"),p=i("u5KZ"),m=i("6ADy"),f=i("msIb"),b=i("KETb"),v=i("k112"),y=i("KUTD"),C=i("Qo3E"),S=i("8ntK"),O=i("/+Un"),A=i("FfXy"),I=i("4L2h"),w=i("r6MD"),R=i("ac9z");class T{constructor(e,t){this.fetchImpl=e,this.enableEnterpriseOCID=t,this.providersServiceEndpoint="./Msn/Providers",this.cardActionV2sServiceEndpoint="./Graph/Actions",this.userFeedbackEventhubUrl="/labs/api/feedbackSignal",this.ocid="feeds"}ShowFewer(e){return Object(n.b)(this,void 0,void 0,(function*(){return this.PostCardActionV2Request(e,a.a.Dislike,null)}))}UnshowFewer(e){return Object(n.b)(this,void 0,void 0,(function*(){return this.DeleteCardActionV2Request(e,a.a.Dislike)}))}ShowMore(e){return Object(n.b)(this,void 0,void 0,(function*(){return this.PostCardActionV2Request(e,a.a.Like)}))}UnshowMore(e){return Object(n.b)(this,void 0,void 0,(function*(){return this.DeleteCardActionV2Request(e,a.a.Like)}))}Save(e){return Object(n.b)(this,void 0,void 0,(function*(){return this.PostCardActionV2Request(e,a.a.Save)}))}Unsave(e){return Object(n.b)(this,void 0,void 0,(function*(){return this.DeleteCardActionV2Request(e,a.a.Save)}))}Hide(e){return Object(n.b)(this,void 0,void 0,(function*(){return this.PostCardActionV2Request(e,a.a.Dislike,null)}))}Unhide(e){return Object(n.b)(this,void 0,void 0,(function*(){return this.DeleteCardActionV2Request(e,a.a.Dislike)}))}Mute(e){return Object(n.b)(this,void 0,void 0,(function*(){return this.PostCardActionV2Request(e,a.a.Mute,"SourceProvider")}))}Report(e,t,i,s){return Object(n.b)(this,void 0,void 0,(function*(){const n=h.b.ClientSettings?h.b.ClientSettings.aid:"";let a="";const o={serviceType:"oneservice",oneServiceTraceId:"",oneServiceActivityId:n};u.b.AppType===r.a.Windows&&(a=p.a.getPageMetadata().JoinIdProps.IDXId,o.oneServiceTraceId="",o.oneServiceActivityId=n),p.a.sendTraceInfoEvent(o);const d=this.createOcvFeedbackData(e,t,i,s);this.reportFeedbackToOcv(d);const l=JSON.stringify({article:{id:e},canvas:{name:u.b.AppType,version:navigator.userAgent,pageType:h.b.ClientSettings.pagetype},data:{activityId:n,feedbackTags:t,feedbackText:i},appEnvironment:u.b,clientSettings:h.b.ClientSettings,extSchema:o}),g=Object(m.c)().origin+this.userFeedbackEventhubUrl,b={method:"POST",headers:yield f.a.getOneServiceHeaders(),body:l,credentials:"include"};let v;try{if(v=yield fetch(g,b),v.status>=400)throw new Error(v.statusText)}catch(e){p.a.sendAppErrorEvent(Object.assign(Object.assign({},c.ob.CardActionPostActionError),{message:"Error while posting action for card action",pb:Object.assign(Object.assign({},c.ob.CardActionPostActionError.pb),{customMessage:`url: ${g}, error: ${e}`})}))}return v}))}reportFeedbackToOcv(e){return Object(n.b)(this,void 0,void 0,(function*(){const t={method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};try{const e=yield this.fetchImpl(a.h,t);if(!e.ok){const i=`Error code: ${e.status} Error message: ${e.statusText} Request params: ${t} Service url: ${a.h}`;return Object(d.b)(c.ob.CardActionBadRequestReportingToOcv,"Request is not valid, it has no content, or the manifest is not formatted correctly",i),!1}return!0}catch(e){const i=`Error code: ${e?e.code:"undefined"} Error message: ${e?e.message:"undefined"} Request params: ${t} Service url: ${a.h}`;return Object(d.c)(e,c.ob.CardActionExceptionReportingToOcv,"Exception reporting feedback to OCV",i),!1}}))}createOcvFeedbackData(e,t,i,n){var a,o,c,d;const p=new l,m=null===h.b||void 0===h.b?void 0:h.b.ClientSettings,f=null===u.b||void 0===u.b?void 0:u.b.HostPage,b=Object(g.b)(n.data.locationHref,"locationHref"),v=(null==m?void 0:m.aid)||"",y=(null===(o=null===(a=null===u.b||void 0===u.b?void 0:u.b.CurrentRequestTargetScope)||void 0===a?void 0:a.pageExperiments)||void 0===o?void 0:o.join(","))||"",C=null===(c=null===u.b||void 0===u.b?void 0:u.b.CurrentRequestTargetScope)||void 0===c?void 0:c.browser;return u.b.AppType!==r.a.Windows&&u.b.AppType!==r.a.WindowsShell||(p.appId=s.windowsFeed),p.submitTime=(new Date).toISOString(),p.clientFeedbackId=Object(I.e)(),p.comment=i,p.rating=4,p.application={appData:`{"ScreenResolution":"${window&&window.screen?[screen.width,screen.height].join("x"):""}","articleId":"${e}"}`},p.telemetry={audience:(null===u.b||void 0===u.b?void 0:u.b.CurrentMarket)||"",audienceGroup:(null==f?void 0:f.verticalKey)||"Production",channel:(null==f?void 0:f.categoryKey)||"",deviceType:(null==m?void 0:m.deviceFormFactor)||"",errorClassification:JSON.stringify({articleId:e,NotRelevant:t.OffensiveOrAdult,BlurryImage:t.InaccurateOrMisleading,OutdatedArticle:t.Duplicate,MisleadingTitle:t.Outdated,DuplicateArticle:t.DisplayIssue,OffensiveContent:t.Other}),featureArea:(null==m?void 0:m.pagetype)||"",flights:y,isUserSubscriber:Object(O.e)(),platform:null===(d=u.b.CurrentRequestTargetScope)||void 0===d?void 0:d.os,processSessionId:v,sourceContext:u.b.AppType},p.web={browser:(null==C?void 0:C.browserType)||"",browserVersion:(null==C?void 0:C.version)||"",sourcePageName:(null==f?void 0:f.subcategoryKey)||"",sourcePageURI:b},p}ReportAd(e,t){return Object(n.b)(this,void 0,void 0,(function*(){const i=e.concat("&f="+t);let s=new Image(1,1);s.src=i,s=null}))}GetProviderIcon(e){return Object(n.b)(this,void 0,void 0,(function*(){const t=yield this.GetPublisherDetails(e);return Object(w.a)(t,"value[0].logos[0].imageLink.href",void 0)}))}PostCardActionV2Event(e,t,i,s=(()=>null),r,o,c=!0,d){return Object(n.b)(this,void 0,void 0,(function*(){switch(t){case a.a.ShowMore:return e&A.a.showMore?(c&&C.a.renderToast({id:S.a.ShowMore+"-"+i,toastType:S.a.ShowMore,expirationInMs:a.d,onClick:()=>{r?r(i,e^A.a.showMore,t,!0):this.PostCardActionV2Event(e^A.a.showMore,t,i,s)},referrerButton:d}),yield this.ShowMore(i)):(C.a.expireToast(S.a.ShowMore+"-"+i),yield this.UnshowMore(i)),s(i,e);case a.a.ShowFewer:return e&A.a.showFewer?(c&&C.a.renderToast({id:S.a.ShowFewer+"-"+i,toastType:S.a.ShowFewer,expirationInMs:a.d,onClick:()=>{r?r(i,e^A.a.showFewer,t,!0):this.PostCardActionV2Event(e^A.a.showFewer,t,i,s)},referrerButton:d}),yield this.ShowFewer(i)):(C.a.expireToast(S.a.ShowFewer+"-"+i),yield this.UnshowFewer(i)),s(i,e);case a.a.Save:return e&A.a.saved?(c&&C.a.renderToast({id:S.a.Save+"-"+i,toastType:S.a.Save,expirationInMs:a.d,referrerButton:d}),yield this.Save(i)):(C.a.expireToast(S.a.Save+"-"+i),yield this.Unsave(i)),s(i,e);case a.a.Hide:return e&A.a.hide?yield this.Hide(i):yield this.Unhide(i),s(i,e);case a.a.Mute:yield this.Mute(o);break;case a.a.ReportAd:return s(i,e);default:return}}))}GetPublisherDetails(e){return Object(n.b)(this,void 0,void 0,(function*(){const t=yield f.a.getBaseRequestData("GET"),i={key:"ids",value:e},s=Object(m.d)(this.providersServiceEndpoint);[i,...yield this.getOneServiceCommonParam()].forEach(e=>e.value&&s.searchParams.set(e.key,e.value));try{const i=yield Object(b.a)(()=>Object(n.b)(this,void 0,void 0,(function*(){return yield this.fetchImpl(s.href,t)})),"getProviderDetails");if(!i.ok){const t=`OneService returned error response. Status: ${i.status} for providerId: ${e} (url: ${s.href}`;throw new Error(t)}return i.json()}catch(e){p.a.sendAppErrorEvent(Object.assign(Object.assign({},c.ob.CardActionGetActionError),{message:`Error while calling getPublisherDetails action for card action: url: ${s.href}, error: ${e}`}))}}))}DeleteCardActionV2Request(e,t){return Object(n.b)(this,void 0,void 0,(function*(){const i=yield f.a.getBaseRequestData("DELETE");(yield this.isUserSignedIn())&&(i.credentials="include");const s={key:"$filter",value:`actionType eq '${t}' and targetId eq '${e}'`},a=Object(m.d)(this.cardActionV2sServiceEndpoint);[s,...yield this.getOneServiceCommonParam()].forEach(e=>e.value&&a.searchParams.set(e.key,e.value));try{const s=yield Object(b.a)(()=>Object(n.b)(this,void 0,void 0,(function*(){return yield this.fetchImpl(a.href,i)})),"deleteCardActionV2"+t);if(s.status>=400){const i=`OneService returned error response. Status: ${s.status} for actionType: ${t} and targetId: ${e}`;throw new Error(i)}return Object(v.a)(this.getPreloadReloadReason(t)),Object(R.e)(),s}catch(e){p.a.sendAppErrorEvent(Object.assign(Object.assign({},c.ob.CardActionDeleteActionError),{message:`Error while calling delete action for card action: url: ${a.href}, error: ${e}`}))}}))}PostCardActionV2Request(e,t,i){return Object(n.b)(this,void 0,void 0,(function*(){const s={method:"POST",body:JSON.stringify({actionType:t,targetId:e,targetType:i}),headers:yield f.a.getOneServiceHeaders()};(yield this.isUserSignedIn())&&(s.credentials="include");const a=Object(m.d)(this.cardActionV2sServiceEndpoint);(yield this.getOneServiceCommonParam()).forEach(e=>e.value&&a.searchParams.set(e.key,e.value));try{const r=yield Object(b.a)(()=>Object(n.b)(this,void 0,void 0,(function*(){return yield this.fetchImpl(a.href,s)})),"getCardActionV2"+t);if(r.status>=400){const s=`OneService returned error response. Status: ${r.status} for actionType: ${t}, targetId: ${e} and targetType: ${i}`;throw new Error(s)}return Object(v.a)(this.getPreloadReloadReason(t)),Object(R.e)(),r.json()}catch(e){p.a.sendAppErrorEvent(Object.assign(Object.assign({},c.ob.CardActionPostActionError),{message:`Error while posting action for card action: url: ${a.href}, error: ${e}`}))}}))}getOneServiceCommonParam(){return Object(n.b)(this,void 0,void 0,(function*(){const e=yield this.isUserSignedIn();let t=!0;return u.b.AppType===r.a.NewsAndInterests||u.b.AppType===r.a.WindowsNewsPlus?(t=!1,this.ocid="winp2"):this.enableEnterpriseOCID&&h.b.IsBlendedEnterprise&&(this.ocid="entnewsntp",t=!1),e?f.a.getOneServiceParamsWithAuth(u.b.UserId,this.ocid,t):f.a.getOneServiceParamsWithoutAuth(u.b.UserId,this.ocid,t)}))}isUserSignedIn(){return Object(n.b)(this,void 0,void 0,(function*(){if(h.b.UserIsSignedIn)return!0;return(yield Object(O.d)())===o.c.SignedIn}))}getPreloadReloadReason(e){switch(e){case a.a.Mute:return y.a.MutePublisher;case a.a.Save:return y.a.Save;case a.a.Like:return y.a.Like;case a.a.Dislike:return y.a.Dislike;default:return y.a.SettingsChange}}}},btVS:function(e,t,i){"use strict";t.a=function(e,t,i,s,n){return n(e,(function(e,n,a){i=s?(s=!1,e):t(i,e,n,a)})),i}},cASJ:function(e,t,i){"use strict";i.d(t,"a",(function(){return be})),i.d(t,"b",(function(){return ye}));var s,n=i("D57K"),a=i("BhE+"),r=i("XlyT"),o=i("HxRh"),c=i("+djJ"),d=i("YUMq"),l=i("pMIE"),h=i("2H+z"),u=i("r6MD"),g=i("KPQt"),p=i("oIHq"),m=i("rvYQ"),f=i("Fpjf"),b=i("ADRF"),v=i("aHCm");!function(e){e.SlideshowPreview="ss",e.ArticlePreview="ar",e.VideoPreview="vi"}(s||(s={}));var y=i("KETb"),C=i("u5KZ");class S{getCMSList(e,t){return Object(n.b)(this,void 0,void 0,(function*(){if(e)try{const i={method:"GET",headers:{}},s=yield Object(y.a)(()=>Object(n.b)(this,void 0,void 0,(function*(){const t=new URL(`${a.e.CMSListServiceUrl}${e}${m.b.ContentServiceUrlBase.search}`,""+m.b.ContentServiceUrlBase),s=yield fetch(t.toString(),i);if(s.ok)return s.json();C.a.sendAppErrorEvent(Object(r.a)(o.Ee,"Get CMSAd content failed",`Invalid response from CMS, ${s.statusText}, listId: ${e}`))})),"getCMSList");if(!s)return void C.a.sendAppErrorEvent(Object(r.a)(o.Ee,"Get CMSAd content failed","Invalid response.json(), listId: "+e));const c=s;return this.translateToCMSItem(c,e,t,a.b.PrivacyUrl)}catch(t){return void C.a.sendAppErrorEvent(Object(r.a)(o.Ee,"Get CMSAd content failed",`Error while fetching CMS Native Ad  ${t}, id: ${e}`))}else C.a.sendAppErrorEvent(Object(r.a)(o.Ee,"Get CMSAd content failed","No backfill id found, listId: "+e))}))}translateToCMSItem(e,t,i,s){return Object(n.b)(this,void 0,void 0,(function*(){if(!e||!e.list||0===e.list.length)return void C.a.sendAppErrorEvent(Object(r.a)(o.Ee,"Get CMSAd content failed","No CMS Response returned from "+t));const n=[];for(const t of e.list){let e=!1;const r=t.extendedProperties;if(r)for(const t of r)if(t.key&&t.key.indexOf("is_content")>-1&&t.values&&t.values.indexOf("true")>-1){e=!0;break}let o;if(null!=t.link&&null!=t.link.title&&t.link.href&&null!=t.link.image&&null!=t.link.image.href){const i=this.getCMSContentId(t.link.image.href);let n,r;if(t.link.ad)if(t.link.ad.providerHref&&t.link.ad.providerHref.href){const e=this.getCMSContentId(t.link.ad.providerHref.href);e?n=yield this.fetchProviderName(e):t.link.ad.sponsorText&&(n=t.link.ad.sponsorText)}else t.link.ad.sponsorText&&(n=t.link.ad.sponsorText);r=n||(null!=t.link.kicker?t.link.kicker:a.e.DefaultProviderName),o={title:t.link.title,url:t.link.href,provider:{name:r},imageUrl:i?Object(f.g)(i,{width:624,height:350,enableDpiScaling:!1}):t.link.image.href,isContent:e,privacyUrl:s}}else if(null!=t.reference&&null!=t.reference.href){const n=this.getCMSContentId(t.reference.href);if(null!=n){const t=yield this.getCMSContent(n);if(!t)continue;o={title:t.title,url:this.constructDestinationUrl(t,i),provider:this.constructProvider(t),imageUrl:this.constructImageUrl(t),isContent:e,privacyUrl:s}}}o&&o.title&&o.imageUrl&&o.url&&n.push(o)}return{id:e._id,items:n}}))}getCMSContent(e){return Object(n.b)(this,void 0,void 0,(function*(){try{const t=new URL(m.b.ContentServiceUrlBase.search,`${m.b.ContentServiceUrlBase}${a.e.CMSContentServiceURl}${e}/`),i=yield fetch(t.toString());if(!i||!i.ok)return void C.a.sendAppErrorEvent(Object(r.a)(o.Ee,"Get CMSAd content failed","Failed to fetch CMS content, cmsId: "+e));const s=yield i.json();return s||void C.a.sendAppErrorEvent(Object(r.a)(o.Ee,"Get CMSAd content failed","Invalid JSON response to get CMS content, cmsId: "+e))}catch(t){return void C.a.sendAppErrorEvent(Object(r.a)(o.Ee,"Get CMSAd content failed",`Error while fetching CMS content ${t}, cmsId: ${e}`))}}))}constructDestinationUrl(e,t){const{category:i}=e,n=i&&i.product||"news",a=i&&i.label||"other",r=s[e.type]||"xx";return`https://www.msn.com/${t}/${b.a.encodeURIComponentForPrime(n||"")}/${b.a.encodeURIComponentForPrime(a||"")}/${b.a.encodeURIComponentForPrime(e.title||"")}/${r}-${e.id}`}constructProvider(e){const{name:t,logo:i}=e.provider;return{name:t,logo:i&&i.id?{src:`${v.a.prod}${i.id}?w=16&h=16`,alt:t}:void 0}}constructImageUrl(e){if(e.images&&!(e.images.length<1)&&e.images[0].id)return Object(f.g)(e.images[0].id,{width:624,height:350,focalRegion:e.images[0].focalRegion,enableDpiScaling:!1})}getCMSContentId(e){return e&&e.indexOf("cms/api/amp")>-1?e.substring(e.lastIndexOf("/")+1):null}fetchProviderName(e){return Object(n.b)(this,void 0,void 0,(function*(){try{const t={method:"GET",headers:{}},i=yield Object(y.a)(()=>Object(n.b)(this,void 0,void 0,(function*(){const i=new URL(`${a.e.CMSListServiceUrl}${e}${m.b.ContentServiceUrlBase.search}`,""+m.b.ContentServiceUrlBase),s=yield fetch(i.toString(),t);if(s.ok)return s.json();C.a.sendAppErrorEvent(Object(r.a)(o.Ee,"Get CMSAd content failed",`Invalid response from CMS. status: ${s.status}, statusText: ${s.statusText}, url: ${s.url}`))})),"getProviderName");if(!i)return void C.a.sendAppErrorEvent(Object(r.a)(o.Ee,"Get CMSAd content failed","Invalid response.json(), cmsId: "+e));const s=i;return s?s.displayName:void C.a.sendAppErrorEvent(Object(r.a)(o.Ee,"Get CMSAd content failed","Failed to parse JSON response, cmsId: "+e))}catch(t){return void C.a.sendAppErrorEvent(Object(r.a)(o.Ee,"Get CMSAd content failed",`Error while fetching Provider name  ${t}, cmsId: ${e}`))}}))}}var O,A=i("Bwzq");!function(e){e.AR="AR",e.GA="GA",e.VI="VI",e.EDGECHRNTP="edgechrntp",e.EDGECHRDHP="edgechrdhp",e.MSNEWS="msnews",e.FirstParty="firstparty",e.VerticalLandingPage="vlp",e.WINVLP="winvlp",e.WINAR="winar",e.WINGA="winga",e.WINVI="winvi",e.WEBCOMPAR="webcompar",e.WEBCOMPGA="webcompga",e.WEBCOMPVI="webcompvi"}(O||(O={}));var I=i("hOj1"),w=i("I6Lx"),R=i("y+Kz"),T=i("tWvP"),j=i("ypwz"),x=i("s9+9"),P=i("4wjP"),M=i("KRKw"),E=i("3Amp"),D=i("hnBi");let k,L=!1;const F=new Promise(e=>{k=e});function N(){return Object(n.b)(this,void 0,void 0,(function*(){switch(yield function(){return Object(n.b)(this,void 0,void 0,(function*(){L||(E.a.cookieConsentStatus.registerObserver(e=>{k()}),L=!0);const e=D.a.getInstance().rootReducer.connector(x.a.SharedState),t=e&&e.getCurrentState(),i=t&&t.cookieConsentStatus;return i!==M.b.Unknown?i:(yield F,e.getCurrentState().cookieConsentStatus)}))}()){case M.b.Required:return!0;case M.b.NotRequired:return!1;default:return}}))}class U{updateMsaOptOutCookie(e){if(!this.getMsaOptoutCookieData()&&e&&e.optout){const t=!0===e.optout.msaOptOut?"1":"0";this.setMsaOptoutCookie(t)}}getMsaOptoutCookieData(){const e=Object(I.a)(a.f.MSAOptOut);return e&&e.length>0?e:null}setMsaOptoutCookie(e){e&&e.length>0&&Object(T.a)(a.f.MSAOptOut,e,1,null,"/")}getBrowserOptoutStatus(){const e=Object(I.a)(a.f.BrowserOptOut);return!(!e||"1"!==e)}setUserOptOutSettings(){const e=this.getBrowserOptoutStatus(),t=this.getMsaOptoutCookieData(),i=!(!t||"1"!==t),s=(e||i).toString().toLowerCase();let n="";e&&(n="b|"),i&&(n+="m");const r=a.b.UserOptOut+":"+s+";"+a.b.UserOptOutOptions+":"+n;if(document.head.attributes["data-info"]){const e=document.head.attributes["data-info"].value.split(";");e.find(e=>e.indexOf(a.b.UserOptOut)>-1)?e.find(e=>e.indexOf(a.b.UserOptOut)>-1)!==a.b.UserOptOut+":"+s&&(document.head.attributes["data-info"].value=document.head.attributes["data-info"].value.replace(a.b.UserOptOut+":false",a.b.UserOptOut+":"+s).replace(a.b.UserOptOut+":true",a.b.UserOptOut+":"+s)):document.head.attributes["data-info"].value=document.head.attributes["data-info"].value+";"+a.b.UserOptOut+":"+s,e.find(e=>e.indexOf(a.b.UserOptOutOptions)>-1)?e.find(e=>e.indexOf(a.b.UserOptOutOptions)>-1)!==a.b.UserOptOutOptions+":"+n&&(e.includes(a.b.UserOptOutOptions+":")?document.head.attributes["data-info"].value=document.head.attributes["data-info"].value.replace(a.b.UserOptOutOptions+":",a.b.UserOptOutOptions+":"+n):e.includes(a.b.UserOptOutOptions+":b|")?document.head.attributes["data-info"].value=document.head.attributes["data-info"].value.replace(a.b.UserOptOutOptions+":b|",a.b.UserOptOutOptions+":"+n):e.includes(a.b.UserOptOutOptions+":b|m")?document.head.attributes["data-info"].value=document.head.attributes["data-info"].value.replace(a.b.UserOptOutOptions+":b|m",a.b.UserOptOutOptions+":"+n):e.includes(a.b.UserOptOutOptions+":m")&&(document.head.attributes["data-info"].value=document.head.attributes["data-info"].value.replace(a.b.UserOptOutOptions+":m",a.b.UserOptOutOptions+":"+n))):document.head.attributes["data-info"].value=document.head.attributes["data-info"].value+";"+a.b.UserOptOutOptions+":"+n}else document.head.setAttribute("data-info",r)}}var W=i("HhTf"),H=i("loKy"),q=i("w0HK"),V=i("C4R5");class B{constructor(){this.riverNativeAdCount=0,this.reservedRiverNativeAdCount=0,this.dualWideRiverNativeAdCount=0,this.halfRiverNativeAdCount=0,this.beaconService=new p.a,this.cookieService=new U,this.ecasession=a.b.Ecasession;const e=D.a.getInstance().rootReducer;if(m.b.AppType===j.a.EdgeChromium){const t=e.connector(x.a.ChromiumPageSettings);t&&(this.anaheimPageLayout=t.getCurrentState().currentLayout)}const t=e.connector(x.a.SharedState);t&&t.getCurrentState().useHistory?Object(V.a)().addSwitchListener(this.onPivotSwitch.bind(this),H.a.Monetization):Object(q.a)().addSwitchListener(this.onPivotSwitch.bind(this),H.a.Monetization)}get sourceUrl(){if(this._sourceUrl)return this._sourceUrl;this._sourceUrl=m.b.HostPage.originalUrl;const e=m.b.CurrentRequestTargetScope.pageType,t=m.b.HostPage.verticalKey;if(e&&t){const i=e.toLowerCase();(i.indexOf(P.b.DHP)>-1||i.indexOf(P.b.NTP)>-1)&&(this._sourceUrl="https://"+m.b.HostPage.hostName+"/"+t+"/"+e)}return this._sourceUrl}get pageType(){if(this._pageType)return this._pageType;const e=m.b.CurrentRequestTargetScope.pageType,t=m.b.CurrentRequestTargetScope.ocid;return this._pageType=e,m.b.AppType===j.a.EdgeChromium?this._pageType=O.EDGECHRNTP:m.b.AppType===j.a.Views&&("article"===e?this._pageType="windirect"===t?O.WEBCOMPAR:O.WINAR:"gallery"===e?this._pageType="windirect"===t?O.WEBCOMPGA:O.WINGA:"video"===e&&(this._pageType="windirect"===t?O.WEBCOMPVI:O.WINVI)),this._pageType}fetchSAMAds(e,t=!1){return Object(n.b)(this,void 0,void 0,(function*(){if(!e||!e.placements||e.placements.length<1)return void C.a.sendAppErrorEvent(Object(r.a)(o.He,"Invalid request to fetch native ads","No placements found in the request"));const{anaheimColLayout:i}=e,s=e.pageType||this.pageType;if(!s)return void C.a.sendAppErrorEvent(Object(r.a)(o.He,"Invalid request to fetch native ads","No page type found"));const n=this.getImpressionId(),l=this.cookieService.getBrowserOptoutStatus(),h=yield N(),u=this.getMuid(e.adid),g=this.riverNativeAdCount,p=this.reservedRiverNativeAdCount,f=this.dualWideRiverNativeAdCount,b=this.halfRiverNativeAdCount;!h&&t&&(this.ecasession=Object(I.a)(a.f.TaboolaSessionCookieName)||this.ecasession);const v=!(!w.b.ClientSettings||!w.b.ClientSettings.deviceFormFactor||w.b.ClientSettings.deviceFormFactor!==W.a.Phone),y=this.isNotMyFeed(),S={locale:e.locale,rid:n,partnerId:m.b.CurrentRequestTargetScope.pageType,content:{sourceUrl:this.sourceUrl,pageType:s,previousReservedRiverNativeAdCount:p,previousRiverDualWideNativeAdCount:f,previousRiverHalfNativeAdCount:b,previousRiverNativeAdCount:g,verticalName:m.b.HostPage.verticalKey,anaheimPageLayout:this.anaheimPageLayout,anaheimColLayout:i,isXfeed:y,audienceMode:m.b&&m.b.CurrentRequestTargetScope&&m.b.CurrentRequestTargetScope.audienceMode},user:{muid:u,browserOptOut:l,isAdblock:!1},placements:this.getPlacements(e,s),extensions:this.getExtensions(this.lastResponseMetadata,this.ecasession),isCookieWallPresent:h,isPeregrine:!0,device:{isMobile:v}},T=JSON.stringify(S),j=new URL(a.b.SamEndpoint);return new Promise(e=>{try{const t=new XMLHttpRequest;t.open(a.j.Method,j.href,!0),t.withCredentials=!0,t.timeout=a.j.Timeout,t.setRequestHeader(a.j.ContentTypeKey,a.j.ContentType),t.setRequestHeader(a.j.FlightIdKey,w.b.CurrentFlights),t.setRequestHeader(a.j.CacheControlKey,a.j.CacheControl),u&&t.setRequestHeader(a.j.ClientIdKey,u),s===O.GA?t.setRequestHeader(a.j.AuthCookieNameKey,a.f.AnonCookieName):Object(I.a)(a.f.AppAnonCookieExist)&&t.setRequestHeader(a.j.AuthCookieNameKey,R.f),t.onload=()=>{e(this.processAdResponse(t))},t.ontimeout=()=>{C.a.sendAppErrorEvent(Object(r.a)(o.Je,"Timeout calling SAMRTB Ajax",`pageType: ${s}, status: ${t.status}, StatusText: ${t.statusText}`)),e(void 0)},t.onerror=()=>{C.a.sendAppErrorEvent(Object(r.a)(o.Ie,"Error calling SAMRTB Ajax",`pageType: ${s}, status: ${t.status}, StatusText: ${t.statusText}`)),e(void 0)},t.send(T);const i=!0===w.b.IsPrerender?performance.now()-Object(c.g)(d.d):performance.now();Object(c.o)(A.a.TimeToRequestAd,i)}catch(e){return void Object(r.c)(e,o.Ke,"Failed to get response from SAMRTB call","pageType: "+s)}})}))}generateSourceUrl(){const e=m.b.CurrentRequestTargetScope.pageType;let t=m.b.HostPage.originalUrl;const i=m.b.HostPage.verticalKey;if(e&&i){const s=e.toLowerCase();(s.indexOf(P.b.DHP)>-1||s.indexOf(P.b.NTP)>-1)&&(t="https://"+m.b.HostPage.hostName+"/"+i+"/"+e)}return t}processAdResponse(e){if(200!==e.status)return 204===e.status?void C.a.sendAppErrorEvent(Object(r.a)(o.Je,"No content received from SAMRTB Ajax",`Status: ${e.status}, StatusText: ${e.statusText}`)):void C.a.sendAppErrorEvent(Object(r.a)(o.Ie,"Invalid response from SAMRTB Ajax",`Status: ${e.status}, StatusText: ${e.statusText}`));try{const t=JSON.parse(e.response);if(!t)return void C.a.sendAppErrorEvent(Object(r.a)(o.Le,"Invalid json response from SAMRTB",`Status: ${e.status}, Invalid json: ${e.response}`));const i=t.metaData;return this.processMetaData(i),this.beaconService.fireRequestLevelBeacons(i.requestLevelBeaconUrls),t}catch(t){return void Object(r.c)(t,o.Ke,"Failed to process SAMRTB response",`Status: ${e.status}, json: ${e.response}`)}}getPlacements(e,t){const i=[];return e.placements.forEach(e=>{if(e.region&&e.indices&&e.indices.length){const{indices:s,img:n}=e,r=t==O.EDGECHRNTP&&a.h[e.region]||e.region,o=n?{region:r,indices:s,img:n}:{region:r,indices:s};i.push(o);const c=e.region.toLocaleLowerCase();c===a.b.RiverRegion?this.riverNativeAdCount+=e.indices.length:c===a.b.ReservedRiver?this.reservedRiverNativeAdCount+=e.indices.length:c===a.b.RiverDoubleWide?this.dualWideRiverNativeAdCount+=e.indices.length:c!==a.b.RiverHalf&&c!==a.b.RiverHalfTextOnly||(this.halfRiverNativeAdCount+=e.indices.length)}}),i}processMetaData(e){const t=e&&e.taboola&&e.taboola.sessionId;!this.isCookieWallPresent&&t&&Object(T.a)(a.f.TaboolaSessionCookieName,t,.042,a.f.CookieDomain,"/"),this.lastResponseMetadata=this.mergeMetadata(this.lastResponseMetadata,e),this.cookieService.updateMsaOptOutCookie(e)}mergeMetadata(e,t){return e?t?(t.taboola=this.mergePartnerMetadata(e.taboola,t.taboola),t):e:t}mergePartnerMetadata(e,t){return t=t||{},e&&e.sessionId&&!t.sessionId&&(t.sessionId=e.sessionId),t}getImpressionId(){return this.lastResponseMetadata&&this.lastResponseMetadata.pageViewId?this.lastResponseMetadata.pageViewId:C.a.getRequestId()}clearPreviousInfo(){var e;this.riverNativeAdCount=0,this.reservedRiverNativeAdCount=0,this.dualWideRiverNativeAdCount=0,this.halfRiverNativeAdCount=0,(null===(e=this.lastResponseMetadata)||void 0===e?void 0:e.pageViewId)&&delete this.lastResponseMetadata.pageViewId}getExtensions(e,t){const i={taboola:(e=e||{taboola:{}}).taboola};return i.taboola.sessionId||(i.taboola.sessionId=t),i}getMuid(e){return this.isCookieWallPresent?null:e||Object(I.b)()}onPivotSwitch(e){if(!e.oldSelection)return;const t=e.newSelection.pivotId;t&&t.toLowerCase()!==a.i.EditInterestPivotId&&(this.pivotId=t)}isNotMyFeed(){return!!this.pivotId&&this.pivotId.toLowerCase()!==a.i.MyFeedPivotId&&this.pivotId.toLowerCase()!==a.i.StripeMyFeedPivotId}}var _=i("Tc2z"),$=i("hV4J"),G=i("hqLi"),z=i("SEb4"),Q=i("mEtE"),K=i("zFYL");const J={rating:3,likes:4,price:6,salePrice:7,installmentPrice:500,priceDrop:501,freeShipping:502,viewed:503,sold:504,specialOffer:505,eliteBadge:506,condition:507,localInventory:508,curbsidePickup:509,review:510,discount:600};var X=i("3noN");function Z(e,t){return t.template.templateType=e,!0}function Y(e,t){return t.template.templateType=K.a.ZIndex,t.template.flipZIndex=!0,!0}function ee(e,t){return Z(K.a.RiverAnimatedImagery_9by16,t)}function te(e,t){return Z(K.a.RiverZIndex_9by16,t)}function ie(e,t){return t&&t.items&&1===t.items.length&&(e===K.b._1by1?t.template.templateType=K.a.InfopaneHorizontal_1by1:e===K.b._4by3?t.template.templateType=K.a.InfopaneHorizontal_4by3:e===K.b._3by4?t.template.templateType=K.a.InfopaneHorizontal_3by4:e===K.b._9by16&&(t.template.templateType=K.a.InfopaneHorizontal_9by16)),!0}function se(e,t){return t&&t.items&&1===t.items.length&&(e===K.b._1by1?t.template.templateType=K.a.InfopanePatternOverlay_1by1:e===K.b._4by3&&(t.template.templateType=K.a.InfopanePatternOverlay_4by3)),!0}function ne(e,t,i){return e[Math.floor(Math.random()*e.length)](t,i)}function ae(e,t,i){let s=0;Object(X.a)(e,e=>{s+=e.weight});const n=Math.floor(Math.random()*s);let a=0;for(let s=0;s<e.length;++s)if(a+=e[s].weight,n<a)return e[s].template(t,i),!0;return!1}function re(e,t){return t.template.templateType=K.a.PatternOverlay,e===K.b._16by9?t.template.landscapeOverlay=!0:e===K.b._4by3&&(t.template.landscapeOverlay=!1),!0}const oe={riverSingleAdMultiImage:function(e,t){return t.slideshowProps={autoScroll:t.template.slideshowProps.autoScroll,maxImageCount:t.template.slideshowProps.maxImageCount},ae([{template:()=>(t.template.templateType=K.a.Slideshow,t.slideshowProps.autoScrollIntervalMs=t.template.slideshowProps.slideshowScrollInterval,t.slideshowProps.enableSlideshowMediaControls=!0,!0),weight:100-Object(u.a)(t,"template.slideshowProps.psuedoVideoAllocation",80)},{template:()=>(t.template.templateType=K.a.PseudoVideo,t.slideshowProps.autoScrollIntervalMs=t.template.slideshowProps.psuedoVideoScrollInterval,t.slideshowProps.enableSlideshowMediaControls=!1,!0),weight:Object(u.a)(t,"template.slideshowProps.psuedoVideoAllocation",20)}],e,t)},riverMultiAds:re},ce=[{template:re,weight:1},{template:Y,weight:1}],de=[{ratio:K.b._lowerBound,width:1,height:9999},{ratio:K.b._1by191,width:1,height:1.91},{ratio:K.b._9by16,width:9,height:16,riverSingleAdSingleImage:function(e,t){return ne([ee,te],e,t)},infoPaneSingleImage:ie},{ratio:K.b._3by4,width:3,height:4,riverSingleAdSingleImage:function(e,t){return Z(K.a.RiverZIndex_3by4,t)},infoPaneSingleImage:ie},{ratio:K.b._1by1,width:1,height:1,riverSingleAdSingleImage:Y,riverSingleAdMultiImage:Y,riverMultiAds:function(e,t){return Z(K.a.AdCarousel,t)},infoPaneSingleImage:(e,t)=>ne([ie,se],e,t)},{ratio:K.b._4by3,width:4,height:3,riverSingleAdSingleImage:(e,t)=>ae(ce,e,t),riverSingleAdMultiImage:(e,t)=>ae(ce,e,t),riverMultiAds:(e,t)=>ae(ce,e,t),infoPaneSingleImage:(e,t)=>ne([ie,se],e,t)},Object.assign(Object.assign({ratio:K.b._16by9,width:16,height:9},oe),{riverSingleAdSingleImage:re}),Object.assign({ratio:K.b._191by1,width:1.91,height:1},oe)];function le(e,t,i,s){const n=i?e.ext.originalImageWidth:e.originalImageWidth,a=i?e.ext.originalImageHeight:e.originalImageHeight,r=1*n/a,o=1*t.width/t.height,c={w:n,h:a};r>=o?c.w=Math.round(a*o):c.h=Math.round(n/o);const d={river:300,infopane:604};return c.w>d[s]&&(c.h=Math.round(c.h*d[s]/c.w),c.w=d[s]),function(e,t,i,s){const n=s?new URL(i.url):new URL(i.imageUrl);n.searchParams.set("h",e),n.searchParams.set("w",t),n.searchParams.set("c","4"),s?i.url=n.href:i.imageUrl=n.href}(c.h,c.w,e,i),c}function he(e){if(!e.items||0===e.items.length||!e.items[0].originalImageHeight||!e.items[0].originalImageWidth||"bing"!==e.providerId||"river"!==e.region&&"infopane"!==e.region)return!1;const t=function(e){const t=Number(e.originalImageHeight),i=Number(e.originalImageWidth);let s=1;for(;s<de.length&&Math.ceil(i*de[s].height)!==Math.ceil(t*de[s].width);++s)if(!(Math.ceil(i*de[s].height)>Math.ceil(t*de[s].width))){if(1==s)break;const e=1*i/t;Math.abs(e-de[s].width/de[s].height)>=Math.abs(e-de[s-1].width/de[s-1].height)&&(s-=1);break}return s==de.length&&(s-=1),de[s]}(e.items[0]);let i,s=!1;return"infopane"===e.region?1==e.items.length&&(s=e.items[0].images&&e.items[0].images.length>1?t.infoPaneMultiImage&&t.infoPaneMultiImage(t.ratio,e):t.infoPaneSingleImage&&t.infoPaneSingleImage(t.ratio,e)):"river"===e.region&&(s=e.items.length>1?t.riverMultiAds&&t.riverMultiAds(t.ratio,e):e.items[0].images&&e.items[0].images.length>1?t.riverSingleAdMultiImage&&t.riverSingleAdMultiImage(t.ratio,e):t.riverSingleAdSingleImage&&t.riverSingleAdSingleImage(t.ratio,e)),s&&(e.items.forEach(s=>{const n=le(s,t,!1,e.region);i||(i=n),s.images&&Object(X.a)(s.images,i=>{i.ext&&i.ext.originalImageWidth&&i.ext.originalImageHeight&&le(i,t,!0,e.region)})}),e.template.desiredHeight=i.h.toString(),e.template.desiredWidth=i.w.toString(),e.template.desiredRatio=t.ratio),s}class ue{}ue.concat=(e,t)=>`${e}.${t}`,ue.identity=e=>t=>ue.concat(e,t),ue.boolean=e=>t=>t?ue.concat(e,"1"):null;class ge{constructor(){this._availableAssets="",this._displayedAssets=""}get availableAssets(){return this._availableAssets}get displayedAssets(){return this._displayedAssets}setAvailableAssets(e){e.items&&e.items[0]&&e.items[0].assets&&(this._availableAssets=Object(_.a)(Object.keys(e.items[0].assets),e=>J[e]).join("_"))}setDisplayedAssets(e){e.items&&e.items[0]&&e.items[0].assets&&(this._displayedAssets=Object(_.a)(Object.keys(e.items[0].assets),e=>J[e]).join("_"))}}const pe={templateType:ue.identity("type"),animatedImage:ue.identity("ani"),flipZIndex:ue.boolean("fz"),landscapeOverlay:ue.boolean("lo")};class me{updateTemplate(e,t={}){if(!e||"resriver"===e.region||"resinfopane"===e.region)return;this.decorationBeaconBuilder=new ge,this.decorationBeaconBuilder.setAvailableAssets(e);const i=Object($.a)({},t,K.c);let s=!1;t.templateSelection&&e.items&&e.items[0].originalImageHeight&&e.items[0].originalImageWidth&&(e.template=i,s=he(e)),s||(e.template=this.processConfig(e,i)),this.resetTempateTypeForInfopaneInMultiAds(e),this.filterAssetByFlight(e),this.updatePlacementImageSize(e),this.updateBeacon(e)}processConfig(e,t){const i=t;if("river"!==e.region&&(i.templateType=K.a.Default),this.updateSlideshowTemplateType(e,t,i),i.templateType===K.a.PatternOverlay)if(this.isProductItem(e)){const t=this.getItemImageSize(e).height;"174"===t?i.landscapeOverlay=!0:"225"===t?i.landscapeOverlay=!1:i.templateType=K.a.Default}else i.templateType=K.a.Default;return i.templateType===K.a.Default&&e.items&&e.items.length>3&&i.adCarousel&&(i.templateType=K.a.AdCarousel),i}updatePlacementImageSize(e){if(e.template.templateType===K.a.PatternOverlay){const t=this.getItemImageSize(e);e.imageWidth=Object(u.a)(e,"imageWidth",t.width),e.imageHeight=Object(u.a)(e,"imageHeight",t.height)}}updateBeacon(e){if(!Object(G.a)(e.beaconsJson)){const t=JSON.parse(e.beaconsJson);if(t&&Object(z.a)(t.trb)){let i=!1;t.trb=t.trb.map(t=>{if(t.includes("srtb.msn.com")){i=!0;const s=new URL(t);return b.a.appendSearchParam(s,"t",this.serializeTemplateConfig(e)),this.decorationBeaconBuilder.setDisplayedAssets(e),this.decorationBeaconBuilder.availableAssets&&b.a.appendSearchParam(s,"dec",this.decorationBeaconBuilder.availableAssets+"-"+this.decorationBeaconBuilder.displayedAssets),s.href}return t}),i&&(e.beaconsJson=JSON.stringify(t))}}}serializeTemplateConfig(e){return Object(h.a)(pe,(t,i,s)=>{const n=Object(u.a)(e.template,s);if(n){const e=i(n);if(e)return""===t?e:`${t}_${e}`}return t},"")}updateSlideshowTemplateType(e,t,i){e&&e.items&&e.items[0]&&e.items[0].images&&e.items[0].images.length>1&&(i.templateType=this.SlideshowTemplateType||this.getSlideshowTemplateType(t,i),e.slideshowProps=i.slideshowProps)}getSlideshowTemplateType(e,t){if(this.SlideshowTemplateType=K.a.Default,e&&e.slideshowProps&&t.slideshowProps){const i=Math.floor(100*Math.random());e.slideshowProps.psuedoVideoAllocation&&e.slideshowProps.psuedoVideoAllocation>i?(this.SlideshowTemplateType=K.a.PseudoVideo,t.slideshowProps.autoScrollIntervalMs=e.slideshowProps.psuedoVideoScrollInterval,t.slideshowProps.enableSlideshowMediaControls=!1):(this.SlideshowTemplateType=K.a.Slideshow,t.slideshowProps.autoScrollIntervalMs=e.slideshowProps.slideshowScrollInterval,t.slideshowProps.enableSlideshowMediaControls=!0)}return this.SlideshowTemplateType}getItemImageSize(e){const t=Object(Q.a)(e.items);return Object(G.a)(t)?{}:{width:""+Object(u.a)(t,"imageWidth"),height:""+Object(u.a)(t,"imageHeight")}}isProductItem(e){const t=Object(Q.a)(e.items);return!Object(G.a)(t.assets)}calculateDiscount(e){const t=e.price,i=e.salePrice;if(t&&i){const s=Number(t.replace(/[^0-9.-]+/g,"")),n=Number(i.replace(/[^0-9.-]+/g,""));e.discount=Math.floor((s-n)/s*100)}}filterAssetByFlight(e){if(e&&e.items&&e.items[0]&&e.items[0].assets){this.calculateDiscount(e.items[0].assets);const t=Object(h.a)(e.items[0].assets,(t,i,s)=>(e.template.allowedAssets&&e.template.allowedAssets.includes(J[s])&&(t[s]=i),t),{});e.items[0].assets=t}}resetTempateTypeForInfopaneInMultiAds(e){"infopane"===e.region&&e.items&&e.items.length>1&&(e.template.templateType=K.a.Default,e.template.animatedImage="")}}var fe=i("b169");class be{constructor(){this.beaconService=new p.a,this.cmsService=new S,this.samService=new B,this.templateService=new me,this.cmsNativeAdsItemsMap=new Map,this.cmsRetryCount=0,this.backfillIndex=0,this.cmsAdsCounter=0,this.callbackFnPlacementList=[],this.callbackList=[]}resetNativeAdService(){this.backfillIndex=0,this.cmsAdsCounter=0,this.callbackFnPlacementList.length=0,this.callbackList.length=0,this.samService.clearPreviousInfo()}fetchNativeAds(e){return Object(n.b)(this,void 0,void 0,(function*(){if(!e||!e.placements||0===e.placements.length)return void C.a.sendAppErrorEvent(Object(r.a)(o.Fe,"Fetch NativeAd failed","No placements found in the request"));if(e.locale||(e.locale=w.b.Locale),!e.locale)return void C.a.sendAppErrorEvent(Object(r.a)(o.Fe,"Fetch NativeAd failed",`No locale found, headData.Locale: ${w.b.Locale}, adRequest.locale: ${e.locale}`));const t=this.samService.fetchSAMAds(e),i=e.locale,s=a.c[i];if(!this.cmsItems){const e=yield this.cmsService.getCMSList(s,i);e&&(this.cmsItems=e.items)}const n=this.buildAdResponse(e),c=yield t;return this.updateAdResponse(n,this.cmsItems,s,c),n}))}generateFeedbackUrl(e){if(e&&e.length>0){const t=JSON.parse(e).tcb;if(t&&Array.isArray(t)){let e;return t.forEach(t=>{t.includes("srtb")&&(e=t.replace("notify/clicked","notify/feedback"))}),e}}}updateAdResponse(e,t,i,s){const n=!t||0==t.length,a=!s||!s.placements||0==s.placements.length;if(n&&a)return void C.a.sendAppErrorEvent(Object(r.a)(o.Ge,"Fetch NativeAd failed",`Unable to retrieve backfill list id: ${i} and SAM response`));n&&C.a.sendAppErrorEvent(Object(r.a)(o.Ge,"Unable to retrieve backfill list","Backfill list id: "+i));const l=this.mapSAMPlacements(s);return e.pageViewId=s&&s.metaData&&s.metaData.pageViewId,e.placements.forEach(e=>{const i=e.region+e.regionIndex,s=l.get(i);if(s&&s.items&&s.items.length>0){s.items.forEach(t=>{const i={title:t.title,destinationUrl:t.url,imageUrl:t.imageUrl,providerName:t.sourceName,adChoiceIconUrl:t.adChoicesUrl,imageHeight:t.imageHeight,imageWidth:t.imageWidth,clickBeacons:t.clickBeacons,uniqueId:t.uniqueId,feedbackUrl:this.generateFeedbackUrl(t.clickBeacons),verificationParameters:t.verificationParameters};e.items.push(i)}),e.privacyUrl=s.privacyUrl,e.adServedUrls=s.adServedUrls,e.jsTrackerUrls=s.jsTrackerUrls,e.visibilityUrls=s.visibilityUrls,e.beaconsJson=s.beaconsJson,e.bingTrackerUrls=s.bingTrackerUrls,e.geminiViewabilityDataJson=s.geminiViewabilityDataJson,this.beaconService.fireAdServedTrackingCall(s.beaconsJson);const t=!0===w.b.IsPrerender?performance.now()-Object(c.g)(d.d):performance.now();Object(c.o)(A.a.TimeToServeAd,t)}else if(n)C.a.sendAppErrorEvent(Object(r.a)(o.E,"Unable to backfill invalid sam placement","Placement key: "+i));else{const i=this.backfillIndex++%t.length,s=t[i],n={title:s.title,destinationUrl:s.url,imageUrl:this.updateImageUrl(e,s.imageUrl),providerName:s.provider?s.provider.name:""};e.items.push(n),e.privacyUrl=s.privacyUrl}}),e}fetchSamAds(e,t=!1,i){return Object(n.b)(this,void 0,void 0,(function*(){if(!e||!e.placements||0===e.placements.length)return void C.a.sendAppErrorEvent(Object(r.a)(o.Fe,"Fetch NativeAd failed","No placements found in the request"));if(e.locale||(e.locale=w.b.Locale),!e.locale)return void C.a.sendAppErrorEvent(Object(r.a)(o.Fe,"Fetch NativeAd failed",`No locale found, headData.Locale: ${w.b.Locale}, adRequest.locale: ${e.locale}`));i&&i.length>0&&this.callbackList.push(...i),this.locale=e.locale;const s=this.samService.fetchSAMAds(e,t);return{placeHolderResponse:this.buildAdResponse(e),samResponse:yield s}}))}fetchCmsAds(e,t,i){return Object(n.b)(this,void 0,void 0,(function*(){if(!e||!e.placements||0===e.placements.length)return void C.a.sendAppErrorEvent(Object(r.a)(o.Fe,"Fetch NativeAd failed","No placements found in the request"));const s=w.b.Locale;if(!this.cmsNativeAdsItemsMap.has(t)){const e=yield this.cmsService.getCMSList(t,s);e&&e.id&&e.items&&this.cmsNativeAdsItemsMap.set(t,e.items)}const n=this.buildAdResponse(e),a=this.cmsNativeAdsItemsMap.has(t)?this.cmsNativeAdsItemsMap.get(t):[];for(const e of n.placements){const t=i.shift();let n,r;if(t){let e=parseInt(t,10);if(e)e=Math.max(e-1,0),e=e<a.length?e:e%a.length,n=a[e];else{if(!this.cmsNativeAdsItemsMap.has(t)){const e=yield this.cmsService.getCMSList(t,s);e&&e.id&&e.items&&this.cmsNativeAdsItemsMap.set(t,e.items)}const e=this.cmsNativeAdsItemsMap.has(t)?this.cmsNativeAdsItemsMap.get(t):[];n=Object(l.a)(e)[0],n||(n=a[this.cmsAdsCounter%a.length])}}else n=a[this.cmsAdsCounter%a.length];n&&(r={title:n.title,destinationUrl:n.url,imageUrl:n.imageUrl,providerName:n.provider?n.provider.name:""},e.items.push(r),e.privacyUrl=n.privacyUrl),this.cmsAdsCounter++}return n}))}updateSamAdResponse(e,t,i){const s=this.cmsItems,n=this.mapSAMPlacements(t),a=!s||0==s.length;return e.pageViewId=t&&t.metaData&&t.metaData.pageViewId,e.placements.forEach(e=>{const t=e.region+e.regionIndex,r=n.get(t);if(r&&r.items&&r.items.length>0){r.items.forEach(t=>{const i={title:t.title,destinationUrl:t.url,providerName:t.sourceName,adChoiceIconUrl:t.adChoicesUrl,imageUrl:t.imageUrl,imageHeight:t.imageHeight,imageWidth:t.imageWidth,images:t.images,clickBeacons:t.clickBeacons,uniqueId:t.uniqueId,beaconsJson:t.beaconsJson,feedbackUrl:this.generateFeedbackUrl(t.clickBeacons),originalImageWidth:t.originalImageWidth,originalImageHeight:t.originalImageHeight,verificationParameters:t.verificationParameters};this.updateAssetVideoField(i,t.assets),this.updateAssetDataFields(i,t.assets),e.items.push(i)});const t=Object(fe.a)(e,0);e.videoViewabilityData=t?t.ViewabilityProps:null,e.privacyUrl=r.privacyUrl,e.adServedUrls=r.adServedUrls,e.jsTrackerUrls=r.jsTrackerUrls,e.visibilityUrls=r.visibilityUrls,e.beaconsJson=r.beaconsJson,e.bingTrackerUrls=r.bingTrackerUrls,e.geminiViewabilityDataJson=r.geminiViewabilityDataJson,e.providerId=r.providerId;const s=!0===w.b.IsPrerender?performance.now()-Object(c.g)(d.d):performance.now();Object(c.o)(A.a.TimeToServeAd,s),this.templateService.updateTemplate(e,i)}else if(a)this.handleCmsStandyPlacement(e);else{const t=this.backfillIndex++%s.length,i=s[t],n={title:i.title,destinationUrl:i.url,imageUrl:this.updateImageUrl(e,i.imageUrl),providerName:i.provider?i.provider.name:""};e.items.push(n),e.privacyUrl=i.privacyUrl,e.isBackfill=!0}}),e}handleCmsStandyPlacement(e){if(this.cmsItems){const e=this.cmsItems;for(const t of this.callbackFnPlacementList){const i=e[this.backfillIndex++%e.length],s={title:i.title,destinationUrl:i.url,imageUrl:i.imageUrl,providerName:i.provider?i.provider.name:""};t.items.push(s),t.privacyUrl=i.privacyUrl,t.isBackfill=!0}this.callbackList.forEach(e=>{e(this)}),this.callbackList=[],this.callbackFnPlacementList=[]}else e&&this.callbackFnPlacementList.push(e)}loadCmsBackFillList(){const e=this.locale?this.locale:w.b.Locale,t=a.c[e];t&&!this.cmsItems&&this.cmsService.getCMSList(t,e).then(e=>{e?(this.cmsItems=e.items,this.handleCmsStandyPlacement()):++this.cmsRetryCount<10&&this.loadCmsBackFillList()})}mapSAMPlacements(e){const t=new Map;return e&&e.placements&&e.placements.forEach(e=>{e.region&&e.index&&t.set(e.region+e.index,e)}),t}buildAdResponse(e){const t=[];e.placements.forEach(e=>{e.region&&e.indices&&e.indices.length&&e.indices.forEach(i=>{const s={region:e.region,regionIndex:i,imageHeight:e.imageHeight,imageWidth:e.imageWidth,items:[]};t.push(s)})});let i=a.a[e.locale];i||(i="Ad");return{placements:t,adLabelText:i,isGreyAdsLabelEnabled:a.g.includes(e.locale),privacyUrl:a.b.PrivacyUrl}}updateImageUrl(e,t){return e&&e.imageWidth&&e.imageHeight&&t?t.replace("w=624","w="+e.imageWidth).replace("h=350","h="+e.imageHeight):t}updateAssetDataFields(e,t){const i=Object(h.a)(t,(e,t)=>{const i=Object(u.a)(t,"data.type"),s=Object(g.a)(J,e=>e===i);return s&&(e[s]=Object(u.a)(t,"data.value")),e},{});e.assets=i}updateAssetVideoField(e,t){t&&t.length>0&&t.forEach(t=>{const i=Object(u.a)(t,"video.vasttag");i&&(e.video=i)})}getAdTagStyleByLocale(e){const t=null!=e?e:w.b.Locale;return{adLabelText:a.a[t],isGreyAdsLabelEnabled:a.g.includes(t)}}}let ve;function ye(){return ve||(ve=new be),ve.resetNativeAdService(),ve}},eupA:function(e,t,i){"use strict";var s=i("JFdr");t.a=function(e,t){var i=-1,n=e.length,a=n-1;for(t=void 0===t?n:t;++i<t;){var r=Object(s.a)(i,a),o=e[r];e[r]=e[i],e[i]=o}return e.length=t,e}},hV4J:function(e,t,i){"use strict";var s=i("2JSu"),n=i("HVAe"),a=i("p6Gq"),r=i("MyC+"),o=Object.prototype,c=o.hasOwnProperty,d=Object(s.a)((function(e,t){e=Object(e);var i=-1,s=t.length,d=s>2?t[2]:void 0;for(d&&Object(a.a)(t[0],t[1],d)&&(s=1);++i<s;)for(var l=t[i],h=Object(r.a)(l),u=-1,g=h.length;++u<g;){var p=h[u],m=e[p];(void 0===m||Object(n.a)(m,o[p])&&!c.call(e,p))&&(e[p]=l[p])}return e}));t.a=d},hme2:function(e,t,i){"use strict";i.d(t,"a",(function(){return C}));var s=i("D57K"),n=i("OkDC"),a=i("tMmC"),r=i("HxRh"),o=i("ypwz"),c=i("tERu"),d=i("rvYQ"),l=i("msIb"),h=i("6ADy"),u=i("/+Un"),g=i("KETb");class p{constructor(e){this.fetchImpl=e,this.actionsEndpoint="./Graph/Actions",this.defaultOcid="Peregrine"}sendPostActionRequest(e,t=this.defaultOcid,i=!0){return Object(s.b)(this,void 0,void 0,(function*(){const n=JSON.stringify(e),a={method:"POST",body:n,headers:yield l.a.getOneServiceHeaders()};(yield Object(u.e)())&&(a.credentials="include");const r=Object(h.d)(this.actionsEndpoint);(yield l.a.getCommonParams2(t,i)).forEach(e=>e.value&&r.searchParams.set(e.key,e.value));return yield Object(g.a)(()=>Object(s.b)(this,void 0,void 0,(function*(){const e=yield this.fetchImpl(r.href,a);if(e.status>=400){const t=`OneService returned error response. Status: ${e.status} for Post request: ${r.href} with params ${JSON.stringify(a)}`;throw new Error(t)}return e})),"postAction"+n)}))}sendDeleteActionRequest(e,t=this.defaultOcid,i=!0){return Object(s.b)(this,void 0,void 0,(function*(){const n=yield l.a.getBaseRequestData("DELETE");(yield Object(u.e)())&&(n.credentials="include");let a="";const r=Object.keys(e),o=r.length;for(let t=0;t<o;t++)a+=`${r[t]} eq '${e[r[t]]}'`,t!=o-1&&o>1&&(a+=" and ");const c={key:"$filter",value:a},d=Object(h.d)(this.actionsEndpoint);[c,...yield l.a.getCommonParams2(t,i)].forEach(e=>e.value&&d.searchParams.set(e.key,e.value));return yield Object(g.a)(()=>Object(s.b)(this,void 0,void 0,(function*(){const e=yield this.fetchImpl(d.href,n);if(e.status>=400){const t=`OneService returned error response. Status: ${e.status} for Delete request: ${d.href} with params: ${JSON.stringify(n)}`;throw new Error(t)}return e})),"deleteAction"+a)}))}}var m=i("u5KZ"),f=i("ac9z"),b=i("HDSB");class v extends class{constructor(e){this.fetchImpl=e,this.ocid="feeds",this.freServiceEndpoint="news/fre",this.userEndpoint="./msn/user",this.addPageInfoToOcid=!0,this.actionsClient=new p(e),d.b.AppType!==o.a.NewsAndInterests&&d.b.AppType!==o.a.WindowsNewsPlus||(this.addPageInfoToOcid=!1,this.ocid="winp2")}getFreArtifacts(){return Object(s.b)(this,void 0,void 0,(function*(){const e=Object(h.d)(this.freServiceEndpoint);e.searchParams.set("bypass_trigger","true");return[...(yield Object(u.d)())===c.c.SignedIn?l.a.getOneServiceParamsWithAuth(Object(d.c)().UserId,this.ocid,this.addPageInfoToOcid):l.a.getOneServiceParamsWithoutAuth(Object(d.c)().UserId,this.ocid,this.addPageInfoToOcid),{key:f.a,value:Date.now().toString()}].forEach(t=>{t.value&&e.searchParams.set(t.key,t.value)}),this.getFreArtifactsWithUrl(e.href)}))}getFreArtifactsWithUrl(e){return Object(s.b)(this,void 0,void 0,(function*(){if(!e||"-1"===e)return null;const t={method:n.d.Get,credentials:"include",headers:yield l.a.getOneServiceHeaders()};try{const i=yield Object(g.a)(()=>Object(s.b)(this,void 0,void 0,(function*(){return yield this.fetchImpl(e,t)})),"getFreArtifacts");if(!i.ok)throw Error("[FreServiceClient.getFreArtifacts] Failed with response: "+JSON.stringify(i));const n=i.headers&&i.headers.get("ddd-tmpl");return m.a.addOrUpdateTmplString(n),i.json()}catch(e){throw a.a.logError(e.message),e}}))}setFreArtifactForUser(e,t){return Object(s.b)(this,void 0,void 0,(function*(){if(e&&t){const i={method:t,credentials:"include",headers:yield l.a.getOneServiceHeaders()};Object(h.d)(this.freServiceEndpoint);let n=0;try{if(n=(yield Object(g.a)(()=>Object(s.b)(this,void 0,void 0,(function*(){return yield this.fetchImpl(e,i)})),"setFreArtifact")).status,n>=400){const e=`OneService returned error response. Status: ${n} for done action`;throw new Error(e)}}catch(e){return a.a.logError(e.message),n}return n}return m.a.sendAppErrorEvent(Object.assign(Object.assign({},r.Qh),{message:`Any of the required parameters was not properly set by the caller. callbackUrl: ${e} method: ${t}.`})),0}))}updateArtifactInActionsEndpoint(e,t){return Object(s.b)(this,void 0,void 0,(function*(){let i;n.a[e.type]&&(i=Object.assign({},n.a[e.type])),i.targetId=e.id;try{t?yield this.actionsClient.sendPostActionRequest(i,this.ocid,this.addPageInfoToOcid):yield this.actionsClient.sendDeleteActionRequest(i,this.ocid,this.addPageInfoToOcid),Object(f.d)()}catch(i){m.a.sendAppErrorEvent(Object.assign(Object.assign({},r.ye),{message:"Fre Actions call failed",pb:Object.assign(Object.assign({},r.ye.pb),{customMessage:`artifact: ${JSON.stringify(e)} following: ${t} error message: ${i}`})}))}}))}setDoneFreState(){return Object(s.b)(this,void 0,void 0,(function*(){yield this.setFreState(JSON.stringify({stage:n.b}),r.jc)}))}setMaybeLaterFreState(){return Object(s.b)(this,void 0,void 0,(function*(){yield this.setFreState(JSON.stringify({dismiss_timestamp:new Date(Date.now()).toJSON()}),r.Ae)}))}setFreState(e,t){return Object(s.b)(this,void 0,void 0,(function*(){const i={method:"POST",body:JSON.stringify({freMultiStepState:e}),headers:yield l.a.getOneServiceHeaders()};(yield Object(u.d)())===c.c.SignedIn&&(i.credentials="include");const n=Object(h.d)(this.userEndpoint);(yield l.a.getCommonParams2(this.ocid,this.addPageInfoToOcid)).forEach(e=>e.value&&n.searchParams.set(e.key,e.value));try{yield Object(g.a)(()=>Object(s.b)(this,void 0,void 0,(function*(){const e=yield this.fetchImpl(n.href,i);if(e.status>=400){const t=`OneService returned error response. Status: ${e.status} for call to set user state`;throw new Error(t)}return e.json()})),"sendFreDoneAction")}catch(i){m.a.sendAppErrorEvent(Object.assign(Object.assign({},t),{message:"Service call to set fre state failed",pb:Object.assign(Object.assign({},t.pb),{customMessage:`state: ${e} error: ${i}`})}))}}))}}{constructor(e){let t;t=e||(Object(b.a)()?window.fetch.bind(window):fetch),super(t)}}let y;const C=e=>y||(y=new v(e),y)},iCsu:function(e,t,i){"use strict";i.r(t),i.d(t,"DesktopFeedEdgeNext",(function(){return dt})),i.d(t,"DesktopFeedEdgeNextActions",(function(){return U})),i.d(t,"DesktopFeedEdgeNextConnector",(function(){return Ye})),i.d(t,"DesktopFeedEdgeNextReducer",(function(){return tt})),i.d(t,"ToolingInfo",(function(){return lt}));var s=i("+viU"),n=i("8+qV"),a=i("OOuA"),r=i("Nt9a"),o=i("VFke"),c=i("5mwN"),d=i("Jw3B"),l=i("plCa"),h=i("wXkv"),u=i("Zn5T"),g=i("K1Uj"),p=i("f/Yt"),m=i("0fst"),f=i("0dho"),b=i("rvYQ"),v=i("LJMo"),y=i("rFwl"),C=i("OnwC"),S=i("HFPz");S.a;class O extends C.a{constructor(e){super(e),this.handledProps={addCloseButton:void 0,closeButtonAriaLabel:void 0,closeButtonTelemetryTag:void 0,hidden:void 0,managedClasses:void 0,sourceLink:void 0,videoEmbedPlayerHeight:void 0,videoEmbedPlayerTelemetryTag:void 0,videoEmbedPlayerWidth:void 0}}render(){const{addCloseButton:e,closeButtonTelemetryTag:t,closeButtonAriaLabel:i,hidden:s,videoEmbedPlayerHeight:n,videoEmbedPlayerWidth:r,sourceLink:o}=this.props;return Object(a.a)(S.a,{hidden:s,addCloseButton:e,sourceLink:o,props:{closeButtonAriaLabel:i,closeButtonTelemetryTag:t,videoEmbedPlayerHeight:n,videoEmbedPlayerWidth:r}})}}var A=i("rRWH");let I=!0;const w=Object(s.a)(e=>(I="left"===Object(A.b)("left","right",e.direction),{}))(O);var R=i("mXQk"),T=i("ERkP"),j=i.n(T),x=i("7nmT"),P=i.n(x),M=i("o1qX"),E=i("+djJ"),D=i("jrUk"),k=i("u5KZ"),L=i("JnE6");class F extends c.a{constructor(e){super(e),this.handledProps=Object.assign(Object.assign({},c.b),{actionsMenuOpen:void 0,actionsMenuProps:void 0,bingVideoCardData:void 0,closeColdStartExperience:void 0,closeSDCardActionsMenu:void 0,coldStartConfigInfoFre:void 0,coldStartFreResponse:void 0,consumeVerticalTab:void 0,customField:void 0,designSystemOverrides:void 0,enableScrollDownTopSiteInf:void 0,enableWillChange:void 0,experienceName:void 0,fixedCardHeight:void 0,hasRightRail:void 0,isVerticalTabEnabled:void 0,layoutGap:void 0,horizontalTabLayoutGap:void 0,managedClasses:void 0,moneyCardData:void 0,onMount:void 0,onUnmount:void 0,onUserPaginate:void 0,reverseLayoutGap:void 0,riverSectionFeedLayoutData:void 0,riverSectionTelemetryObject:void 0,toast:void 0}),this.handleClick=e=>{this.props.actionsMenuProps&&this.props.actionsMenuProps.referrerButton&&!this.props.actionsMenuProps.referrerButton.contains(e.path[0])&&this.actionsMenuEl&&!this.actionsMenuEl.contains(e.path[0])&&this.props.closeSDCardActionsMenu()},this.handleKeyDown=e=>{this.props.actionsMenuProps&&this.props.actionsMenuProps.referrerButton&&!this.props.actionsMenuProps.referrerButton.contains(e.path[0])&&this.actionsMenuEl&&!this.actionsMenuEl.contains(e.path[0])&&this.props.closeSDCardActionsMenu()},this.renderSDCardActionMenu=()=>{const{actionsMenuOpen:e,actionsMenuProps:t}=this.props;return e&&t?P.a.createPortal(Object(a.a)(y.a,Object.assign({},t,{overrideStyles:{zIndex:""+m.a.Above},ref:e=>this.actionsMenuEl=P.a.findDOMNode(e)})),document.getElementById("edge-chromium-page-root")):null},this.onBreakpointChange=e=>{this.setState({columnArrangement:this.props.hasRightRail?this.updateColumnArrangementForRightRail(e):e})},this.onSentinelChange=e=>{if(!e||e.length<1)return;(e[1]||e[0]).isIntersecting?(this.sentinelInView=!0,this.props.onUserPaginate()):this.sentinelInView=!1},this.onMoneyCardAddSymbolClick=()=>{this.props.moneyCardData.setMoneyCardData({cardType:g.b.AddWatchlist,lastCardType:this.props.moneyCardData.cardType,optionSwitch:!1,showSuggestions:!1,noSuggestion:!1,searchSuggestions:[]})},this.onMoneyCardActionInputText=e=>{const t=e.detail;this.props.moneyCardData.handleQuoteSearch(t)},this.onMoneyCardTitleClick=()=>{this.props.moneyCardData.cardType===g.b.AddWatchlist&&this.props.moneyCardData.setMoneyCardData({cardType:this.props.moneyCardData.lastCardType,lastCardType:this.props.moneyCardData.cardType,showSuggestions:!1,noSuggestion:!1,searchSuggestions:[]})},this.addToWatchlist=e=>{const t=e.detail;this.props.moneyCardData.addToWatchlist(t)},this.getColumnArrangementForFeed=e=>{const t=this.state.columnArrangement;switch(t){case d.a.c1:return d.a.c2.toUpperCase();case d.a.c5:return f.a.fiveColSupported()&&e.C5&&e.C5.length>0?d.a.c5.toUpperCase():d.a.c4.toUpperCase();default:return t.toUpperCase()}},this.updateColumnArrangementForRightRail=e=>{switch(e){case d.a.c5:return d.a.c4;case d.a.c4:return d.a.c3;case d.a.c3:return d.a.c2;case d.a.c2:return d.a.c1;default:return e}},this.ttvrFirstSectionFired=!1;const t=Object(l.a)().currentColumnArrangement;this.state={columnArrangement:this.props.hasRightRail?this.updateColumnArrangementForRightRail(t):t},this.desktopFeedEdgeNextContainerRef=j.a.createRef()}scrollToHideTopSites(){const e=document.documentElement?document.documentElement:document.body;if(e){const t=e=>{e&&(k.a.scheduleContentViewEvent(L.b.AutoScroll),e.preventDefaultScroll=!0),document.removeEventListener("scroll",t)};document.addEventListener("scroll",t),e.scrollTop=54}}componentDidMount(){super.componentDidMount(),this.props.enableScrollDownTopSiteInf&&this.scrollToHideTopSites(),!this.ttvrFirstSectionFired&&this.props.riverSectionFeedLayoutData&&this.props.riverSectionFeedLayoutData.length>0&&(Object(E.l)(h.a.riverFirstSection),this.ttvrFirstSectionFired=!0),Object(l.a)().subscribe(this.onBreakpointChange),"IntersectionObserver"in window&&(this.sentinelObserver=new IntersectionObserver(this.onSentinelChange,{threshold:[0,1]}),requestAnimationFrame(()=>{this.sentinelObserver.observe(document.querySelector("#pagination"))})),this.checkPaginationListeners(),this.props.bingVideoCardData&&"Overlay"===this.props.bingVideoCardData.navigateDestination&&this.renderBingOverlayPlayer(),document.addEventListener("action-add-symbol",this.onMoneyCardAddSymbolClick),document.addEventListener("action-text-input",this.onMoneyCardActionInputText),document.addEventListener("action-title-clicked",this.onMoneyCardTitleClick),document.addEventListener("action-add-to-watchlist",this.addToWatchlist),document.addEventListener("mousedown",this.handleClick),document.addEventListener("keydown",this.handleKeyDown),this.props.onMount&&this.props.onMount(),this.props.closeColdStartExperience&&this.coldStartContainerElement&&(this.coldStartContainerElement.addEventListener(R.a,this.props.closeColdStartExperience),this.coldStartContainerElement.addEventListener(R.b,this.props.closeColdStartExperience))}componentDidUpdate(){if(super.componentDidUpdate(),!this.ttvrFirstSectionFired&&this.props.riverSectionFeedLayoutData&&this.props.riverSectionFeedLayoutData.length>0&&(Object(E.l)(h.a.riverFirstSection),this.ttvrFirstSectionFired=!0),this.checkPaginationListeners(),b.b.ClarityEnabled&&this.desktopFeedEdgeNextSectionRef){new MutationObserver(e=>{const t=this.desktopFeedEdgeNextSectionRef.querySelectorAll("msft-feed-layout");if(t.length)for(let e=0;e<t.length;e++){const i=t[e].shadowRoot.querySelectorAll("fluent-card > msft-weather-card");for(let e=0;e<i.length;e++)i[e].setAttribute("data-clarity-mask","true")}}).observe(this.desktopFeedEdgeNextSectionRef,{childList:!0,subtree:!0,attributes:!0})}}componentWillUnmount(){Object(l.a)().unsubscribe(this.onBreakpointChange),this.sentinelObserver&&this.sentinelObserver.unobserve(document.querySelector("#pagination")),this.removeBingOverlayPlayer(),document.removeEventListener("action-add-symbol",this.onMoneyCardAddSymbolClick),document.removeEventListener("action-text-input",this.onMoneyCardActionInputText),document.removeEventListener("action-title-clicked",this.onMoneyCardTitleClick),document.removeEventListener("action-add-to-watchlist",this.addToWatchlist),document.removeEventListener("mousedown",this.handleClick),document.removeEventListener("keydown",this.handleKeyDown),this.props.onUnmount&&this.props.onUnmount(),this.coldStartContainerElement&&this.coldStartContainerElement.removeEventListener(R.a,this.props.closeColdStartExperience),this.coldStartContainerElement&&this.coldStartContainerElement.removeEventListener(R.b,this.props.closeColdStartExperience)}render(){const e=this.getGap(),t=Object(M.a)(this.props.managedClasses.desktopFeedEdgeNext_root,[this.props.managedClasses.desktopFeedEdgeNext_withRightRail,this.props.hasRightRail&&(!e||12===e)],[this.props.managedClasses.desktopFeedEdgenext_withRightRail_4gutter,this.props.hasRightRail&&4===e],[this.props.managedClasses.desktopFeedEdgenext_withRightRail_6gutter,this.props.hasRightRail&&6===e],[this.props.managedClasses.desktopFeedEdgenext_withRightRail_8gutter,this.props.hasRightRail&&8===e],[this.props.managedClasses.desktopFeedEdgenext_withRightRail_10gutter,this.props.hasRightRail&&10===e]);return Object(a.a)("div",Object.assign({},this.unhandledProps(),{className:t}),Object(a.a)("div",{id:"infopane-sentinel",className:this.props.managedClasses.infopaneSentinel}),this.renderRiver(),Object(a.a)("div",{id:"pagination",className:this.props.managedClasses.paginationSentinel}),this.renderSDCardActionMenu(),Object(D.a)(this.props.toast),Object(a.a)("div",{ref:e=>this.coldStartContainerElement=e},this.props.coldStartFreResponse&&this.renderColdStartFre()),this.props.coldStartFreResponse&&this.renderColdStartFre())}renderRiver(){if(!this.props.riverSectionFeedLayoutData.length)return;const e=this.getGap(),t=Object(M.a)(this.props.managedClasses.feedSection,[this.props.managedClasses.xlGap,10===e],[this.props.managedClasses.lGap,8===e],[this.props.managedClasses.mGap,6===e],[this.props.managedClasses.xmGap,4===e]);return Object(a.a)("div",Object.assign({},this.props.riverSectionTelemetryObject?this.props.riverSectionTelemetryObject.render():null,{className:t,ref:e=>this.desktopFeedEdgeNextSectionRef=e,style:this.props.enableWillChange?{"will-change":"auto"}:{}}),this.renderRiverSections())}getGap(){let e=12;return this.props.reverseLayoutGap||(e=this.props.consumeVerticalTab&&!this.props.isVerticalTabEnabled?this.props.horizontalTabLayoutGap:this.props.layoutGap),e}updateLayoutGap(e,t,i){if(t&&(e.gap=t+"px",this.props.fixedCardHeight&&i!==v.a.ShoppingCarousel)){const i=((304-t)/2).toFixed(1);e.gridAutoRows=i+"px"}}renderRiverSections(){if(!this.props.riverSectionFeedLayoutData.length)return;const e=e=>{const t={};if(!this.props.reverseLayoutGap)return this.props.consumeVerticalTab&&!this.props.isVerticalTabEnabled?this.updateLayoutGap(t,this.props.horizontalTabLayoutGap,e):this.updateLayoutGap(t,this.props.layoutGap,e),t};return this.props.riverSectionFeedLayoutData.map((t,i)=>{var s;return Object(a.a)(p.a,{style:e(null===(s=t.cardMetadataList)||void 0===s?void 0:s[0].type),key:"riverSection-"+i,attrs:{layout:this.getColumnArrangementForFeed(t.feedData)},props:{data:t.feedData,cardTemplateMap:r.a,layoutStyles:o.a[t.templateId].styles}})})}renderColdStartFre(){const{coldStartFreResponse:e}=this.props,t={coldStartArtifact:e,parentContainerElement:this.coldStartContainerElement};return Object(D.a)(this.props.coldStartConfigInfoFre,{properties:t})}checkPaginationListeners(){this.props.riverSectionFeedLayoutData.length&&(this.paginationAnimationFrameId&&cancelAnimationFrame(this.paginationAnimationFrameId),this.checkPaginationTimeout&&clearTimeout(this.checkPaginationTimeout),this.checkPaginationTimeout=setTimeout(()=>{this.sentinelInView&&(this.paginationAnimationFrameId=requestAnimationFrame(()=>{this.paginationAnimationFrameId=null,this.checkPaginationTimeout=null,this.props.onUserPaginate()}))},100))}renderBingOverlayPlayer(){const{bingOverlayPlayerHeight:e,bingOverlayPlayerWidth:t}=this.props.bingVideoCardData,i={addCloseButton:!0,hidden:!0,sourceLink:"",videoEmbedPlayerWidth:t,videoEmbedPlayerHeight:e};if(!document.getElementById("bing-video-embed-player-root")){const e=Object(a.a)(w,Object.assign({},i)),t=document.createElement("div");t.id="bing-video-embed-player-root",document.body.appendChild(t),P.a.render(e,t)}}removeBingOverlayPlayer(){const e=document.getElementById("bing-video-embed-player-root");e&&document.body.removeChild(e)}}F.defaultProps={experienceName:u.a.desktopFeedEdgeNext};var N=i("G82u");class U{}U.setAutoRotate=new N.a("SetAutoRotate"),U.setIsFocused=new N.a("SetIsFocused"),U.setIsMouseOver=new N.a("SetIsMouseOver"),U.setMoneyCardData=new N.a("SetMoneyCardData"),U.setRiverSectionFeedLayoutData=new N.a("SetRiverSectionFeedLayoutData"),U.setWeatherCardData=new N.a("SetWeatherCardData"),U.toggleSDCardActionsMenu=new N.a("ToggleSDCardActionsMenu"),U.setColdStartExperience=new N.a("SetColdStartExperience");var W,H,q=i("y4Tj"),V=i("D57K"),B=i("Cn94"),_=i("bYbF"),$=i("oIHq"),G=i("cASJ"),z=i("hdNv"),Q=i("cxul"),K=i("8f7u"),J=i("J48h"),X=i("HN5f"),Z=i("ssy2"),Y=i("dTwT"),ee=i("RIQ7"),te=i("gmMM"),ie=i("I6Lx"),se=i("Ac7j"),ne=i("jE1l"),ae=i("s9+9"),re=i("Bwzq"),oe=i("Uw7R"),ce=i("XlyT"),de=i("HxRh"),le=i("YUMq"),he=i("H3ag");!function(e){e.Long="long",e.Short="short"}(W||(W={})),function(e){e.Disabled="disabled",e.OnScroll="onScroll",e.Alwasy="always"}(H||(H={}));var ue=i("rGfm"),ge=i("X9Vi"),pe=i("HcI6"),me=i("mJFi"),fe=i("x/PH"),be=i("7oW3"),ve=i("Z3LZ"),ye=i("+8mm"),Ce=i("ydPk"),Se=i("rPvf");const Oe={[v.a.StockQuote]:"finance",[v.a.SportsMatch]:"sports",[v.a.WeatherSummary]:"weather"},Ae={[Q.b.bingVideoCarousel]:de.Y,[Q.b.healthCard]:de.I,[Q.b.moneyCard]:de.Ef,[Q.b.sportsCard]:de.mi,[Q.b.horoscopeAnswerCard]:de.Xe,[Q.b.onThisDayCard]:de.cg,[Q.b.travelDestinationCard]:de.hj,[Q.b.weatherCard]:de.Zj};var Ie=i("w0HK"),we=i("loKy"),Re=i("Z118"),Te=i("6I6u"),je=i("XMfh"),xe=i("hme2"),Pe=i("8ntK"),Me=i("Qo3E"),Ee=i("9RHM"),De=i("1aPi"),ke=i("X3C0"),Le=i("zZnt"),Fe=i("Cj5D"),Ne=i("ac9z"),Ue=i("WfnD");const We={inspect:e=>{var t;const{config:i,state:s,connectorArgs:n}=e,{moneyCardData:a,coldStartFreResponse:r}=s,o=i.bingVideoCardConfig||{},{childExperienceReferencesWC:c}=i,d=[];return{props:{layoutGap:i.layoutGap,horizontalTabLayoutGap:i.horizontalTabLayoutGap,isVerticalTabEnabled:n.isVerticalTabEnabled,consumeVerticalTab:i.consumeVerticalTab,reverseLayoutGap:i.reverseLayoutGap,actionsMenuProps:s.actionsMenuProps,actionsMenuOpen:s.actionsMenuOpen,bingVideoCardData:{bingOverlayPlayerHeight:null==o?void 0:o.bingVideoOverlayPlayerHeight,bingOverlayPlayerSrcFormat:null==o?void 0:o.bingVideoPlayerSrcFormat,bingOverlayPlayerWidth:null==o?void 0:o.bingVideoOverlayPlayerWidth,navigateDestination:null==o?void 0:o.navigateDestination,pivotSelectionInfo:null==o?void 0:o.pivotSelectionInfo},coldStartFreResponse:r,designSystemOverrides:i.designSystemOverrides,onUserPaginate:n.onUserPaginate,closeSDCardActionsMenu:n.closeSDCardActionsMenu,riverSectionFeedLayoutData:s.riverSectionFeedLayoutData?s.riverSectionFeedLayoutData:[],onUnmount:n.onUnmount,onMount:n.onMount,hasRightRail:n.hasRightRail,moneyCardData:{cardType:a.cardType,dataFrom:a.dataFrom,lastCardType:a.lastCardType,optionSwitch:a.optionSwitch,actionMenuProps:a.actionMenuProps,userSignedIn:a.userSignedIn,searchSuggestions:a.searchSuggestions,showSuggestions:a.showSuggestions,noSuggestion:a.noSuggestion,moneyCardElement:a.moneyCardElement,financeDataProviderPage:i.moneyCardConfig.financeDataProviderPage,addToWatchlist:n.addToWatchlist,handleQuoteSearch:n.handleQuoteSearch,setMoneyCardData:n.setMoneyCardData,goToAddSymbolCallback:n.goToAddSymbolCallback},toast:null===(t=i.childExperienceReferencesWC)||void 0===t?void 0:t.toastWC,coldStartConfigInfoFre:null==c?void 0:c.coldStartModal,fixedCardHeight:i.fixedCardHeight,enableWillChange:i.enableWillChange},missingChildren:d}}};var He=i("eoyk"),qe=i("+qLX"),Ve=i("lV/q"),Be=i("HDSB"),_e=i("W+kI"),$e=i("XLvf"),Ge=i("MRe/"),ze=i("C/Vb"),Qe=i("A8DD"),Ke=i("MSQM"),Je=i("KETb");const Xe=Object(oe.a)();var Ze;!function(e){e[e.FirstFetchAndRenderContent=0]="FirstFetchAndRenderContent",e[e.SubFetchAndRenderContent=1]="SubFetchAndRenderContent",e[e.RenderContent=2]="RenderContent"}(Ze||(Ze={}));class Ye extends Ue.a{constructor(e,t,i,s,n,a,r){super(e,t,i,s,n,a,r),this.isFetchingContent=!1,this.infoPaneNativeAdsMap=[],this.tabInfoPaneNativeAdsMap=[],this.riverNativeAdsMap=[],this.selectCarouselData={comics:null,editorsPick:null,select:null,dailyFixGames:null},this.cmsInfopaneNativeAdsMap=[],this.cmsRiverNativeAdsMap=[],this.unRenderedLayoutTemplate=[],this.unRenderedRiverContent=[],this.visualReadinessCallbackSet=!1,this.ttvrFired=!1,this.isFirstBatchCall=!0,this.isFirstFeedCall=!0,this.beaconService=new $.a,this.isDocumentVisible="visible"===document.visibilityState,this.waitingAdsMap=new Map,this.cmsAdsConfig={documentId:"",infoPaneIndices:[],riverIndices:[]},this.infoPaneAdRegionIndexList=[],this.riverAdRegionIndexList=[],this.tabInfoPaneAdRegionIndexList=[],this.infoPaneCmsAdRegionIndexList=[],this.riverCmsAdRegionIndexList=[],this.unServedSamAdSet=new Set,this.awayTimestamp=1/0,this.disablePrefetchHack=!1,this.initFirstDone=!1,this.onMount=()=>{document.addEventListener("visibilitychange",this.handleDocumentVisibilityChange)},this.onUnmount=()=>{document.removeEventListener("visibilitychange",this.handleDocumentVisibilityChange)},this.handleDocumentVisibilityChange=()=>{this.isDocumentVisible="visible"===document.visibilityState,this.isDocumentVisible?this.checkAwayTime():this.updateAwayTime()},this.refreshFeedWhenDisableSDCard=()=>Object(V.b)(this,void 0,void 0,(function*(){yield Object(Ne.d)(),this.refreshFeed()})),this.onScroll=()=>{this.enableScrollDownTopSiteInf&&document.documentElement.scrollTop<=54||(this.prefetchOnlyFirstTime(),window.removeEventListener("scroll",this.onScroll))},this.setVisuallyReadyMarkers=()=>{this.ttvrFired||(this.ttvrFired=!0,window.requestAnimationFrame(()=>{setTimeout(()=>{Object(E.k)(u.a.desktopFeedEdgeNext);const e=Object(ve.g)();e&&ye.a.updateVisuallyReadyTiming.getActionSender(e).send(Object(ve.c)(u.a.desktopFeedEdgeNext,void 0,void 0,void 0,window.performance.now()))},0)}))},this.cardActionClickHandler=(e,t,i,s,n,a,r)=>{if(!e||!t)return;const{riverSectionFeedLayoutData:o}=this.getCurrentState(),c=Object(z.h)(t);if(o&&o.length){this.rowCount=this.prevRowCount;const d=[];o.forEach(t=>{const i=[];let s=!1;t.cardMetadataList.forEach(t=>{if(t.type===v.a.Infopane){const n=t;n.subItems.forEach(t=>{t.id===e&&(s=!0,t.metadata=t.metadata||{},t.metadata.actions=c)}),i.push(n)}else{const n=t;n.id===e&&(s=!0,n.metadata=n.metadata||{},n.metadata.actions=c),i.push(n)}}),this.rowCount=this.prevRowCount,d.push(s?{feedData:this.mapFeedData(i,t.templateId,!1,this.riverSectionTelemetryObject),templateId:t.templateId,cardMetadataList:Object(Ee.a)(i)}:t)}),s&&n?this.cardActionServiceClient.PostCardActionV2Event(t,i,e,void 0,n,a,r):this.cardActionServiceClient.PostCardActionV2Event(t,i,e,void 0,null,a,r),U.setRiverSectionFeedLayoutData.getActionSender(this).send(d)}},this.activeItemChangedHandler=(e,t)=>{if(!e)return;const{riverSectionFeedLayoutData:i}=this.getCurrentState();if(i&&i.length){const s=[];i.forEach(i=>{const n=[];let a=!1;i.cardMetadataList.forEach(i=>{const s=i;s.id===e&&(a=!0,s.activeIndexForMultiAds=t),n.push(s)}),this.rowCount=this.prevRowCount,s.push(a?{feedData:this.mapFeedData(n,i.templateId,!1,this.riverSectionTelemetryObject),templateId:i.templateId,cardMetadataList:Object(Ee.a)(n)}:i)}),U.setRiverSectionFeedLayoutData.getActionSender(this).send(s)}},this.initCardAction=e=>{B.a.Init.getGlobalActionSender().send(Object.assign(Object.assign({},e),{overrideStyles:{zIndex:""+m.a.Above}}))},this.onUserPaginate=()=>{this.previousRiverSectionContentResponse&&Object(ve.j)().then(()=>this.renderNextFeed(Re.b.subsequent))},this.goToPersonalizeCallback=e=>{const{oneRiverInterestsPivotInfo:t}=this.config,i="muted-publishers"===e?{isRequestFromMutePublisherToast:!0,noScroll:!0}:{};Object(Ie.a)().switchPivot({pivotId:t.pivotId,configIndexHref:t.configIndexHref,configIndexRef:t.configIndexRef,context:Object.assign(Object.assign({},i),{isRequestFromSdCardAddRemoveClick:!1}),telemetryPageName:qe.a.Interests,display:t.displayName})},this.clickSDCardActionButton=(e,t,i,s)=>{e.menuItems.forEach(e=>{"edit"===e.id?t===Q.b.weatherCard&&(e.onClick=this.switchToWeatherSetting):"hide"===e.id?t===Q.b.weatherCard?e.onClick=()=>{this.showHideWeatherCardAndRefresh(i.cardName,!1,s)}:t===Q.b.moneyCard&&(e.onClick=()=>{this.showHideMoneyCardAndRefresh(i.cardName,!1,s)}):"more"===e.id?t===Q.b.sportsCard?e.onClick=this.goToPersonalizeCallback:e.onClick=this.goToPersonalizeSettingsCallback:"dataProvider"===e.id?e.onClick=this.showMoneyCardDataProvider:"addWatchlist"===e.id&&(e.onClick=this.goToAddSymbolCallback)}),e.onDismiss=this.closeSDCardActionsMenu;const n=!this.getCurrentState().actionsMenuOpen;U.toggleSDCardActionsMenu.getActionSender(this).send(e,n)},this.switchToWeatherSetting=()=>{this.setWeatherCardData({cardMode:"setting",setUnit:void 0,setLocMode:void 0,selectLocation:void 0,suggestedLocations:void 0}),U.toggleSDCardActionsMenu.getActionSender(this).send(this.getCurrentState().actionsMenuProps,!1)},this.updateSDCardData=e=>Object(V.b)(this,void 0,void 0,(function*(){var t;yield Object(Ne.e)();const i=yield this.SDCardProvider.fetch({contentType:Oe[e]}),s=i&&(null===(t=i[Oe[e]])||void 0===t?void 0:t.find(t=>t.type===e));s&&this.mapSDCardDataToFeedLayout(e,s)})),this.mapSDCardDataToFeedLayout=(e,t)=>{const i=this.getCurrentState().riverSectionFeedLayoutData;let s,n;i.slice(0,2).forEach((t,i)=>{n=t.cardMetadataList.find(t=>t.type===e),n&&(s=i)});const a=i[s],r=a.cardMetadataList.findIndex(t=>t.type===e),o=t?[...a.cardMetadataList.slice(0,r),t,...a.cardMetadataList.slice(r+1)]:a.cardMetadataList;this.rowCount=this.prevRowCount;const c=Object.assign(Object.assign({},a),{feedData:this.mapFeedData(o,a.templateId,!0,this.riverSectionTelemetryObject),cardMetadataList:o});U.setRiverSectionFeedLayoutData.getActionSender(this).send([...i.slice(0,s),c,...i.slice(s+1)])},this.setWeatherCardData=e=>Object(V.b)(this,void 0,void 0,(function*(){U.setWeatherCardData.getActionSender(this).send(e),yield this.mapSDCardDataToFeedLayout(v.a.WeatherSummary)})),this.showHideWeatherCardAndRefresh=(e,t,i)=>Object(V.b)(this,void 0,void 0,(function*(){const s=yield this.weatherPdpClient.enableDisableWeatherCard(t);if(U.toggleSDCardActionsMenu.getActionSender(this).send(this.getCurrentState().actionsMenuProps,!1),s&&(yield this.refreshFeedWhenDisableSDCard(),!t&&i)){const t={id:"hide-weather-toast",expirationInMs:5e3,inputText:e,toastType:Pe.a.Hide,onClick:()=>{this.showHideWeatherCardAndRefresh(null,!0,i)}};Me.a.renderToast(t)}if(this.pageSettingsDataConnector){const{sdCardSettings:e}=this.pageSettingsDataConnector.getCurrentState();e.weatherVisible=t,se.a.updateLocalStorage.getActionSender(this.pageSettingsDataConnector).send(e)}else if(Object(Y.a)().supported){const e=Object(Y.a)().getObject(Le.c,Le.b);e&&(e.weatherVisible=t),Object(Y.a)().setObject(Le.c,e)}return s})),this.showHideMoneyCardAndRefresh=(e,t,i)=>Object(V.b)(this,void 0,void 0,(function*(){const s=yield this.financeUserService.enableDisableMoneyCard(t);if(U.toggleSDCardActionsMenu.getActionSender(this).send(this.getCurrentState().actionsMenuProps,!1),s&&(yield this.refreshFeedWhenDisableSDCard(),!t&&i)){const t={id:"hide-money-toast",expirationInMs:5e3,inputText:e,toastType:Pe.a.Hide,onClick:()=>{this.showHideMoneyCardAndRefresh(null,!0,i)}};Me.a.renderToast(t)}if(this.pageSettingsDataConnector){const{sdCardSettings:e}=this.pageSettingsDataConnector.getCurrentState();e.moneyVisible=t,se.a.updateLocalStorage.getActionSender(this.pageSettingsDataConnector).send(e)}else if(Object(Y.a)().supported){const e=Object(Y.a)().getObject(Le.c,Le.b);e.moneyVisible=t,Object(Y.a)().setObject(Le.c,e)}return s})),this.goToPersonalizeSettingsCallback=()=>{Object(Fe.c)(this.config.oneRiverInterestsPivotInfo,!1),this.getCurrentState().actionsMenuOpen&&U.toggleSDCardActionsMenu.getActionSender(this).send(this.getCurrentState().actionsMenuProps,!1)},this.showMoneyCardDataProvider=()=>{window.open(this.config.moneyCardConfig.financeDataProviderPage,"_blank"),U.toggleSDCardActionsMenu.getActionSender(this).send(this.getCurrentState().actionsMenuProps,!1)},this.closeSDCardActionsMenu=()=>{U.toggleSDCardActionsMenu.getActionSender(this).send(this.getCurrentState().actionsMenuProps,!1)},this.handleNavClick=(e,t)=>Object(V.b)(this,void 0,void 0,(function*(){var t,i,s;let n=null===(t=this.getCurrentState().moneyCardData)||void 0===t?void 0:t.multiTabQuoteItems;n&&n[e]||(yield this.refreshMoneyCardData(),n=null===(i=this.getCurrentState().moneyCardData)||void 0===i?void 0:i.multiTabQuoteItems);const a=n[e];if(e===K.b.Watchlist){const t=(null===(s=this.getCurrentState().moneyCardData)||void 0===s?void 0:s.suggestedQuoteItems)||[],[i,r]=this.getCorrectWatchlist(a,t);return n[K.b.Watchlist]=a,void this.setMoneyCardData({cardType:J.b.EdgeShowData,quoteItems:i,suggestedQuoteItems:r,multiTabQuoteItems:n,activeTab:e})}this.setMoneyCardData({cardType:J.b.EdgeShowData,quoteItems:a,activeTab:e})})),this.getCorrectWatchlist=(e,t)=>{let i=e||[],s=t||[];if(t.length>0){const e=this.addedQuoteIds||[],t=s.filter(t=>e.includes(t.id));i=i.concat(t),s=s.filter(t=>!e.includes(t.id))}return[i,s]},this.handleAddToWatchlist=e=>Object(V.b)(this,void 0,void 0,(function*(){let t=this.addedQuoteIds||[];t=[...t],t.includes(e)||t.push(e),this.addedQuoteIds=t})),this.refreshMoneyCardData=()=>Object(V.b)(this,void 0,void 0,(function*(){var e,t,i,s,n,a,r,o,c;yield Object(Ne.e)();const d=this.financeUserService.getWatchlist(),l=this.financeService.getMarketMovers(),[h,u]=yield Promise.all([d,l]),g=(null===(e=this.config.moneyCardConfig)||void 0===e?void 0:e.maxNumQuotes)?null===(t=this.config.moneyCardConfig)||void 0===t?void 0:t.maxNumQuotes:3,p=null==h?void 0:h.slice(0,g),m=null===(s=null===(i=this.config.moneyCardConfig)||void 0===i?void 0:i.marketQuoteIds)||void 0===s?void 0:s.slice(0,g),f=null===(a=null===(n=this.config.moneyCardConfig)||void 0===n?void 0:n.currencyQuoteIds)||void 0===a?void 0:a.slice(0,g),b=null===(r=u.active)||void 0===r?void 0:r.slice(0,g),v=null===(o=u.gainers)||void 0===o?void 0:o.slice(0,g),y=null===(c=u.losers)||void 0===c?void 0:c.slice(0,g),C=this.getSuggestedQuoteIds(p,g),S=[...p,...m,...f,...b,...v,...y,...C],O=yield this.financeService.getQuoteSummary(S),A=this.getQuoteMapIdToItem(O),I=this.getQuoteItemsByIds(A,p),w=this.getQuoteItemsByIds(A,m),R=this.getQuoteItemsByIds(A,f),T=this.getQuoteItemsByIds(A,b),j=this.getQuoteItemsByIds(A,v),x=this.getQuoteItemsByIds(A,y),P=this.getQuoteItemsByIds(A,C),[M,E]=this.getCorrectWatchlist(I,P),D={[K.b.Watchlist]:M,[K.b.Market]:w,[K.b.Currencies]:R,[K.b.Movers]:T,[K.b.Gainers]:j,[K.b.Losers]:x,[K.b.Recent]:[]},k=this.getCurrentState().moneyCardData.activeTab;this.setMoneyCardData({cardType:J.b.EdgeShowData,suggestedQuoteItems:E,quoteItems:D[k],multiTabQuoteItems:D})})),this.getQuoteMapIdToItem=e=>{const t=new Map;if(!e)return t;for(let i=0;i<e.length;i+=1){const s=e[i],n=s.id;t.set(n,s)}return t},this.getQuoteItemsByIds=(e,t)=>{if(!e||!t||0===t.length)return[];const i=[];for(let s=0;s<t.length;s+=1){const n=t[s];if(e.has(n)){const t=e.get(n);i.push(t)}}return i},this.getSuggestedQuoteIds=(e,t)=>{var i,s;if(!e||e.length>=t)return[];let n=(null===(s=null===(i=this.config)||void 0===i?void 0:i.moneyCardConfig)||void 0===s?void 0:s.suggestedQuoteIds)||[];return n=n.filter(t=>!e.includes(t)),n=n.slice(0,t-e.length),n},this.saveWeaSettingAndRefresh=e=>Object(V.b)(this,void 0,void 0,(function*(){e&&e.changeSignal&&(yield this.saveWeaSettings(e)),U.setWeatherCardData.getActionSender(this).send({cardMode:"forecast"}),yield this.updateSDCardData(v.a.WeatherSummary)})),this.triggerWeatherLocAutoSuggest=e=>Object(V.b)(this,void 0,void 0,(function*(){let t=void 0;const i=e.trim();if(i){const e=yield this.weatherAutoSuggestClient.getAutoSuggestResponse(i);null!=e&&(t=e)}this.setWeatherCardData({suggestedLocations:t})})),this.switchToWeatherForecast=()=>{this.setWeatherCardData({cardMode:"forecast",setUnit:void 0,setLocMode:void 0,selectLocation:void 0,suggestedLocations:void 0})},this.selectWeatherLocationMode=e=>{this.setWeatherCardData({setLocMode:e})},this.selectWeatherUnit=e=>{this.setWeatherCardData({setUnit:e})},this.selectWeatherLocation=e=>{this.setWeatherCardData({selectLocation:e,suggestedLocations:void 0})},this.selectDetectedLocation=()=>Object(V.b)(this,void 0,void 0,(function*(){let e=ge.b.headLocation();e&&!ge.b.isCurrentLocaleName(e)&&this.weatherLocationLocalizeClient&&(e=yield this.weatherLocationLocalizeClient.getLocalisedLocationDetails(e)),this.selectWeatherLocation(e)})),this.setMoneyCardData=e=>{U.setMoneyCardData.getActionSender(this).send(e),this.updateSDCardData(v.a.StockQuote)},this.addToWatchlist=e=>Object(V.b)(this,void 0,void 0,(function*(){yield this.financeUserService.addToWatchlist(e),this.setMoneyCardData({cardType:J.b.ShowData,searchSuggestions:[],showSuggestions:!1,noSuggestion:!1}),yield Object(Ne.d)(),this.refreshFeed()})),this.goToAddSymbolCallback=()=>{if(this.config.moneyCardConfig.disableInLineAddWatchlist){const e=Object(ee.b)(),t=new URL(this.config.moneyCardConfig.financeWatchlistPage);e&&t.searchParams.append("ocid",e),window.open(t.href,"_blank")}else this.setMoneyCardData({cardType:J.b.AddWatchlist,lastCardType:this.getCurrentState().moneyCardData.cardType,optionSwitch:!1,showSuggestions:!1,noSuggestion:!1,searchSuggestions:[]});U.toggleSDCardActionsMenu.getActionSender(this).send(this.getCurrentState().actionsMenuProps,!1)},this.handleQuoteSearch=Object(De.a)(e=>Object(V.b)(this,void 0,void 0,(function*(){const t=e.trim();if(""!==t)try{const e=yield this.autoSuggestServiceConnect.getAutoSuggest(t,4);return void(e&&0!==e.length?this.setMoneyCardData({cardType:J.b.AddWatchlist,searchSuggestions:e,showSuggestions:!0,noSuggestion:!1}):this.setMoneyCardData({cardType:J.b.AddWatchlist,showSuggestions:!1,noSuggestion:!0}))}catch(e){this.setMoneyCardData({cardType:J.b.AddWatchlist,showSuggestions:!1,noSuggestion:!0})}else this.setMoneyCardData({cardType:J.b.AddWatchlist,showSuggestions:!1,noSuggestion:!1})})),200),this.initializeColdStartExperience=()=>{var e;(null===(e=this.config.childExperienceReferencesWC)||void 0===e?void 0:e.coldStartModal)&&Object(ve.j)().then(()=>{try{Object(xe.a)().getFreArtifacts().then(e=>{e&&e.fre?U.setColdStartExperience.getActionSender(this).send(e):e&&Object($e.isNullOrUndefined)(e.fre)&&e.subCards&&e.subCards.length&&Object(ce.b)(de.Xb,"FRE request was made but returned no flag or empty data")})}catch(e){Object(ce.c)(e,de.Oe,"Getting data for the required artifacts failed in desktop feed when initializing cold start experience")}})},this.closeColdStartExperience=()=>{U.setColdStartExperience.getActionSender(this).send(null)},this.resetRowCount(),this.pageSettingsDataConnector=i.connector(ae.a.ChromiumPageSettings),this.nativeAdService=Object(G.b)(),this.cardActionServiceClient=new _.a(window.fetch.bind(window),a.enableEnterpriseOCID),this.weatherPdpClient=new pe.a,this.weatherAutoSuggestClient=Object(me.a)(a&&a.weatherCardConfig&&a.weatherCardConfig.weatherAutoSuggestionConfig);const o=Object(Be.a)()?window.fetch.bind(window):fetch;this.weatherLocationLocalizeClient=new fe.a(o,{noDynamicQueryParams:!0}),this.addedQuoteIds=[],this.financeUserService=Z.a.getFinanceUserService(),this.financeService=Z.a.getCachedFinanceService(),this.autoSuggestServiceConnect=Z.a.getAutoSuggestService(),this.enableScrollDownTopSiteInf=function(e,t){const i=e.connector(ae.a.TopSitesLayoutData),s=e.connector(ae.a.ChromiumPageSettings);if(i&&s){const e=i.getCurrentState(),n=s.getCurrentState(),a="always"===n.selectedFeedDisplaySetting;if(t.scrollDownTopSiteInf&&a&&n.quickLinksEnabled&&e.isTopSitesCollapsed)return!0}return!1}(i,a),Object(ve.j)().then(()=>{this.nativeAdService.loadCmsBackFillList()}),this.updateNativeAdsFromCmsCallback=(e=>{this.updateNativeAdsMap(e.callbackFnPlacementList),this.updateNativeAdsInRiverSections()}).bind(this)}mapStateToProps(e){var t;const i=We.inspect({config:this.config,children:this.childComponentInstanceList,state:e,connectorArgs:{addToWatchlist:this.addToWatchlist,goToAddSymbolCallback:this.goToAddSymbolCallback,handleQuoteSearch:this.handleQuoteSearch,onUserPaginate:this.onUserPaginate,setMoneyCardData:this.setMoneyCardData,closeSDCardActionsMenu:this.closeSDCardActionsMenu,onMount:this.onMount,onUnmount:this.onUnmount,hasRightRail:this.hasRightRail,isVerticalTabEnabled:null===(t=this.pageSettingsDataConnector)||void 0===t?void 0:t.getCurrentState().verticalTabsOpened}});return Object.assign(Object.assign({enableScrollDownTopSiteInf:this.enableScrollDownTopSiteInf},i.props),{riverSectionTelemetryObject:this.riverSectionTelemetryObject,closeColdStartExperience:this.closeColdStartExperience})}onComponentConnect(e){var t,i,s,n,a;return Object(V.b)(this,void 0,void 0,(function*(){yield Ue.a.prototype.onComponentConnect.call(this,e);let r=this.config.riverSectionCardProviderConfig;const o=this.config.riverSectionSDCardProviderConfig;let c;this.feedId=null===(t=null==e?void 0:e.context)||void 0===t?void 0:t.feedId,this.feedName=null===(i=null==e?void 0:e.context)||void 0===i?void 0:i.query,this.feedSource=null===(s=null==e?void 0:e.context)||void 0===s?void 0:s.feedSource,this.hasRightRail=null===(n=null==e?void 0:e.context)||void 0===n?void 0:n.hasRightRail;let d=!1;if((this.feedId||this.feedName)&&(this.feedId!==r.initialRequest.feedId&&(d=!0),c=this.feedId||this.feedName,r=this.updateInitialRequest()),r&&r.initialRequest&&this.pageSettingsDataConnector){const e=this.pageSettingsDataConnector.getCurrentState();let t=!1;"function"==typeof this.pageSettingsDataConnector.getPrimaryAccountInfoAsync&&this.pageSettingsDataConnector.getPrimaryAccountInfoAsync().then(e=>{t=e.accountType===ne.d.MSA});const i=Ve.a.getPageConfiguration(e,t);i&&!isNaN(i)&&(r.initialRequest.pageConfiguration=i)}this.riverCardProvider=(null===(a=null==e?void 0:e.context)||void 0===a?void 0:a.riverCardProvider)||new Re.a(r,d),this.SDCardProvider=new Te.a(o),ue.a.refreshRiver.registerObserver(()=>Object(V.b)(this,void 0,void 0,(function*(){yield Object(Ne.d)(),this.refreshFeed()}))),He.a.updateLayout.registerObserver(()=>Object(V.b)(this,void 0,void 0,(function*(){U.setRiverSectionFeedLayoutData.getActionSender(this).send(this.getCurrentState().riverSectionFeedLayoutData)}))),this.initFeed(),this.riverSectionTelemetryObject=this.telemetryObject.addOrUpdateChild({name:"River",content:{headline:c||"RiverSection"}}),Xe[h.a.desktopFeedStart]=window.performance.now(),this.config.childExperienceReferences&&(yield this.loadChildrenExperiences(Object.keys(this.config.childExperienceReferences).filter(e=>this.filterEmptyChildExperience(e)).map(e=>this.config.childExperienceReferences[e]))),Object(Ie.a)().addSwitchListener(()=>{window.removeEventListener("scroll",this.onScroll)},we.a.Monetization),Promise.all([Object(Qe.a)(),this.requestPageVisibleAsync()]).then(()=>{this.isDocumentVisible="visible"===document.visibilityState})}))}filterEmptyChildExperience(e){const t=this.config.childExperienceReferences[e];return Object(te.h)(t)}initFeed(){this.resetParameters(),this.renderNextFeed(Re.b.init)}refreshFeed(){this.resetParameters(),this.resetRowCount(),this.renderNextFeed(Re.b.refresh)}resetParameters(){this.setCmsConfig(),this.waitingAdsMap.clear(),this.riverCardProvider.clearCache(),this.previousRiverSectionContentResponse=null,this.unRenderedLayoutTemplate=[],this.unRenderedRiverContent=[],this.infoPaneAdRegionIndexList=[],this.riverAdRegionIndexList=[],this.tabInfoPaneAdRegionIndexList=[],this.infoPaneCmsAdRegionIndexList=[],this.riverCmsAdRegionIndexList=[],this.isFirstFeedCall=!0,this.unServedSamAdSet.clear(),this.infoPaneNativeAdsMap=[],this.riverNativeAdsMap=[],this.tabInfoPaneNativeAdsMap=[],this.cmsInfopaneNativeAdsMap=[],this.cmsRiverNativeAdsMap=[],this.samAdsInitialUpperBound=this.config.samAdsInitialUpperBound,this.leadgenAdsInitialUpperBound=this.config.leadgenAdsInitialUpperBound,this.nativeAdService.resetNativeAdService()}renderNextFeed(e){var t;return Object(V.b)(this,void 0,void 0,(function*(){if(this.config.isNewPrefetchlogic)return this.renderNextFeedWithPrefetch(e);let i=Ze.RenderContent;if(0===this.unRenderedLayoutTemplate.length){if(!(yield this.getContentForNextFeed(e)))return;this.isFirstFeedCall?(i=Ze.FirstFetchAndRenderContent,this.isFirstFeedCall=!1):i=Ze.SubFetchAndRenderContent}const s=(null===(t=this.config)||void 0===t?void 0:t.perfEarlyFetchAuction)&&i===Ze.FirstFetchAndRenderContent,n=s?this.fetchSamNativeAdsContent():void 0,a=s?this.fetchCmsAdsContent():void 0;this.addRiverSections(e);const r=this.getCurrentState().riverSectionFeedLayoutData.length-1,o=this.waitingAdsMap;o.has(r)||o.set(r,!0),i===Ze.FirstFetchAndRenderContent?yield this.initAtFirst(n,a):i===Ze.SubFetchAndRenderContent?(this.fetchAndHandleSamAds(),this.fetchAndHandleCmsAds()):i===Ze.RenderContent&&this.updateNativeAdsInRiverSections()}))}renderNextFeedWithPrefetch(e){return Object(V.b)(this,void 0,void 0,(function*(){let t=Ze.RenderContent;if(0===this.unRenderedLayoutTemplate.length){if(!(this.prefetchHandler?yield this.prefetchHandler:yield this.getContentForNextFeed(e)))return;this.isFirstFeedCall&&(t=Ze.FirstFetchAndRenderContent,this.isFirstFeedCall=!1)}this.addRiverSections(e);const i=this.getCurrentState().riverSectionFeedLayoutData.length-1,s=this.waitingAdsMap;if(s.has(i)||s.set(i,!0),t===Ze.FirstFetchAndRenderContent)yield this.initAtFirst();else if(t===Ze.RenderContent){this.updateNativeAdsInRiverSections();const e=this.config.numOfSectionsToPrefetch||2;this.unRenderedLayoutTemplate.length<=e&&!this.prefetchHandler&&this.initFirstDone&&(this.prefetchHandler=this.getContentForNextFeed(Re.b.subsequent).then(e=>(e&&(this.fetchAndHandleSamAds(),this.fetchAndHandleCmsAds()),this.prefetchHandler=void 0,e)).catch(()=>(this.prefetchHandler=void 0,!1)))}}))}initAtFirst(e,t){return Object(V.b)(this,void 0,void 0,(function*(){if(yield Object(Ke.a)(),!this.previousRiverSectionContentResponse)return;this.fetchAndHandleSamAds(!1,e),this.fetchAndHandleCmsAds(t);const{selectedFeedDisplaySetting:i}=this.pageSettingsDataConnector.getCurrentState();("peek"===i||this.config.legacyPrefetchBehavior===H.Disabled)&&(this.disablePrefetchHack=!0),this.config.legacyPrefetchBehavior===H.OnScroll?window.addEventListener("scroll",this.onScroll):this.prefetchOnlyFirstTime()}))}prefetchOnlyFirstTime(){return Object(V.b)(this,void 0,void 0,(function*(){if(this.riverAdRegionIndexList)try{yield this.fetchAndHandleSamAds(!0)}catch(e){}if(this.disablePrefetchHack)return void(this.initFirstDone=!0);(yield this.getContentForNextFeed(Re.b.subsequent))&&(yield this.fetchAndHandleSamAds(!0),yield this.fetchAndHandleCmsAds()),this.initFirstDone=!0}))}getContentForNextFeed(e){return Object(V.b)(this,void 0,void 0,(function*(){if(this.isFetchingContent)return!1;this.isFetchingContent=!0;const t=this.previousRiverSectionContentResponse;if(t&&t.status===je.a.NoContent)return this.isFetchingContent=!1,!1;const i=t&&t.nextPageRequest,s=yield this.fetchFeedContent(i,e);if(this.isFetchingContent=!1,!s)return!1;if(this.previousRiverSectionContentResponse=s,s.status!==je.a.Success)return!1;const{sections:n}=s;for(const e of n){const{cards:t,layoutTemplate:i}=e;this.unRenderedRiverContent=this.unRenderedRiverContent.concat(t),this.unRenderedLayoutTemplate.push(i)}return this.updateAdRegionIndexList(),this.switchRedundantCmsAdsToNativeAds(),!0}))}generateSamAdRequest(){var e,t,i,s;const{infoPaneAdRegionIndexList:n,riverAdRegionIndexList:a,tabInfoPaneAdRegionIndexList:r,infoPaneCmsAdRegionIndexList:o,riverCmsAdRegionIndexList:c,samAdsInitialUpperBound:d,leadgenAdsInitialUpperBound:l}=this,h={placements:[]};return(n.length||a.length)&&(h.placements.push({region:"infopane",indices:n.splice(0),img:null===(t=null===(e=this.config.adTemplateConfig)||void 0===e?void 0:e.imageSizeConfig)||void 0===t?void 0:t.infopane},{region:"river",indices:d>0?a.splice(0,d):a.splice(0),img:null===(s=null===(i=this.config.adTemplateConfig)||void 0===i?void 0:i.imageSizeConfig)||void 0===s?void 0:s.river}),this.samAdsInitialUpperBound=-1),this.config.enableInfopaneLeadgenNative&&o.length&&h.placements.push({region:"resinfopane",indices:o.splice(0)}),this.config.enableRiverLeadgenNative&&c.length&&(h.placements.push({region:"resriver",indices:l>0?c.splice(0,l):c.splice(0)}),this.leadgenAdsInitialUpperBound=-1),this.config.enableDenseSlide&&r.length&&h.placements.push({region:"infopane-tab",indices:r.splice(0)}),h}generateCmsAdRequest(){var e,t,i,s;const{infoPaneCmsAdRegionIndexList:n,riverCmsAdRegionIndexList:a}=this;let r;return this.config.enableInfopaneLeadgenNative&&this.config.enableRiverLeadgenNative||!n.length&&!a.length||(r={placements:[{region:"infopane_cms",indices:this.config.enableInfopaneLeadgenNative?[]:n.splice(0),img:null===(t=null===(e=this.config.adTemplateConfig)||void 0===e?void 0:e.imageSizeConfig)||void 0===t?void 0:t.infopane},{region:"river_cms",indices:this.config.enableRiverLeadgenNative?[]:a.splice(0),img:null===(s=null===(i=this.config.adTemplateConfig)||void 0===i?void 0:i.imageSizeConfig)||void 0===s?void 0:s.river}]}),r}filterInfoPaneAds(e,t){return e?e.filter(e=>e.region===t).map(e=>(e.adLabelText=this.adLabelText,e.isGreyAdsLabelEnabled=this.isGreyAdsLabelEnabled,e.isWhiteSlug=this.config.isWhiteSlug,e.isTransparentSlug=this.config.isTransparentSlug,e.isNarrowTitleFooterGap=this.config.isNarrowTitleFooterGap,e)):[]}filterRiverAds(e,t){return e?e.filter(e=>{var i,s,n,a;if(e.region===t){if(e.items.length)if(this.config.useArticleCardTemplate){const t=Number(e.items[0].imageWidth)||(null===(s=null===(i=this.config.adTemplateConfig)||void 0===i?void 0:i.imageSizeConfig)||void 0===s?void 0:s.river.w),r=Number(e.items[0].imageHeight)||(null===(a=null===(n=this.config.adTemplateConfig)||void 0===n?void 0:n.imageSizeConfig)||void 0===a?void 0:a.river.h);e.items[0].imageWidth=(225*t/r).toFixed().toString(),e.items[0].imageHeight="225",e.imageWidth=e.items[0].imageWidth,e.imageHeight=e.items[0].imageHeight}else e.items[0].imageWidth="300",e.items[0].imageHeight="156";return!0}return!1}).map(e=>(e.adLabelText=this.adLabelText,e.isGreyAdsLabelEnabled=this.isGreyAdsLabelEnabled,e.isProviderInHeader=this.config.isProviderInHeader,e.isProviderInFooter=this.config.isProviderInFooter,e.isWhiteSlug=this.config.isWhiteSlug,e.isTransparentSlug=this.config.isTransparentSlug,e)):[]}filterTabInfoPaneAds(e,t){return e?e.filter(e=>e.region===t).map(e=>(e.adLabelText=this.adLabelText,e.isGreyAdsLabelEnabled=this.isGreyAdsLabelEnabled,e)):[]}updateNativeAdsMap(e){this.infoPaneNativeAdsMap=this.infoPaneNativeAdsMap.concat(this.filterInfoPaneAds(e,"infopane")),this.infoPaneNativeAdsMap=this.infoPaneNativeAdsMap.concat(this.filterInfoPaneAds(e,"resinfopane")),this.riverNativeAdsMap=this.riverNativeAdsMap.concat(this.filterRiverAds(e,"river")),this.riverNativeAdsMap=this.riverNativeAdsMap.concat(this.filterRiverAds(e,"resriver")),this.tabInfoPaneNativeAdsMap=this.tabInfoPaneNativeAdsMap.concat(this.filterTabInfoPaneAds(e,"infopane-tab"))}updateCmsNativeAdsMap(e){this.cmsInfopaneNativeAdsMap=this.cmsInfopaneNativeAdsMap.concat(this.filterInfoPaneAds(e,"infopane_cms")),this.cmsRiverNativeAdsMap=this.cmsRiverNativeAdsMap.concat(this.filterRiverAds(e,"river_cms"))}updateNativeAdsInRiverSections(){if(!(this.infoPaneNativeAdsMap.length>0||this.riverNativeAdsMap.length>0||this.cmsInfopaneNativeAdsMap.length>0||this.cmsRiverNativeAdsMap.length>0||this.tabInfoPaneNativeAdsMap.length>0))return;const{riverSectionFeedLayoutData:e}=this.getCurrentState();if(e&&e.length){this.rowCount=this.prevRowCount;for(const[t]of e.entries()){if(!this.waitingAdsMap.get(t))continue;const i=e[t],s=[];let n=!1;i.cardMetadataList.forEach(e=>{if(e.type===v.a.Infopane){const t=e;t.subItems.map((e,i)=>{if(e.type===v.a.NativeAd&&this.isInvalidAdItem(e))t.subItems[i]=this.createNativeAdCardMetadata("infopane",e.regionIndex),this.isInvalidAdItem(t.subItems[i])&&(n=!0);else if(e.type===v.a.CmsAd&&this.isInvalidAdItem(e))t.subItems[i]=this.createNativeAdCardMetadata("infopane_cms",e.regionIndex),this.isInvalidAdItem(t.subItems[i])&&(n=!0);else if(e.type===v.a.Dense){const t=e;t.subItems.map((e,i)=>{e.type===v.a.NativeAd&&this.isInvalidAdItem(e)&&(t.subItems[i]=this.createNativeAdCardMetadata("infopane-tab",e.regionIndex),this.isInvalidAdItem(t.subItems[i])&&(n=!0))})}}),s.push(t)}else if(e.type===v.a.NativeAd&&this.isInvalidAdItem(e)){const t=this.createNativeAdCardMetadata("river",e.regionIndex);s.push(t),this.isInvalidAdItem(t)&&(n=!0)}else if(e.type===v.a.CmsAd&&this.isInvalidAdItem(e)){const t=this.createNativeAdCardMetadata("river_cms",e.regionIndex);s.push(t),this.isInvalidAdItem(t)&&(n=!0)}else s.push(e)}),n||this.waitingAdsMap.set(t,!1),e.splice(t,1,{feedData:this.mapFeedData(s,i.templateId,!0,this.riverSectionTelemetryObject),templateId:i.templateId,cardMetadataList:s})}window.requestAnimationFrame(()=>{setTimeout(()=>{const e=!0===ie.b.IsPrerender?performance.now()-Object(E.g)(le.d):performance.now();Object(E.o)(re.a.TimeToRenderAd,e)},0)}),U.setRiverSectionFeedLayoutData.getActionSender(this).send(e)}}isInvalidAdItem(e){return 0===e.placement.items.length}addRiverSections(e){return Object(V.b)(this,void 0,void 0,(function*(){if(!this.unRenderedLayoutTemplate.length)return[];let t=[];const i=this.unRenderedLayoutTemplate.shift(),s=o.a[i],n=this.getCardMetaDataForRiverSection(s);if(this.prevRowCount=this.rowCount,e===Re.b.init||e===Re.b.refresh){const e=n.findIndex(e=>e.type===v.a.Infopane),s=n[e],a=n.findIndex(e=>e.type===v.a.WeatherSummary),r=n[a],o=n.findIndex(e=>e.type===v.a.StockQuote||e.type===v.a.MoneyInfo),c=n[o],d=n.findIndex(e=>e.type===v.a.SportsMatch),l=n[d],u=n.findIndex(e=>e.type===v.a.Trending),g=(n[u],n.findIndex(e=>e.type===v.a.Upsell)),p=(n[g],[...n]);s&&p.splice(e,1,Object.assign(Object.assign({},s),{subItems:[s.subItems[0]]})),r&&p.splice(a,1,Object.assign(Object.assign({},r),{data:null})),c&&p.splice(o,1,Object.assign(Object.assign({},c),{data:null})),l&&p.splice(d,1,Object.assign(Object.assign({},l),{data:null}));const m=p.slice(13).map(e=>{const t=Object(Ee.a)(e);return t.type!==v.a.NativeAd&&Object.keys(t).forEach(e=>{"type"!==e&&"id"!==e&&(t[e]=null)}),t});p.splice(13,p.length-13+1,...m),t.push({feedData:this.mapFeedData(p,i,!0,this.riverSectionTelemetryObject),templateId:i,cardMetadataList:p}),U.setRiverSectionFeedLayoutData.getActionSender(this).send(t),Xe[h.a.firstSectionRenderStart]=window.performance.now(),Object(ve.j)().then(()=>Object(V.b)(this,void 0,void 0,(function*(){t=[],this.rowCount=this.prevRowCount,t.push({feedData:this.mapFeedData(n,i,!0,this.riverSectionTelemetryObject),templateId:i,cardMetadataList:n}),U.setRiverSectionFeedLayoutData.getActionSender(this).send(t),r&&(this.weatherDataConnector||(this.weatherDataConnector=yield this.rootReducer.getDataConnector(ae.a.WeatherData),this.setupWeatherDataObservers(),this.weatherDataConnector&&this.weatherDataConnector.getCurrentState()&&this.weatherDataConnector.getCurrentState().settingUpdateStatus&&this.updateSDCardData(v.a.WeatherSummary)))})))}else{t.push({feedData:this.mapFeedData(n,i,!0,this.riverSectionTelemetryObject),templateId:i,cardMetadataList:n});const e=this.getCurrentState().riverSectionFeedLayoutData;U.setRiverSectionFeedLayoutData.getActionSender(this).send(e.concat(t)),Xe[h.a.secondSectionRenderStart]=window.performance.now()}return n}))}mapFeedData(e,t,i,s){if(!e.length)return null;const n={cards:[],C5:[],C4:[],C3:[],C2:[],C1:[]},a=t&&o.a[t],{cardSlots:r,rowHeightPx:c,colWidthPx:d,gutterPx:l}=a||{cardSlots:[null]},h=this.config.showToastAfterSDCardHide;return e.forEach((e,a)=>{var o,u,p,m,f,b,y,C,S,O,A,I,w;let R=X.a[e.type];if(!R)return;let T=null;if(R===Q.b.infopaneCard&&(T=this.setVisuallyReadyMarkers,this.visualReadinessCallbackSet=!0),!this.visualReadinessCallbackSet&&R===Q.b.contentCard){Object(z.b)(e)&&(T=this.setVisuallyReadyMarkers,this.visualReadinessCallbackSet=!0)}const j=!this.config.reverseLayoutGap&&(!this.config.consumeVerticalTab||this.config.consumeVerticalTab&&this.pageSettingsDataConnector.getCurrentState().verticalTabsOpened),x={hasRightRail:this.hasRightRail,cardMetadata:e,parentTelemetryObject:s,cardSlot:r[a],openLinksInNewTab:i,cardActionBitMask:this.config.cardActionBitMask||7,isAnaheimDesign:!0,cardActionClickHandler:this.cardActionClickHandler,goToPersonalizeCallback:this.goToPersonalizeCallback,initCardAction:this.initCardAction,visualReadinessCallback:T,localizedStrings:this.config.localizedStrings,configOptions:this.config,layoutGap:j?this.config.layoutGap:void 0,stockImageData:this.config.stockImageData,sdCardActionClickHandler:(e,t,i)=>{this.clickSDCardActionButton(e,t,i,h)},refreshSDCardSection:this.refreshFeedWhenDisableSDCard,goToPersonalizeSettingsCallback:this.goToPersonalizeSettingsCallback,enableRichSocialReaction:this.config.enableRichSocialReactions,isAdFeedbackV1Enabled:!!this.config.adFeedbackV1Enabled,handleAdFeedbackSubmit:this.cardActionServiceClient.ReportAd.bind(this.cardActionServiceClient),activeItemChangedHandler:this.activeItemChangedHandler,isNarrowTitleFooterGap:this.config.isNarrowTitleFooterGap,refreshFeedCallback:()=>this.refreshFeed(),layoutTemplateName:t,rowCount:this.rowCount,rowHeightPx:c,colWidthPx:d,gutterPx:l,isClarityEnabled:this.config.isClarityEnabled};let P;R===Q.b.contentCard&&(this.config.childExperienceReferencesWC&&this.config.childExperienceReferencesWC.socialBarWC&&Object(ze.a)(this.config.childExperienceReferencesWC.socialBarWC),x.isProviderInFooter=this.config.isProviderInFooter),R===Q.b.nativeAdCard&&(x.isAdProviderInHeader=this.config.isAdProviderInHeader),R===Q.b.infopaneCard&&(this.config.childExperienceReferencesWC&&this.config.childExperienceReferencesWC.socialBarWC&&Object(ze.a)(this.config.childExperienceReferencesWC.socialBarWC),x.activeIndicator=!1,x.autoRotateIntervalMs=this.config.autoRotateIntervalMs||5e3,x.firstAutoRotateIntervalMs=this.config.firstAutoRotateIntervalMs,this.config.useColorfulInfopane||(x.configOptions=Object(ke.a)(this.config,["useArticleCardTemplate"])),x.disableAutoRotate=this.config.disableAutoRotate,Object(_e.a)().get("vpFreeze")&&(x.disableAutoRotate=!0)),R===Q.b.moneyCard&&(x.cardStateData=this.getCurrentState()&&this.getCurrentState().moneyCardData,x.handleNavClick=this.handleNavClick,x.handleAddToWatchlist=this.handleAddToWatchlist,x.refreshMoneyCardData=this.refreshMoneyCardData,x.cardLayout=g.a.full),R===Q.b.moneyInfoCardWC&&(null===(o=this.config.childExperienceReferencesWC)||void 0===o?void 0:o.moneyInfoCardWC)&&(Object(ze.a)(this.config.childExperienceReferencesWC.moneyInfoCardWC),x.configOptions=this.config.childExperienceReferencesWC.moneyInfoCardWC),R===Q.b.sportsCard&&(null===(u=this.config.childExperienceReferencesWC)||void 0===u?void 0:u.sportsCardWC)&&(Object(ze.a)(this.config.childExperienceReferencesWC.sportsCardWC),x.configOptions=this.config.childExperienceReferencesWC.sportsCardWC),R===Q.b.shoppingCarouselCard&&(e.type===v.a.ShoppingCard&&(null===(p=this.config.childExperienceReferencesWC)||void 0===p?void 0:p.shoppingCard)&&(x.configOptions=this.config.childExperienceReferencesWC.shoppingCard),e.type===v.a.ShoppingCarousel&&(null===(m=this.config.childExperienceReferencesWC)||void 0===m?void 0:m.shoppingCarousel)&&(x.configOptions=this.config.childExperienceReferencesWC.shoppingCarousel)),R===Q.b.comicsCarouselCard&&((null===(f=this.config.childExperienceReferencesWC)||void 0===f?void 0:f.selectCarousel)&&(Object(ze.a)(this.config.childExperienceReferencesWC.selectCarousel),x.cardMetadata.selectCarouselConfigInstance=this.config.childExperienceReferencesWC.selectCarousel),x.configOptions=this.config.comicsCarouselConfig,x.cardMetadata.data=JSON.stringify(this.selectCarouselData.comics)),R===Q.b.selectCarouselCard&&((null===(b=this.config.childExperienceReferencesWC)||void 0===b?void 0:b.selectCarousel)&&(Object(ze.a)(this.config.childExperienceReferencesWC.selectCarousel),x.cardMetadata.selectCarouselConfigInstance=this.config.childExperienceReferencesWC.selectCarousel),x.configOptions=this.config.selectCarouselConfig,x.cardMetadata.data=JSON.stringify(this.selectCarouselData.select)),R===Q.b.editorsPickCarouselCard&&((null===(y=this.config.childExperienceReferencesWC)||void 0===y?void 0:y.selectCarousel)&&(Object(ze.a)(this.config.childExperienceReferencesWC.selectCarousel),x.cardMetadata.selectCarouselConfigInstance=this.config.childExperienceReferencesWC.selectCarousel),x.configOptions=this.config.editorsPickCarouselConfig,x.cardMetadata.data=JSON.stringify(this.selectCarouselData.editorsPick)),R===Q.b.publisherCarouselCard&&this.config.childExperienceReferencesWC&&this.config.childExperienceReferencesWC.publisherCarousel&&Object(ze.a)(this.config.childExperienceReferencesWC.publisherCarousel),R===Q.b.dailyFixGamesCarouselCard&&((null===(C=this.config.childExperienceReferencesWC)||void 0===C?void 0:C.selectCarousel)&&(Object(ze.a)(this.config.childExperienceReferencesWC.selectCarousel),x.cardMetadata.selectCarouselConfigInstance=this.config.childExperienceReferencesWC.selectCarousel),x.configOptions=this.config.dailyFixGamesCarouselConfig,x.cardMetadata.data=JSON.stringify(this.selectCarouselData.dailyFixGames)),R===Q.b.weatherCard&&(x.cardStateData=this.getCurrentState()&&this.getCurrentState().weatherCardData,x.saveSettingsAndRefresh=this.saveWeaSettingAndRefresh,x.triggerAutoSuggest=this.triggerWeatherLocAutoSuggest,x.cancelSettings=this.switchToWeatherForecast,x.selectLocationMode=this.selectWeatherLocationMode,x.selectWeatherUnit=this.selectWeatherUnit,x.selectValueFromSuggest=this.selectWeatherLocation,x.selectDetectedLocation=this.selectDetectedLocation,x.switchToWeatherSettings=this.switchToWeatherSetting,x.cardLayout="full",e&&e.data&&this.weatherDataConnector&&this.weatherDataConnector.updateWeatherDataState(e.data)),R===Q.b.serendipityCard?(null===(O=null===(S=this.config)||void 0===S?void 0:S.childExperienceReferencesWC)||void 0===O?void 0:O.trendingNowWC)?(Object(ze.a)(this.config.childExperienceReferencesWC.trendingNowWC),x.configOptions=this.config.childExperienceReferencesWC.trendingNowWC,R=Q.b.trendingNowCard):x.configOptions=null:R===Q.b.trendingNowCard&&((null===(I=null===(A=this.config)||void 0===A?void 0:A.childExperienceReferencesWC)||void 0===I?void 0:I.trendingNowWC)?(Object(ze.a)(this.config.childExperienceReferencesWC.trendingNowWC),x.configOptions=this.config.childExperienceReferencesWC.trendingNowWC):x.configOptions=null),R===Q.b.travelDestinationCard&&(this.config.childExperienceReferencesWC&&this.config.childExperienceReferencesWC.travelDestination?(Object(ze.a)(this.config.childExperienceReferencesWC.travelDestination),x.configOptions=this.config.childExperienceReferencesWC.travelDestination):x.configOptions=null),R===Q.b.healthCard&&(this.config.childExperienceReferencesWC&&this.config.childExperienceReferencesWC.bingHealthCard?(Object(ze.a)(this.config.childExperienceReferencesWC.bingHealthCard),x.configOptions=this.config.childExperienceReferencesWC.bingHealthCard):x.configOptions=null),R===Q.b.horoscopeAnswerCard&&(this.config.childExperienceReferencesWC&&this.config.childExperienceReferencesWC.horoscopeCard?(Object(ze.a)(this.config.childExperienceReferencesWC.horoscopeCard),x.configOptions=this.config.childExperienceReferencesWC.horoscopeCard):x.configOptions=null),R===Q.b.onThisDayCard&&(this.config.childExperienceReferencesWC&&this.config.childExperienceReferencesWC.onThisDayCard?(Object(ze.a)(this.config.childExperienceReferencesWC.onThisDayCard),x.configOptions=this.config.childExperienceReferencesWC.onThisDayCard):x.configOptions=null),R===Q.b.electionsCard&&this.config.childExperienceReferencesWC&&this.config.childExperienceReferencesWC.electionsCard&&(Object(ze.a)(this.config.childExperienceReferencesWC.electionsCard),x.configOptions=this.config.childExperienceReferencesWC.electionsCard),R===Q.b.lotteryCard&&(this.config.childExperienceReferencesWC&&this.config.childExperienceReferencesWC.lotteryCard?(Object(ze.a)(this.config.childExperienceReferencesWC.lotteryCard),x.configOptions=this.config.childExperienceReferencesWC.lotteryCard):x.configOptions=null),R===Q.b.qnaCard&&(this.config.childExperienceReferencesWC&&this.config.childExperienceReferencesWC.qnaCard?(Object(ze.a)(this.config.childExperienceReferencesWC.qnaCard),x.configOptions=this.config.childExperienceReferencesWC.qnaCard):x.configOptions=null),R===Q.b.recipesCard&&(this.config.childExperienceReferencesWC&&this.config.childExperienceReferencesWC.recipesCard?(Object(ze.a)(this.config.childExperienceReferencesWC.recipesCard),x.configOptions=this.config.childExperienceReferencesWC.recipesCard):x.configOptions=null),R===Q.b.esportsCard&&this.config.childExperienceReferencesWC&&this.config.childExperienceReferencesWC.esportsCard&&(Object(ze.a)(this.config.childExperienceReferencesWC.esportsCard),x.configOptions=this.config.childExperienceReferencesWC.esportsCard),R===Q.b.recommendedSearchCarousel&&(this.config.childExperienceReferencesWC&&this.config.childExperienceReferencesWC.recommendedSearchCarousel&&Object(ze.a)(this.config.childExperienceReferencesWC.recommendedSearchCarousel),x.configOptions=this.config.childExperienceReferencesWC.recommendedSearchCarousel),R===Q.b.trafficCard&&(this.config.childExperienceReferencesWC&&this.config.childExperienceReferencesWC.trafficCard?(Object(ze.a)(this.config.childExperienceReferencesWC.trafficCard),x.configOptions=this.config.childExperienceReferencesWC.trafficCard):x.configOptions=null),R===Q.b.bingVideoCarousel&&(this.config.childExperienceReferencesWC&&this.config.childExperienceReferencesWC.bingVideoCarousel?(Object(ze.a)(this.config.childExperienceReferencesWC.bingVideoCarousel),x.configOptions=this.config.childExperienceReferencesWC.bingVideoCarousel):x.configOptions=null),R===Q.b.coldStartCard&&(this.config.expectingUpsellCard||k.a.sendAppErrorEvent(de.ac),this.config.expectedColdStartPosition>=0&&a+1!==this.config.expectedColdStartPosition&&k.a.sendAppErrorEvent(de.Wb),Object(ze.a)(null===(w=this.config.childExperienceReferencesWC)||void 0===w?void 0:w.coldStartRiverCard),x.upsellGetStartedClickHandler=this.config.upsellLaunchesInline?void 0:this.initializeColdStartExperience),R===Q.b.denseCard&&(this.config.childExperienceReferencesWC&&this.config.childExperienceReferencesWC.denseCard?(Object(ze.a)(this.config.childExperienceReferencesWC.denseCard),x.configOptions=this.config.childExperienceReferencesWC.denseCard):x.configOptions=null);try{P=Q.a[R].getFeedDataForCard(x)}catch(t){let i=Ae[R];i||(i=R===Q.b.shoppingCarouselCard?e.type===v.a.ShoppingCard?de.Th:de.hi:de.qk),Object(ce.c)(t,i,`${R} getFeedDataForCard error, ${t.toString()}`)}P&&Object.keys(P).forEach(e=>{n[e]=n[e].concat(P[e])})}),this.rowCount={C5:this.rowCount.C5+(c&&c.C5&&c.C5.length?c.C5.length/2:0),C4:this.rowCount.C4+(c&&c.C4&&c.C4.length?c.C4.length/2:0),C3:this.rowCount.C3+(c&&c.C3&&c.C3.length?c.C3.length/2:0),C2:this.rowCount.C2+(c&&c.C2&&c.C2.length?c.C2.length/2:0),C1:this.rowCount.C1+(c&&c.C1&&c.C1.length?c.C1.length/2:0)},n}getCardMetaDataForRiverSection(e){const t=[];if(!e)return t;for(let i=0;i<e.cardCount;i++)t.push(this.unRenderedRiverContent.shift());return t}fetchFeedContent(e,t){var i;return Object(V.b)(this,void 0,void 0,(function*(){let s;try{s=yield this.riverCardProvider.fetch(e,t),(null===(i=this.config.childExperienceReferencesWC)||void 0===i?void 0:i.selectCarousel)&&(yield this.populateCarouselData(s))}catch(e){k.a.sendAppErrorEvent(Object.assign(Object.assign({},de.Zb),{message:"Content fetch failed for Desktop Feed EdgeNext river section.",pb:Object.assign(Object.assign({},de.Zb.pb),{customMessage:"Failed with exception : "+e})}))}return s}))}populateCarouselData(e){return Object(V.b)(this,void 0,void 0,(function*(){const t=[[this.config.comicsCarouselConfig,"comics","ComicsCarousel"],[this.config.dailyFixGamesCarouselConfig,"dailyFixGames","DailyFixGamesCarousel"],[this.config.editorsPickCarouselConfig,"editorsPick","EditorsPickCarousel"],[this.config.selectCarouselConfig,"select","SelectCarousel"]];for(const[i,s,n]of t){if(!i||this.selectCarouselData[s]||!e.sections.some(e=>e.cards.some(e=>e.type===n)))continue;const t=new Se.a({initialRequest:{start:0,count:30,feedId:i.feedId,timeoutMs:3e3}}),a=yield t.fetch(),r=[];for(const e of a.cardMetadata){const t="https://assets.msn.com/content/view/v1/Preview/"+e.id,i=Object(Je.a)(()=>fetch(t),"GetContentData").then(e=>e.json());r.push(i)}this.selectCarouselData[s]=[];for(const e of r)this.selectCarouselData[s].push(yield e)}}))}generateNativeAdsResponse(e,t){const i=this.config.useArticleCardTemplate?{}:this.config.adTemplateConfig,s=this.nativeAdService.updateSamAdResponse(e,t,i),{placements:n,adLabelText:a,isGreyAdsLabelEnabled:r}=s;return this.adLabelText||(this.adLabelText="Ad"===e.adLabelText?a:e.adLabelText,this.isGreyAdsLabelEnabled=r),n.filter(e=>e.items.length)}updateAdRegionIndexList(){const{infoPaneAdRegionIndexList:e,riverAdRegionIndexList:t,tabInfoPaneAdRegionIndexList:i,infoPaneCmsAdRegionIndexList:s,riverCmsAdRegionIndexList:n}=this.previousRiverSectionContentResponse;this.infoPaneAdRegionIndexList.push(...e),this.riverAdRegionIndexList.push(...t),this.tabInfoPaneAdRegionIndexList.push(...i),this.infoPaneCmsAdRegionIndexList.push(...s),this.riverCmsAdRegionIndexList.push(...n)}switchRedundantCmsAdsToNativeAds(){const{infoPaneAdRegionIndexList:e,riverAdRegionIndexList:t,infoPaneCmsAdRegionIndexList:i,riverCmsAdRegionIndexList:s}=this,{sections:n}=this.previousRiverSectionContentResponse,a=i.length-this.cmsAdsConfig.infoPaneIndices.length,r=s.length-this.cmsAdsConfig.riverIndices.length;if(a>0||r>0){const o=[],c=[];n.forEach(e=>{e.cards&&e.cards.forEach(e=>{e.type===v.a.Infopane?e.subItems.forEach(e=>{e.type===v.a.CmsAd&&o.push(e)}):e.type===v.a.CmsAd&&c.push(e)})});for(let t=0;t<a;t++)o[o.length-1-t].type=v.a.NativeAd,e.push(i.pop());for(let e=0;e<r;e++)c[c.length-1-e].type=v.a.NativeAd,t.push(s.pop());e.sort((e,t)=>e-t),t.sort((e,t)=>e-t)}}fetchAndHandleCmsAds(e=this.fetchCmsAdsContent()){return Object(V.b)(this,void 0,void 0,(function*(){const t=yield e;t&&(this.updateCmsNativeAdsMap(t.placements),this.updateNativeAdsInRiverSections())}))}fireServedTrackingCallForPlacements(e,t,i){e.forEach(({beaconsJson:e,bingTrackerUrls:s,videoViewabilityData:n})=>{!e||s&&s.length>0&&n||(t&&void 0!==this.config.samAdNextPageUpperBound?i<this.config.samAdNextPageUpperBound?(this.beaconService.fireAdServedTrackingCall(e),i++):this.unServedSamAdSet.add(e):this.beaconService.fireAdServedTrackingCall(e))})}fetchAndHandleSamAds(e,t=this.fetchSamNativeAdsContent()){return Object(V.b)(this,void 0,void 0,(function*(){const i=yield t;if(i&&0!==i.length){this.updateNativeAdsMap(i),this.updateNativeAdsInRiverSections();const t=0;this.fireServedTrackingCallForPlacements(i,e,t)}}))}fetchCmsAdsContent(){var e;return Object(V.b)(this,void 0,void 0,(function*(){const t=this.generateCmsAdRequest();if(t)try{const i=this.cmsAdsConfig.infoPaneIndices.splice(0,t.placements[0].indices.length),s=this.cmsAdsConfig.riverIndices.splice(0,t.placements[1].indices.length),n=i.concat(s),a=yield this.nativeAdService.fetchCmsAds(t,this.cmsAdsConfig.documentId,n);return!this.adLabelText&&a&&(this.adLabelText=a.adLabelText,this.isGreyAdsLabelEnabled=a.isGreyAdsLabelEnabled),(null===(e=this.config)||void 0===e?void 0:e.perfRemoveWait)||(yield Object(ve.j)()),a}catch(e){return void Object(ce.c)(e,de.Yb,"Call to Cms Ad Service failed")}}))}fetchSamNativeAdsContent(){var e;return Object(V.b)(this,void 0,void 0,(function*(){const t=this.generateSamAdRequest();if(t&&t.placements&&0!==t.placements.length)try{let i;he.a.startMark("AdServiceCall.DesktopFeedEdgeNext");let s=!1;this.isFirstBatchCall&&(i=[this.updateNativeAdsFromCmsCallback],s=!0,this.isFirstBatchCall=!1);const n=(yield Promise.all([this.nativeAdService.fetchSamAds(t,s,i),Object(Ge.b)(this.config)]))[0],{placeHolderResponse:a,samResponse:r}=n;return(null===(e=this.config)||void 0===e?void 0:e.perfRemoveWait)||(yield Object(ve.j)()),this.generateNativeAdsResponse(a,r)}catch(e){return void Object(ce.c)(e,de.Yb,"Call to Ad Service failed")}finally{he.a.endMark("AdServiceCall.DesktopFeedEdgeNext")}}))}createNativeAdCardMetadata(e,t){let i,s=v.a.NativeAd;switch(e){case"infopane":i=this.infoPaneNativeAdsMap.find(e=>e.regionIndex===t);break;case"river":i=this.riverNativeAdsMap.find(e=>e.regionIndex===t);break;case"infopane-tab":i=this.tabInfoPaneNativeAdsMap.find(e=>e.regionIndex===t);break;case"infopane_cms":i=this.config.enableInfopaneLeadgenNative?this.infoPaneNativeAdsMap.find(e=>e.regionIndex===t):this.cmsInfopaneNativeAdsMap.find(e=>e.regionIndex===t),s=v.a.CmsAd;break;case"river_cms":i=this.config.enableRiverLeadgenNative?this.riverNativeAdsMap.find(e=>e.regionIndex===t):this.cmsRiverNativeAdsMap.find(e=>e.regionIndex===t),s=v.a.CmsAd}if(i){const{beaconsJson:n}=i;return n&&this.unServedSamAdSet.delete(n)&&this.beaconService.fireAdServedTrackingCall(n),{type:s,regionIndex:t,id:`nativead-${e}-${i.regionIndex}`,placement:i}}return{type:s,regionIndex:t,placement:{items:[]}}}saveWeaSettings(e){return Object(V.b)(this,void 0,void 0,(function*(){const t=[];return 3&e.changeSignal&&t.push(this.weatherPdpClient.updateUserSettings(1&e.changeSignal&&e.unitSet&&e.unitSet.toString(),2&e.changeSignal&&e.locationMode&&e.locationMode.toString())),e.selectedLocation&&e.locationMode==Ce.a.SpecifyLoc&&t.push(this.weatherPdpClient.setHomeLocation(e.selectedLocation)),yield Promise.all(t)}))}setupWeatherDataObservers(){be.a.updateWeatherSettings.registerObserver(()=>Object(V.b)(this,void 0,void 0,(function*(){this.updateSDCardData(v.a.WeatherSummary)})))}updateInitialRequest(){return Object.assign(Object.assign({},this.config.riverSectionCardProviderConfig),{initialRequest:Object.assign(Object.assign({},this.config.riverSectionCardProviderConfig.initialRequest),{feedId:this.feedId,feedName:this.feedName,feedSource:this.feedSource})})}revalidateExperienceStaleState(){var e,t;let i=36e5;return(null===(t=null===(e=this.config)||void 0===e?void 0:e.stalenessInfo)||void 0===t?void 0:t.staleThreshold)<1&&(i=60*this.config.stalenessInfo.staleThreshold*1e3),Object(E.g)(le.d)>i?this.refreshFeed():this.refreshSDCards(),!0}refreshSDCards(){return Object(V.b)(this,void 0,void 0,(function*(){let e=this.getCurrentState().riverSectionFeedLayoutData;const t={};e.slice(0,2).forEach(e=>{e.cardMetadataList.forEach(e=>{e.type!==v.a.WeatherSummary&&e.type!==v.a.StockQuote&&e.type!==v.a.SportsMatch||(t[Oe[e.type]]=e.type)})}),this.unRenderedRiverContent.forEach(e=>{e.type!==v.a.WeatherSummary&&e.type!==v.a.StockQuote&&e.type!==v.a.MoneyInfo&&e.type!==v.a.SportsMatch||(t[Oe[e.type]]=e.type)});const i=yield this.SDCardProvider.fetch({contentType:Object.keys(t).join(",")});if(!i)return;e=this.getCurrentState().riverSectionFeedLayoutData;const s=[...e];e.slice(0,2).forEach((e,n)=>{e.cardMetadataList.forEach((s,n)=>{var a;if(Object.values(t).includes(s.type)){const t=null===(a=i[Oe[s.type]])||void 0===a?void 0:a.find(e=>e.type===s.type);if(!t)return;e.cardMetadataList[n]=t}}),this.rowCount=this.prevRowCount,e=Object.assign(Object.assign({},e),{feedData:this.mapFeedData(e.cardMetadataList,e.templateId,!0,this.riverSectionTelemetryObject),cardMetadataList:e.cardMetadataList}),s.splice(n,1,e)}),U.setRiverSectionFeedLayoutData.getActionSender(this).send(s),this.unRenderedRiverContent.forEach((e,t)=>{var s;if(e.type===v.a.WeatherSummary||e.type===v.a.StockQuote||e.type===v.a.MoneyInfo||e.type===v.a.SportsMatch){const n=null===(s=i[Oe[e.type]])||void 0===s?void 0:s.find(t=>t.type===e.type);if(!n)return;this.unRenderedRiverContent[t]=n}})}))}setCmsConfig(){const e=this.config.cmsAds;e&&(this.cmsAdsConfig={documentId:e.documentId,infoPaneIndices:Array.from(e.infopane),riverIndices:Array.from(e.river)})}checkAwayTime(){const{idleTimeout:e,idleControl:t}=this.config;if(!e||ie.b.IsPrerender)return;(new Date).getTime()<this.awayTimestamp+e||(k.a.addOrUpdateTmplProperty("idleAutoRefresh","1"),k.a.sendClientLogEvent({message:"IAR is triggered",type:"information"}),t||(this.ttvrFired=!1,this.refreshFeed(),k.a.sendPageView({page:{name:"IAR",isAutoRefresh:!0}})))}updateAwayTime(){this.awayTimestamp=(new Date).getTime()}resetRowCount(){this.rowCount={C5:0,C4:0,C3:0,C2:0,C1:0},this.prevRowCount=this.rowCount}}var et=i("05Au");class tt{reduce(e,t){if(!e)return{autoRotate:!1,coldStartFreResponse:void 0,isFocused:!1,moneyCardData:{},isMouseOver:!1,riverSectionFeedLayoutData:[]};if(!t)return e;let i,s=!1;return s=et.a.handleAction(t,U.setAutoRotate,t=>{i=Object.assign(Object.assign({},e),{autoRotate:t})}),s=s||et.a.handleAction(t,U.setIsFocused,t=>{i=Object.assign(Object.assign({},e),{isFocused:t})}),s=s||et.a.handleAction(t,U.setIsMouseOver,t=>{i=Object.assign(Object.assign({},e),{isMouseOver:t})}),s=s||et.a.handleAction(t,U.setRiverSectionFeedLayoutData,t=>{i=Object.assign(Object.assign({},e),{riverSectionFeedLayoutData:t})}),s=s||et.a.handleAction(t,U.setWeatherCardData,t=>{i=Object.assign(Object.assign({},e),{weatherCardData:Object.assign(Object.assign({},e.weatherCardData),t)})}),s=s||et.a.handleAction(t,U.setMoneyCardData,t=>{i=Object.assign(Object.assign({},e),{moneyCardData:Object.assign(Object.assign({},e.moneyCardData),t)})}),s=s||et.a.handleAction(t,U.toggleSDCardActionsMenu,(t,s)=>{i=Object.assign(Object.assign({},e),{actionsMenuProps:t,actionsMenuOpen:s})}),s=s||et.a.handleAction(t,U.setColdStartExperience,t=>{i=Object.assign(Object.assign({},e),{coldStartFreResponse:t})}),i||e}}var it=i("C8K2"),st=i("SP+O");const nt=f.a.fiveColSupported(),at=nt?{[Object(d.e)(null,d.a.c2)]:{width:it.c+"px"},[Object(d.f)(d.a.c3)]:{width:it.d+"px"},[Object(d.f)(d.a.c4)]:{width:it.e+"px"},[Object(d.e)(d.a.c5,null)]:{width:it.f+"px"}}:{[Object(d.e)(null,d.a.c2)]:{width:it.c+"px"},[Object(d.f)(d.a.c3)]:{width:it.d+"px"},[Object(d.e)(d.a.c4,null)]:{width:it.e+"px"}},rt=nt?{[Object(d.e)(null,d.a.c2)]:{width:"300px"},[Object(d.f)(d.a.c3)]:{width:it.c+"px"},[Object(d.f)(d.a.c4)]:{width:it.d+"px"},[Object(d.e)(d.a.c5,null)]:{width:it.e+"px"}}:{[Object(d.e)(null,d.a.c2)]:{width:"300px"},[Object(d.f)(d.a.c3)]:{width:it.c+"px"},[Object(d.e)(d.a.c4,null)]:{width:it.d+"px"}},ot=(e,t)=>{const i=Object(it.g)(e),s=Object(A.b)("margin-right","margin-left",t.direction);return nt?{[Object(d.e)(null,d.a.c2)]:{width:"300px",[s]:"auto"},[Object(d.f)(d.a.c3)]:{width:i.Size2ColumnWidth+"px"},[Object(d.f)(d.a.c4)]:{width:i.Size3ColumnWidth+"px"},[Object(d.e)(d.a.c5,null)]:{width:i.Size4ColumnWidth+"px"}}:{[Object(d.e)(null,d.a.c2)]:{width:"300px",[s]:"auto"},[Object(d.f)(d.a.c3)]:{width:i.Size2ColumnWidth+"px"},[Object(d.e)(d.a.c4,null)]:{width:i.Size3ColumnWidth+"px"}}};var ct=i("icPF");const dt=Object(s.a)(e=>({desktopFeedEdgeNext_root:Object.assign({color:st.c,margin:"0 auto",position:"relative"},at),desktopFeedEdgeNext_withRightRail:Object.assign({},rt),desktopFeedEdgenext_withRightRail_4gutter:Object.assign(Object.assign({},ot(4,e)),{[Object(A.b)("margin-right","margin-left",e.direction)]:"0px"}),desktopFeedEdgenext_withRightRail_6gutter:Object.assign(Object.assign({},ot(6,e)),{[Object(A.b)("margin-right","margin-left",e.direction)]:"0px"}),desktopFeedEdgenext_withRightRail_8gutter:Object.assign(Object.assign({},ot(8,e)),{[Object(A.b)("margin-right","margin-left",e.direction)]:"0px"}),desktopFeedEdgenext_withRightRail_10gutter:Object.assign(Object.assign({},ot(10,e)),{[Object(A.b)("margin-right","margin-left",e.direction)]:"0px"}),feedSection:{display:"grid","flex-flow":"row wrap",gap:"12px","justify-content":"center","margin-bottom":"33px","--elevated-corner-radius":"6","--cold-start-upsell-grid-template-rows":"16px 232px 48px"},xlGap:{gap:"10px!important"},lGap:{gap:"8px!important"},mGap:{gap:"6px!important"},xmGap:{gap:"4px!important"},infopaneSentinel:{position:"absolute",width:"612px",height:"304px",top:"0",left:"0","z-index":"-1"},paginationSentinel:{bottom:"0",height:"1px",position:"absolute",width:"100%","z-index":"-1"}}))(F),lt={reactComponent:dt,experienceConfigSchema:q.DesktopFeedEdgeNextConfigSchema,defaultMockState:n.mockDefaultState,mockState:n.mockState,mockConfig:ct.mockConfig,inspector:We.inspect}},icPF:function(e,t){},mEtE:function(e,t,i){"use strict";t.a=function(e){return e&&e.length?e[0]:void 0}},mJFi:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var s=i("HDSB"),n=i("D57K"),a=i("I6Lx"),r=i("ADRF"),o=i("tMmC"),c=i("X9Vi");class d{constructor(e,t,i=null){this.fetchImpl=e,this.config=t,this.xhrFetch=i,this.cfg=t||d.defaultConfig,this.cfg.appId=this.cfg.appId||d.defaultConfig.appId,this.cfg.num=this.cfg.num||d.defaultConfig.num}geocodeSuggestion(e){return Promise.resolve(null)}getAutoSuggestResponse(e){return Object(n.b)(this,void 0,void 0,(function*(){const t=[{key:"appid",value:this.cfg.appId},{key:"mr",value:""+this.cfg.num},{key:"q",value:e},{key:"setmkt",value:!this.cfg.redirectZhCnJaJpMarket||"ja-jp"!==a.b.Locale&&"zh-cn"!==a.b.Locale?a.b.Locale:"en-us"},{key:"setlang",value:a.b.Locale},{key:"ul",value:a.b.ClientSettings?`${a.b.ClientSettings.geo_lat},${a.b.ClientSettings.geo_long},100`:""}];let i=[];if(!e||!e.trim||!e.trim().length)return i;const s=new URL(d.bingAutosuggestApi,d.bingAutoSuggestServiceHost);return s.search=r.a.keyValueArrayToQueryString(t),i=yield this.fetchImpl(s.href,{jsonpCallback:"cb"}).then(e=>e.json()).then(e=>this.getWeatherLocationFromResponse(e)).catch(e=>(o.a.log("failed: "+e),null)),i}))}getWeatherLocationFromResponse(e){const t=[];if(e&&e["@graph"]){const i=e["@graph"];for(let e=0;e<i.length;e++){const s=i[e];if(s){switch(s["b:stype"]){case"Island":case"PopulatedPlace":case"Postcode1":case"Other":{const e=s["s:address"]||{},i=s["s:geo"]||{},n=i["s:latitude"],r=i["s:longitude"];if("number"==typeof n&&"number"==typeof r){const i={locality:e["s:addressLocality"]||e["s:name"]||"",region:c.d.abbreviateUSState(e["s:addressRegion"]||"",a.b.Locale,e["b:countryIso"]||""),subRegion:e["b:addressSubregion"]||"",country:e["s:addressCountry"]||"",latitude:Number(n).toString(),longitude:Number(r).toString(),isoCode:e["b:countryIso"]||"",language:a.b.Locale};c.b.isValidLocationToSuggest(i)&&t.push(i)}}}}}}return t}getLocationSearchResponse(e){return Object(n.b)(this,void 0,void 0,(function*(){const t=[{key:"appid",value:this.cfg.appId},{key:"locale",value:a.b.Locale},{key:"query",value:e}],i=[];if(!e||!e.trim||!e.trim().length)return i;const s=new URL(d.msnLocationSearchApi,d.msnApiServiceHost);s.search=r.a.keyValueArrayToQueryString(t);(new Headers).append("contentType","application/json");const n=yield(this.xhrFetch?this.xhrFetch:fetch)(s.href,{method:"GET",headers:{"Content-Type":"application/json"}});return n.ok||500===n.status?this.getweatherLocationFromSearchResponse(yield n.json()):null}))}isSameLocation(e,t){return e==t||null!=e&&null!=t&&(e.locationType==t.locationType&&(Math.abs(parseFloat(e.latitude)-parseFloat(t.latitude))<.001&&Math.abs(parseFloat(e.longitude)-parseFloat(t.longitude))<.001||(this.distance(e,t)<150||void 0)))}distance(e,t){const i=parseFloat(e.latitude)*Math.PI/180,s=parseFloat(e.longitude)*Math.PI/180,n=parseFloat(t.latitude)*Math.PI/180,a=n-i,r=parseFloat(t.longitude)*Math.PI/180-s,o=Math.sin(a/2)*Math.sin(a/2)+Math.sin(r/2)*Math.sin(r/2)*Math.cos(i)*Math.cos(n);return 6371*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))}getweatherLocationFromSearchResponse(e){if(!(e.value&&e.value[0]&&e.value[0].responses&&e.value[0].responses[0]))return[];const t=e.value[0].responses[0];if(t.error)return[];const i=t.locations.filter(e=>("admindivision1"!==e.entityType.toLowerCase()||"jp"===e.countryCode.toLowerCase())&&e.coordinates&&e.coordinates.lat&&e.coordinates.lon).map(e=>({isoCode:e.countryCode,locality:e.locality,region:e.state||e.adminDistrict,country:e.countryRegion,latitude:e.coordinates.lat.toString(),longitude:e.coordinates.lon.toString(),displayName:e.displayName})),s=[];return i.forEach(e=>{0==s.map(t=>this.isSameLocation(t,e)).filter(e=>e).values.length&&s.push(e)}),s}populateSearchMoreResponse(){}}d.bingAutoSuggestServiceHost="https://platform.bing.com",d.bingAutosuggestApi="geo/AutoSuggest/v1",d.defaultConfig={num:4,appId:"C98EA5B0842DBB9405BBF071E1DA76512D21FE36"},d.msnLocationSearchApi="/v0/weather/locations/search",d.msnApiServiceHost="https://api.msn.com";var l=i("qE0w");class h{constructor(e,t,i,s,n,a,r,o){this.fetchImpl=e,this.host=t,this.api=i,this.appId=s,this.excludeSubTypes=n,this.includeSubTypes=a,this.escapeISO=r,this.flightId=o,this.filterSuggestion=e=>-1===this.excludeSubTypes.indexOf(e.subType)&&(-1!==this.escapeISO.indexOf(e.address&&e.address.countryIso&&e.address.countryIso.toLowerCase())||-1!==this.includeSubTypes.indexOf(e.subType)),this._parseLocationFromAS=!0}addExtraASParams(e,t){return e}_getDefaultSuggestions(){return[]}getSuggestions(e){return Object(n.b)(this,void 0,void 0,(function*(){if(e.disableThisRequest)return null;if((!e.searchText||""===e.searchText.trim())&&(e.disableFavorites||!this._useFavoriteSuggestions)){let e=this._getDefaultSuggestions();const t=this.getHistorySuggestions();e=this._combineSuggestions(t,e),this._updateSuggestionsRank(e);return{suggestions:e}}const t=this._constructASRequestUrl(e);return this.fetchImpl(t.href).then(e=>e.json()).then(t=>{const i=this._parseSuggestionsV6(t),s=this.getHistorySuggestions(e.searchText),n=e.searchText&&""!==e.searchText.trim()?[]:this._getDefaultSuggestions();return i.suggestions=this._combineSuggestions(i.suggestions,s),i.suggestions=this._combineSuggestions(i.suggestions,n),this._updateSuggestionsRank(i.suggestions),i}).catch(e=>null)}))}getHistorySuggestions(e){return[]}_constructASRequestUrl(e){const t=[{key:"appid",value:this.appId},{key:"count",value:""+e.maxResults},{key:"q",value:e.searchText},{key:"localcircularview",value:e.userLocation&&e.userLocation+",100"},{key:"setmkt",value:a.b.Locale},{key:"setlang",value:a.b.Locale},{key:"types",value:e.suggestionTypes||""},{key:"abbrtext",value:e.abbrSuggestions?"1":""},{key:"structuredaddress",value:"true"},{key:"strucaddrread",value:"1"},{key:"setflight",value:this.flightId}],i=new URL(this.api,this.host);return i.search=r.a.keyValueArrayToQueryString(t),i}_combineSuggestions(e,t){let i=[];if(t&&t.length){i=t;let s=!1;for(let n=0;n<e.length;n++){e[n].root;const a=e[n].address,r=a&&a.streetAddress,o=a&&a.addressLocality,c=e[n].name;for(let e=0;e<t.length;e++){const i=t[e];if(r&&i.formatedAddress&&i.formatedAddress.indexOf(r)>-1&&(o&&i.formatedAddress.indexOf(o)>-1||c&&i.title&&i.title.indexOf(c)>-1)){s=!0;break}}s?s=!1:i.push(e[n])}}else i=e;return i}_updateSuggestionsRank(e){for(let t=0;t<e.length;t++)e[t].suggestionRank=t}_parseSuggestionsV6(e){const t={},i=[];if(e){const s=e.instrumentation;t.formattingRules=this._createFormattingRulesV6(e.formattingRules);const n=this._getDefaultFormattingRuleV6(t.formattingRules),r=e.value;for(let e=0;e<r.length;e++){const o={},d=r[e];try{o.root=d,o.type=d._type,o.readLink=d.readLink,o.readLinkPingSuffix=d.readLinkPingSuffix,o.instrumentationInfo=s,o.suggestionRank=e,o.formattingRuleId=d.formattingRuleId,o.formattingRule=o.formattingRuleId&&t.formattingRules[o.formattingRuleId]||n,o.entityId=d.id,o.name=d.name,o.query=d.query;const r=d.categories;o.primaryCategoryPath=r&&r.length&&r[0],o.entityId&&0===o.entityId.indexOf("local_geoid")&&(o.geoId=o.entityId,o.entityId="");const l=d.entityPresentationInfo;l&&l.entitySubTypeHints&&l.entitySubTypeHints.length&&(o.subType=l.entitySubTypeHints[0]);const h=d.geo;if(h&&this._parseLocationFromAS){const e=h.latitude,t=h.longitude;e&&t&&(o.location={latitude:e,longitude:t})}d.address?(o.address=d.address,o.address.addressRegion=c.d.abbreviateUSState(o.address.addressRegion,a.b.Locale,o.address.countryIso)):d.location&&d.location.length?o.address=d.location[0].address:"PostalAddress"===o.type&&(o.address=d),"Favorite"==o.type&&(o.alternateName=d.alternateName,o.subType=d.subType,this._processFavoriteItemId(d,o)),i.push(o)}catch(e){}}}return t.suggestions=i.filter(this.filterSuggestion),t}_createFormattingRulesV6(e){const t={};if(e)for(let i=0;i<e.length;i++){const s=JSON.parse(e[i]);t[s.identifier]=s}return t}_getDefaultFormattingRuleV6(e){let t=e&&e.Default||null;for(const i in e){t||(t=e[i]);if(a.b.Locale.indexOf(i.toLowerCase())>-1){t=e[i];break}}return t}_processFavoriteItemId(e,t){const i=e.bingId;!i||0!==i.indexOf("local_ypid:")&&0!==i.indexOf("sid")&&0!==i.indexOf("local_vdpid")||(t.entityId=i),t.bingId=i}}h.autosuggestCallerId="autosug";class u{constructor(e){this.suggestion=e,this._formatSuggestion(this.suggestion),this.setSimpleSearchText(),this._setDisplayName()}_setDisplayName(){const e=this._formattingRule&&this._formattingRule["b:groupSeparator"]||", ";this.suggestionTextLine2?this.suggestion.displayName=this.suggestionTextLine1+e+this.suggestionTextLine2:this.suggestion.displayName=this.suggestionTextLine1}setSimpleSearchText(){const e=this._formattingRule&&this._formattingRule["b:groupSeparator"]||", ";if("Favorite"===this.suggestion.type){const t=this.suggestion,i=t.name,s=t.address&&t.address.streetAddress;this._searchText=i!==s&&s?i+e+s:i}else this.suggestionTextLine2?this._searchText=this.suggestionTextLine2+e+this.suggestionTextLine1:this._searchText=this.suggestionTextLine1;this.suggestion&&(this.suggestion.searchText=this._searchText)}_removeCountry(e){let t=", ";this._formattingRule&&(t=this._formattingRule["b:groupSeparator"]||this._formattingRule.groupSeparator||", ");const i=this.suggestion.address||this.suggestion.root,s=i&&i.addressCountry;if(s&&e&&e.slice(e.length-s.length)===s){const i=e.slice(0,e.length-s.length);return i.slice(i.length-t.length)===t?i.slice(0,i.length-t.length):i}return e}_formatSuggestion(e){const t=this.suggestion.formattingRule,i=e;if("Favorite"===e.type)return i.alternateName?this.suggestionTextLine1=i.alternateName:this.suggestionTextLine1=i.name,this.suggestionTextLine2=i.address&&i.address.streetAddress,this.suggestion.formatedAddress=i.address&&i.address.streetAddress,void(this.suggestion.title=i.name);i.name&&(this.suggestionTextLine1=i.name,e.title=i.name),i.query&&(this.suggestionTextLine1=i.query),t?(this._formattingRule=t,this.suggestion.address?this._applyFormattingRule(this.suggestion.address):this._applyFormattingRule(e.root)):(this.suggestionTextLine1=e.title,this.suggestionTextLine2=e.formatedAddress),this.suggestion.formatedLine1=this.suggestionTextLine1,this.suggestion.formatedLine2=this.suggestionTextLine2,this.suggestion.formatedLine2WithoutCountry=this._removeCountry(this.suggestionTextLine2)}_applyFormattingRule(e){let t=0;const i=this._formattingRule["b:fieldGroups"]||this._formattingRule.fieldGroups;if(!this.suggestionTextLine1)for(;t<i.length;t++){const s=this._getFormattedGroupString(e,i[t]);if(s){this.suggestionTextLine1=s,this.suggestion.title=s,++t;break}}const s=[];for(;t<i.length;t++){const n=this._getFormattedGroupString(e,i[t]);n&&s.push(n)}const n=this._formattingRule["b:groupSeparator"]||this._formattingRule.groupSeparator||", ";this.suggestionTextLine2=s.join(n),this.suggestion.formatedAddress=this.suggestionTextLine2}_getFormattedGroupString(e,t){const i=[];let s;const n=t.fields;for(let t=0;t<n.length;t++)s=this._getPrimaryField(e,n[t]),s||(s=this._getAlternateField(e,n[t])),s&&i.push(s);const a=t.fieldSeparator||" ";return i.join(a)}_getPrimaryField(e,t){let i;return e&&t&&(i=e[t.name]),i}_getAlternateField(e,t){let i;if(e&&t){const s=t.alternateField;if(s){const t=s.split(",");for(let s=0;s<t.length&&(i=e[t[s]],!i);s++);}}return i}}u.HistorySuggestionType="history";class g{constructor(e,t){this.key=e,this.fetchImpl=t,this.geocode=(e,t,i,s,o)=>Object(n.b)(this,void 0,void 0,(function*(){const n={success:!1,statusCode:null,authenticationResultCode:null,statusDescription:null,name:e,results:null};if(!location)return null;const c=i&&i<=g._maxNumberOfResults?i:g._defaultResultCount,d=[{key:"key",value:this.key},{key:"maxResults",value:""+c},{key:"q",value:encodeURIComponent(e)},{key:"inclnb",value:s?"1":"0"},{key:"incl",value:o?"ciso2":""},{key:"userMapView",value:g._getBoundsString(t)},{key:"culture",value:a.b.Locale}],l=new URL(g.geoApi,g.geoHost);return l.search=r.a.keyValueArrayToQueryString(d),this.fetchImpl(l.href).then(e=>e.json()).then(e=>{if(e&&e.authenticationResultCode===g._validAuthenticationCode&&e.statusCode===g._validStatusCode&&e.statusDescription===g._validStatusDescription&&e.resourceSets&&0!==e.resourceSets.length){let t;n.success=!0,n.statusCode=g._validStatusCode,n.authenticationResultCode=g._validAuthenticationCode,n.statusDescription=g._validStatusDescription;for(let i=0,s=e.resourceSets.length;i<s;i++)if(t=e.resourceSets[i].resources,t&&0!==t.length){n.results=t;break}n.traceId=e.traceId}else e?(n.statusCode=e.statusCode,n.authenticationResultCode=e.authenticationResultCode,n.statusDescription=e.statusDescription,n.errorMessage=e.errorDetails&&e.errorDetails.length>0&&e.errorDetails[0],n.traceId=e.traceId):(n.statusCode=400,n.authenticationResultCode="Unknown",n.statusDescription="Unknown");return n}).catch(e=>(n.authenticationResultCode="Unknown",n.statusCode=404,n.statusDescription="Http Error",n))}))}static _getBoundsString(e){return e?e.south+","+e.west+","+e.north+","+e.east:""}}g._validAuthenticationCode="ValidCredentials",g._validStatusCode=200,g._validStatusDescription="OK",g._defaultResultCount=5,g._maxNumberOfResults=20,g.geoHost="https://dev.virtualearth.net",g.geoApi="/REST/v1/Locations";class p{constructor(e,t,i=null,s=null){this.fetchImpl=e,this.userLocation=i,this.xhrFetch=s,this._translateSuggestion=e=>{const t=e.suggestion.address||e.suggestion.root,i=e.suggestion.location,s=i&&i.latitude,n=i&&i.longitude;if(this.cfg.notFollowFormatRule){const i={language:a.b.Locale,addressLine:e.suggestion.name||(null==t?void 0:t.streetAddress),locality:null==t?void 0:t.addressLocality,region:null==t?void 0:t.addressRegion,subRegion:null==t?void 0:t.addressSubregion,country:t&&(t.addressCountry||""),latitude:s&&Number(s).toString(),longitude:n&&Number(n).toString(),typeV6:e.suggestion.type,searchText:e.suggestion.searchText,formatedAddress:e.suggestion.formatedAddress,readLink:e.suggestion.readLink,locationType:l.getHyperlocalType(e.suggestion.type,e.suggestion.subType),isoCode:t&&(t.countryIso||"")};return i.displayName=l.formatLocation(i),i.firstLine=l.getAutoSuggestLocationFirstLine(i),i.secondLine=l.getAutoSuggestLocationSecondLine(i),i}return{language:a.b.Locale,locality:e.suggestion.formatedLine1,region:e.suggestion.formatedLine2WithoutCountry,country:t&&(t.addressCountry||""),latitude:s&&Number(s).toString(),longitude:n&&Number(n).toString(),typeV6:e.suggestion.type,searchText:e.suggestion.searchText,formatedAddress:e.suggestion.formatedAddress,readLink:e.suggestion.readLink,locationType:l.getHyperlocalType(e.suggestion.type,e.suggestion.subType),isoCode:t&&(t.countryIso||"")}},this.cfg=Object.assign(Object.assign({},p.defaultConfig),t||{}),"CN"==(null==i?void 0:i.isoCode)&&(this.cfg.endpoint="https://cn.bing.com"),this._extraResult=this.cfg.latinPercentageLimit>0?5:0,this._geocoder=new g(this.cfg.geocoderKey,e),this.cfg.escapeISO=this.cfg.escapeISO.map(e=>e.toLowerCase()),this._autoSuggestModel=new h(e,this.cfg.endpoint,p.bingAutosuggestApi,this.cfg.appId,this.cfg.excludeSubTypes,this.cfg.includeSubTypes,this.cfg.escapeISO,this.cfg.flightId)}getLocationSearchResponse(e){return Promise.resolve(null)}getAutoSuggestResponse(e){var t,i,s;return Object(n.b)(this,void 0,void 0,(function*(){if(e){const n="zh-cn"===(null===(t=null===a.b||void 0===a.b?void 0:a.b.Locale)||void 0===t?void 0:t.toLowerCase())&&"zh"!==(null===(s=null===(i=null===a.b||void 0===a.b?void 0:a.b.ClientSettings)||void 0===i?void 0:i.geo_country)||void 0===s?void 0:s.toLowerCase())?"40,116":this.userLocation&&`${this.userLocation.latitude},${this.userLocation.longitude}`,r={searchText:e,maxResults:this.cfg.num+this._extraResult,userLocation:n,suggestionTypes:this.cfg.suggestionTypes,abbrSuggestions:!0,localMapView:null},o=yield this._autoSuggestModel.getSuggestions(r);return this._parseSuggestions(o)}}))}_latinPercentage(e){const t=e.locality+e.country+e.region+e.subRegion;if(!t)return 0;return t.match(p.latinParttern).join("").length/t.length}_parseSuggestions(e){const t=[],i=e.suggestions;if(i.length>0)for(let e=0;e<i.length;e++)t.push(this._getSuggestionResult(i[e]));let s=t.map(this._translateSuggestion);return this.cfg.latinPercentageLimit>0&&(s=s.filter(e=>this._latinPercentage(e)>this.cfg.latinPercentageLimit).slice(0,this.cfg.num)),s=s.filter(e=>l.isValidLocationToSuggest(e)),s}_getSuggestionResult(e){return new u(e)}_getLatLongFromReadLink(e){return Object(n.b)(this,void 0,void 0,(function*(){if(!e.readLink)return null;const t=new URL(e.readLink);return t.searchParams.append("appid",this.cfg.appId),this.fetchImpl(t.href).then(e=>e.json()).then(t=>{var i,s;const n=t.geo||(null===(s=null===(i=t.value)||void 0===i?void 0:i[0])||void 0===s?void 0:s.geo);if(n&&n.latitude&&n.longitude)return Object.assign(Object.assign({},e),{latitude:n.latitude.toString(),longitude:n.longitude.toString()})}).catch(e=>null)}))}geocodeSuggestion(e){return Object(n.b)(this,void 0,void 0,(function*(){const t=e;if(t.longitude&&t.latitude)return t;const i=yield this._getLatLongFromReadLink(e);if(i)return i;const s=this._getSuggestionAddress(t);return this._geocoder.geocode(s,null,1).then(e=>{if(e.success&&e.results&&e.results.length>0){const i=e.results[0];i.bbox;if(i.point){const e=i.point.coordinates;return t.latitude=e[0].toString(),t.longitude=e[1].toString(),t}}return null})}))}_getSuggestionAddress(e){return e&&"LocalBusiness"===e.typeV6&&e.formatedAddress?e.formatedAddress:e&&e.searchText}}p.bingAutosuggestApi="/api/v6/Places/AutoSuggest",p.defaultConfig={num:5,appId:"D41D8CD98F00B204E9800998ECF8427E1FBE79C2",geocoderKey:"AnTcaqBi2ypp0xI-OZNi4W_ik2KhjgpqioTAtXLC8GzkMBQRMlyxvxyTnd5b73im ",suggestionTypes:"",endpoint:"https://www.bing.com",excludeSubTypes:["CountryRegion","AdminDivision1"],includeSubTypes:["PopulatedPlace","AdminDivision2"],escapeISO:["us"],flightId:""},p.latinParttern=/[\u00C0-\u00ff\w\s\p{Number}.,/#!$%^&*;:{}=\-_`~()]+/gu;var m=i("5xIM"),f=i.n(m);function b(e){if(e&&e.useV6){const t=Object(s.a)()?window.fetch.bind(window):fetch;return new p(t,e,c.b.headLocation())}return new d(f.a,e)}},mOQN:function(e,t,i){"use strict";var s=i("oKML"),n=i("FoV5");t.a=function(e){return null==e?[]:Object(s.a)(e,Object(n.a)(e))}},mXQk:function(e,t,i){"use strict";i.d(t,"d",(function(){return s})),i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return r})),i.d(t,"e",(function(){return o})),i.d(t,"f",(function(){return c})),i.d(t,"g",(function(){return d}));const s={ColdStart:"ColdStart",UpsellGetStartedButton:"GetStarted"},n="cold-start-close",a="cold-start-confirm",r="cold-start-selection-done",o={Article:{width:148,height:108},Provider:{width:64,height:64},Topic:{width:200,height:200},FollowCard:{width:82,height:82}},c=10,d="https://img-s-msn-com.akamaized.net/tenant/amp/entityid/AAtCmK3.img"},oKML:function(e,t,i){"use strict";var s=i("mr4r");t.a=function(e,t){return Object(s.a)(t,(function(t){return e[t]}))}},pMIE:function(e,t,i){"use strict";var s=i("/XsO"),n=i("eupA");var a=function(e){return Object(n.a)(Object(s.a)(e))},r=i("mOQN");var o=function(e){return Object(n.a)(Object(r.a)(e))},c=i("SEb4");t.a=function(e){return(Object(c.a)(e)?a:o)(e)}},rFwl:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var s=i("OOuA"),n=i("7nmT"),a=i.n(n),r=i("wirn"),o=i("1I/+"),c=i("Gy7L"),d=i("qibw"),l=i("OnwC"),h=i("Sunj"),u=i("pH9t"),g=i("nSud"),p=i("L1Sn");h.a,u.a,g.a;class m extends l.a{constructor(e){super(e),this.handledProps={managedClasses:void 0,menuItems:void 0,onDismiss:void 0,referrerButton:void 0,requestContext:void 0,overrideStyles:void 0,preventFocusScroll:void 0,innerElemScrollTop:void 0},this.determinePosition=()=>{const{referrerButton:e}=this.props;if(e){const{top:t,left:i,width:s}=e.getBoundingClientRect();return{top:t+window.scrollY,left:i+window.scrollX,offset:s}}return{top:window.scrollY,left:window.scrollX,offset:0}},this.menuItemKeyDown=e=>{e.keyCode===c.l&&this.props.menuItems.find(t=>t.id===e.currentTarget.id).onClick(e)},this.keyDownHandler=e=>{const{referrerButton:t,onDismiss:i}=this.props;e.keyCode===c.m?(t&&t.focus(),i&&i()):this.tabEventHandler(e)},this.tabEventHandler=e=>{const{referrerButton:t,onDismiss:i}=this.props,s=a.a.findDOMNode(this);e.keyCode===c.r&&t&&s.contains(document.activeElement)&&(t.focus(),i&&i(),e.preventDefault())},this.state={width:0,height:0}}componentDidMount(){const e=a.a.findDOMNode(this);this.setState({width:e.offsetWidth,height:e.offsetHeight});const t=!!this.props.preventFocusScroll;this.firstMenuItemRef&&this.firstMenuItemRef.focus({preventScroll:t})}componentWillUnmount(){const e=document.getElementsByClassName(this.props.managedClasses.menuItem);Array.from(e).forEach(e=>{p.a.get(e).isCaptured=!1})}render(){return Object(s.a)("div",Object.assign({onKeyDown:this.keyDownHandler,tabIndex:-1,style:Object.assign(Object.assign({},this.getPlacementStyle(document.dir)),{position:"absolute"})},this.unhandledProps(),{className:this.props.managedClasses.menu}),Object(s.a)(h.a,null,this.renderActionsMenuSectionItems()))}renderActionsMenuSectionItems(){const{menuItems:e}=this.props,t={marginTop:0,marginBottom:"6px"};return e.map((e,i)=>e.isDivider?Object(s.a)(g.a,{style:t}):Object(s.a)(u.a,Object.assign({ref:e=>this.firstMenuItemRef=this.firstMenuItemRef||e,role:"menuitem",key:"ccaitem-"+i},e.telemetryTags,{onClick:e.onClick,onKeyDown:this.menuItemKeyDown,id:e.id,tabIndex:0,class:this.props.managedClasses.menuItem}),e.glyph&&Object(s.a)(r.a,{glyphType:e.glyph,slot:"start"}),Object(s.a)("span",{"aria-label":e.title},e.title)))}getPlacementStyle(e){const{width:t,height:i}=this.state;let s,n,a;const{referrerButton:r,innerElemScrollTop:c}=this.props,d=c||0;if(r){const e=this.determinePosition();s=e.left,n=e.top+e.offset+document.body.scrollTop,a=e.offset}if(!t)return{top:n,left:window.scrollX};const l=Object(o.b)(this.props.requestContext.data.innerWidth,"innerWidth"),h=window.document&&window.document.documentElement&&window.document.documentElement.offsetHeight+document.body.scrollTop;if(h&&n+i>h){if(n-i-a<0)return this.getHorizontallyPlacedStyle(e,s,n,a,l,h,t,i);n=n-i-a}n+=d;const u={top:n,left:Math.max(s-t+a,.5*a)},g={top:n,left:s};return this.getPrioritizedFittingPosition(e,[u,g],t,l,a)}getPrioritizedFittingPosition(e,t,i,s,n){const[a,r]=e===d.a.rtl?t:[t[1],t[0]],o=a.left+i<s,c=r.left+i<s;if(o)return a;if(!o&&c)return r;{const i={top:t[0].top};return e===d.a.rtl?i.right=.5*n:i.left=.5*n,i}}getHorizontallyPlacedStyle(e,t,i,s,n,a,r,o){i-s+o<=a?i-=s:i-o>=0?i-=o:i=i-.5*s<.5*a?.5*s:a-.5*s-o;const c={top:i,left:t+s},d={top:i,left:t-r};return this.getPrioritizedFittingPosition(e,[d,c],r,n,s)}}const f={menu:{display:"inline","animation-duration":"0.367s","animation-fill-mode":"both","animation-name":"fadeIn, slideIn","animation-timing-function":"cubic-bezier(0.1, 0.9, 0.2, 1)","border-radius":"4px","box-shadow":"0 2.4px 7.2px rgba(0, 0, 0, 0.18), 0 12.8px 28.8px rgba(0, 0, 0, 0.22)","max-width":"275px","min-width":"240px",overflow:"hidden",position:"absolute","z-index":""+i("0fst").a.Flyout,"&:focus":{outline:"none"},"& fluent-menu-item::part(content)":{width:"100%"}},"@keyframes fadeIn":{from:{opacity:0},to:{opacity:1}},"@keyframes slideIn":{from:{transform:"translate3d(0px, -10px, 0px)"},to:{transform:"translate3d(0px, 0px, 0px)"}},menuItem:{"grid-template-columns":"32px auto"}};var b=i("+viU");const v=Object(b.a)(f)(m)},rGfm:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var s=i("G82u");class n{}n.refreshRiver=new s.a("RiverRefresh"),n.repaintRiver=new s.a("RiverRepaint"),n.riverRefreshed=new s.a("RiverRefreshed"),n.riverQueryUpdated=new s.a("RiverQueryUpdated"),n.riverLocationUpdated=new s.a("RiverLocationUpdated")},rPvf:function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var s=i("D57K"),n=i("HxRh"),a=i("tMmC"),r=i("y+Kz"),o=i("BQg2"),c=i("rvYQ"),d=i("VbA2"),l=i("zfSW"),h=i("I6Lx"),u=i("OTRt"),g=i("msIb"),p=i("6ADy"),m=i("KETb"),f=i("ac9z"),b=i("kN1G"),v=i("/+Un");class y{constructor(){this.cachedMetadata={}}get(e){const t=C(e);if(t)return this.cachedMetadata[t]}set(e,t){const i=C(e);i&&(this.cachedMetadata[i]=t)}}function C(e){if(e)return JSON.stringify(e)}var S=i("tERu"),O=i("u5KZ"),A=i("HDSB"),I=i("zJcZ");class w{constructor(e){this.config=e,this.responseCache=new y,this.requestPathWithoutFeedId="MSN/Feed/me",this.requestPathWithFeedId="MSN/Feed",this.requestPathForFeedLayout="MSN/FeedLayout"}fetch(e,t){return Object(s.b)(this,void 0,void 0,(function*(){let i=this.config.initialRequest;if(e&&(e.feedId||!i.feedId||e.nextPageUrl||(e.feedId=i.feedId),i=Object.assign(Object.assign({},i),e)),!i)return void O.a.sendAppErrorEvent(Object.assign(Object.assign({},n.lg),{message:"default OneService fetch configuration was invalid"}));const l=this.responseCache.get(i);if(l)return l;const h=(null==e?void 0:e.forceEnterpriseCompliance)||Object(b.j)(),y=yield g.a.getOneServiceFeedCallHeaders(h);if(h&&!(null==y?void 0:y[r.w.authorization]))return;const C={credentials:"include",headers:y,method:"GET"},w=i.useNextPageUrl&&i.nextPageUrl,R=i.feedLayoutRequestType;let T;T=!w&&R?this.requestPathForFeedLayout:i.feedId?this.requestPathWithFeedId:this.requestPathWithoutFeedId;const j=Object(p.b)(T,null==e?void 0:e.overwriteBaseApiURL),x=Object(f.b)();if(w)this.requestQueryParams=new o.a(new URL(w).search),x>0&&this.requestQueryParams.set(f.a,x.toString()),c.b.SendFeedCallActivityIdInHeader||this.requestQueryParams.set(r.x.activityId,c.b.ActivityId);else{const{ocid:e,flightData:t,overwriteFlightData:s}=i,n=(yield Object(v.d)())===S.c.SignedIn?g.a.getOneServiceParamsWithAuth(c.b.UserId,e,!1,t,s):g.a.getOneServiceParamsWithoutAuth(c.b.UserId,e,!1,t,s,h);this.requestQueryParams=new o.a;for(let e=0;e<n.length;e++)this.requestQueryParams.set(n[e].key,n[e].value);if(R&&!i.start)this.requestQueryParams.set(r.x.feedLayoutRequestType,R);else if(!i.disableQueryType){const e=i.queryType||"myfeed";this.requestQueryParams.set(r.x.queryType,e)}if(this.requestQueryParams.set(r.x.responseSchema,i.disableFlatViewResponse?u.a.CardView:u.a.FlatView).set(r.x.wrapOData,"false").set(r.x.disableTypeSerialization,"true").set(r.x.timeOut,""+this.getRequestTimeout(i)).set(r.x.contentType,i.contentType).set(r.x.select,i.select),i.count&&this.requestQueryParams.set(r.x.top,""+i.count),this.tryAddQueryInterestParams(i)||this.requestQueryParams.set(r.x.ids,i.feedId).set(r.x.query,i.query),!R&&!i.disableLocation){const e=g.a.getLocationParams(i.latitude,i.longitude);e&&this.requestQueryParams.set(e.key,e.value)}i.start&&this.requestQueryParams.set(r.x.skip,""+i.start),i.infopaneItemCount&&(this.requestQueryParams.set(r.x.infopaneCount,""+i.infopaneItemCount),!1===i.complexInfopaneEnabled&&this.requestQueryParams.set(r.x.complexInfoPaneEnabled,"false")),x>0&&this.requestQueryParams.set(f.a,x.toString()),(i.useDelta||i.sessionId)&&(!1!==i.useDelta&&this.requestQueryParams.set(r.x.delta,"true"),i.sessionId&&this.requestQueryParams.set(r.x.session,i.sessionId))}let P,M,E,D;c.b.SendFeedCallActivityIdInHeader&&this.requestQueryParams.delete(r.x.activityId),j.search=this.requestQueryParams.toString();try{const e=Object(A.a)()?1e4:800,t=yield Object(m.a)(()=>Object(s.b)(this,void 0,void 0,(function*(){return yield Object(d.a)(decodeURIComponent(j.href),e,C)})),"OneServiceCardProvider.fetch");if(!t||!t.ok&&404!==t.status){E=t?t.status:null,D=t?t.statusText:null;const e=401===E?n.qj:n.kg;return void O.a.sendAppErrorEvent(Object.assign(Object.assign({},e),{message:t?"OneService returned error response":"OneService response was null",pb:Object.assign(Object.assign({},e.pb),{fetchNetworkResponse:{activityId:c.b.ActivityId,requestUrl:j.href,statusCode:E,statusText:D}})}))}if(204===t.status||404===t.status?(P={feedItems:[]},E=t.status,D=t.statusText,O.a.sendAppErrorEvent(Object.assign(Object.assign({},n.jg),{message:204===t.status?"Empty non first-page response":"Empty first-page response",pb:Object.assign(Object.assign({},n.jg.pb),{fetchNetworkResponse:{activityId:c.b.ActivityId,requestUrl:j.href,statusCode:E,statusText:D}})}))):P=yield t.json(),t.headers){t.headers.get("X-Statics-Fallback")&&O.a.sendAppErrorEvent(Object.assign(Object.assign({},n.mg),{pb:Object.assign(Object.assign({},n.mg.pb),{customMessage:"Request URL: "+decodeURIComponent(j.href)}),message:"Fell back to static content on the feeds call"}));const e=t.headers.get("ddd-tmpl");O.a.addOrUpdateTmplString(e),M=t.headers.get("ddd-session-id")}}catch(e){return void O.a.sendAppErrorEvent(Object.assign(Object.assign({},n.fg),{message:"Error while fetching OneService response",pb:Object.assign(Object.assign({},n.fg.pb),{customMessage:"Error: "+e,fetchNetworkResponse:{activityId:c.b.ActivityId,requestUrl:j.href}})}))}if(!P)return void O.a.sendAppErrorEvent(Object.assign(Object.assign({},n.hg),{message:"Didn't get valid JSON from response.",pb:Object.assign(Object.assign({},n.hg.pb),{fetchNetworkResponse:{activityId:c.b.ActivityId,requestUrl:j.href}})}));const k=(this.requestQueryParams.get(r.x.feedLayoutRequestType)||"").toLowerCase(),L="tabriver"===k||"tabs"===k,{nextPageUrl:F,feedItems:N}=this.requestQueryParams.get(r.x.responseSchema)===u.a.CardView?Object(I.c)(P,L):P;if(!N)return void O.a.sendAppErrorEvent(Object.assign(Object.assign({},n.gg),{message:"Didn't get valid feed items list from response.",pb:Object.assign(Object.assign({},n.gg.pb),{fetchNetworkResponse:{activityId:c.b.ActivityId,requestUrl:j.href,responseJson:JSON.stringify(P)}})}));if(!N.length&&!i.start)if(i.isSearchRequest)this.trackEmptyResponseForInterestSearch(i.feedId,i.query,j.href);else if(i.feedId){const{emptyResponseFeedIds:e}=this.config.initialRequest;t||i.feedId.startsWith("Q_")||e&&e.length&&-1!==e.indexOf(i.feedId)||this.trackEmptyResponseForXFeed(i.feedId,j.href)}else i.query?this.trackEmptyResponseForKidsMode(i.query,j.href):this.trackAppErrorHelper(n.eg,"OneService returned an empty feed for a myfeed request.",j.href,null,null,"",E,D);if(L)if("tabriver"===k){const e=N.find(e=>"tabbedInfopane"===e.type);e&&e.subItems&&e.subItems.length||O.a.sendAppErrorEvent(Object.assign(Object.assign({},n.Li),{pb:Object.assign(Object.assign({},n.Li.pb),{feedData:JSON.stringify(P),fetchNetworkResponse:{activityId:c.b.ActivityId,requestUrl:j.href,responseJson:JSON.stringify(P)}}),message:"TabRiver request returned empty content for tabbed infopane card."}))}else if("tabs"===k){let e=!1;e=!N.length||-1!==N.findIndex(e=>"tabbedInfopane"!==e.type||!e.subItems||!e.subItems.length),e&&O.a.sendAppErrorEvent(Object.assign(Object.assign({},n.Oi),{pb:Object.assign(Object.assign({},n.Oi.pb),{fetchNetworkResponse:{activityId:c.b.ActivityId,requestUrl:j.href,responseJson:JSON.stringify(P)}}),message:"Tabs request returned empty content for one or more tabbed infopane cards."}))}let U;if(N.length>=0?U=Object.assign(Object.assign({},i),{nextPageUrl:F,start:(i.start||0)+i.count}):a.a.log(`River has reached end of content stream. requested: ${i.count}, received: ${N.length}`),i.postRequestGrouping){const{start:e,count:t,type:s}=i.postRequestGrouping,n={type:s,subItems:N.splice(e,t)};N.splice(e,0,n)}const W={cardMetadata:N,nextPageRequest:U,sessionId:M};return this.responseCache.set(i,W),W}))}fetchFromWebWorker(e,t=1e3,i){return Object(A.a)()?Object(l.b)({id:e},t).then(e=>{const t=e.payload;if(!e.fetched||!t||!t.feedData)return null;t.responseSchema===u.a.CardView&&(t.feedData=Object(I.c)(t.feedData,t.isTabbedInfopaneResponse));const{nextPageUrl:s,feedItems:n=[]}=t.feedData;let a,r=this.config.initialRequest;if(i&&(r=Object.assign(Object.assign({},r),i)),s&&n.length&&(a=Object.assign(Object.assign({},r),{start:(r.start||0)+r.count,nextPageUrl:s})),r.postRequestGrouping){const{start:e,count:t,type:i}=r.postRequestGrouping,s={type:i,subItems:n.splice(e,t)};n.splice(e,0,s)}return{cardMetadata:n,nextPageRequest:a,sessionId:t.sessionId}}):Promise.resolve(null)}clearCache(){this.responseCache=new y}getRequestTimeout(e){const{timeoutMs:t,isSearchRequest:i,query:s,customFeedTimeoutMs:n}=e;return i&&s&&n?n:t}tryAddQueryInterestParams(e){if(!e.useVerticalAsInterest&&!e.useCategoryAsInterest)return!1;const t=(e.useVerticalAsInterest?h.b.ClientSettings.verticalKey:h.b.ClientSettings.categoryKey)||"",i=e.verticalCategoryKeyToInterestMapping[t.toLowerCase()],s=i||"news";return this.requestQueryParams.set(r.x.query,encodeURIComponent(s)).set(r.x.source,e.contentSource),i||e.useCategoryAsInterest&&!t||O.a.sendAppErrorEvent(Object.assign(Object.assign({},n.ig),{message:"Failed to get content",pb:Object.assign(Object.assign({},n.ig.pb),{customMessage:`Failed to get content for VerticalKey:${c.b.HostPage.verticalKey} | CategoryKey:${c.b.HostPage.categoryKey}. Loading fallback views river with ${s} content.`})})),!0}trackAppErrorHelper(e,t,i,s,n,a,r,o){let d="";s&&(d+=`Feed id: ${s}. `),n&&(d+=`Feed query: ${n}. `),O.a.sendAppErrorEvent(Object.assign(Object.assign({},e),{message:t,pb:Object.assign(Object.assign({},e.pb),{customMessage:d,fetchNetworkResponse:{activityId:c.b.ActivityId,requestUrl:i,responseJson:a,statusCode:r,statusText:o}})}))}trackEmptyResponseForKidsMode(e,t){this.trackAppErrorHelper(n.uc,"OneService returned an empty feed for kids mode",t,null,e)}trackEmptyResponseForXFeed(e,t){this.trackAppErrorHelper(n.tc,"OneService returned an empty feed for an x-feed page.",t,e,null)}trackEmptyResponseForInterestSearch(e,t,i){e?this.trackAppErrorHelper(n.vc,"OneService returned an empty feed for a user searched xfeed.",i,e,null):this.trackAppErrorHelper(n.wc,"OneService returned an empty feed for a user query.",i,null,t)}}w.providerName="OneService"},"uZl+":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return a}));var s=i("Am8i");const n={cancelTelemetryName:"Cancel",cardActionV2TelemetryName:"Card Action Ellipses",closeHeadlineTelemetryName:"Close dialog",closeModuleTelemetryName:"Dismiss",copyTelemetryName:"Copy",hideMenuItemTelemetryName:"Hide",hideHeadlineTelemetryName:"Hide Story",muteMenuItemTelemetryName:"MutePublisher",muteButtonTelemetryName:"Mute",muteConfirmationTelemetryName:"Hide Stories from Publisher",reportButtonTelemetryName:"Submit",reportCheckedTelemetryName:"Checked",reportDialogTelemetryName:"ReportedReason",reportHeadlineTelemetryName:"Report an issue",reportMenuItemTelemetryName:"ReportArticle",reportUncheckedTelemetryName:"Unchecked",reportDialogFeedbackTextTelemetryName:"Feedback",reportDialogPrivacyStatementTelemetryName:"Privacy Statement",saveMenuItemTelemetryName:"Save",showFewerHeadlineTelemetryName:"Fewer stories like this",showFewerMenuItemTelemetryName:"showFewer",showMoreHeadlineTelemetryName:"More stories like this",showMoreMenuItemTelemetryName:"showMore",shareArticleTelemetryName:"ShareArticle",shareDialogTelemetryName:"Share"};class a{constructor(e){if(this.componentRoot=e,this.mapSocialMediaShareIconTelemetry=(e,t,i,n={})=>(this.socialMediaShareIconTelemetryObjects[e]=this.shareDialogTelemetryObject.addOrUpdateChild({name:t,behavior:s.c.Navigate,action:s.b.Click,content:Object.assign(Object.assign({},n),{headline:i})},this.socialMediaShareIconTelemetryObjects[e]),this.socialMediaShareIconTelemetryObjects[e]),this.mapMenuItemTelemetry=(e,t,i,s,n,a)=>{if(this.componentRoot)return this.menuItemsTelemetryObjects[e]=this.componentRoot.addOrUpdateChild({name:e,type:t,behavior:i,content:Object.assign(Object.assign({},a),{headline:s||e,id:n})},this.menuItemsTelemetryObjects[e]),this.menuItemsTelemetryObjects[e]},this.getReportDialogActionButtonTelemetryObject=(e,t,i,a,r)=>(this.reportDialogTelemetryObjects.actionButtonTelemetryObject=this.reportDialogTelemetryObjects.dialogTelemetryObject.addOrUpdateChild({name:n.reportButtonTelemetryName,type:s.f.Report,behavior:s.c.Report,action:s.b.Submit,content:Object.assign({headline:i,id:a},r),ext:{fields:{checkedReportOption:e,feedbackText:t}}},this.reportDialogTelemetryObjects.actionButtonTelemetryObject),this.reportDialogTelemetryObjects.actionButtonTelemetryObject),!e)return;const t=e.contract.content||{},i=this.componentRoot.addOrUpdateChild({name:n.muteConfirmationTelemetryName,type:s.f.Interaction,behavior:s.c.Mute,content:Object.assign(Object.assign({},t),{headline:n.muteButtonTelemetryName}),action:s.b.View});this.muteDialogTelemetryObjects={dialogTelemetryObject:i,cancelButtonTelemetryObject:i.addOrUpdateChild({name:n.cancelTelemetryName,behavior:s.c.MuteCancel,content:Object.assign(Object.assign({},t),{headline:n.cancelTelemetryName})}),closeButtonTelemetryObject:i.addOrUpdateChild({name:n.closeModuleTelemetryName,behavior:s.c.Close,content:Object.assign(Object.assign({},t),{headline:n.closeHeadlineTelemetryName})}),actionButtonTelemetryObject:i.addOrUpdateChild({name:n.muteButtonTelemetryName,behavior:s.c.Mute,content:Object.assign(Object.assign({},t),{headline:n.hideMenuItemTelemetryName})})};const a=this.componentRoot.addOrUpdateChild({name:n.reportDialogTelemetryName,type:s.f.Interaction,behavior:s.c.Report,content:Object.assign(Object.assign({},t),{headline:n.reportHeadlineTelemetryName}),action:s.b.Click});this.reportDialogTelemetryObjects={dialogTelemetryObject:a,cancelButtonTelemetryObject:a.addOrUpdateChild({name:n.cancelTelemetryName,behavior:s.c.Cancel,content:Object.assign(Object.assign({},t),{headline:n.cancelTelemetryName})}),closeButtonTelemetryObject:a.addOrUpdateChild({name:n.closeModuleTelemetryName,behavior:s.c.Close,content:Object.assign(Object.assign({},t),{headline:n.closeHeadlineTelemetryName})}),actionButtonTelemetryObject:a.addOrUpdateChild({name:n.reportButtonTelemetryName,behavior:s.c.Mute,content:Object.assign(Object.assign({},t),{headline:t.headline})})},this.shareDialogTelemetryObject=this.componentRoot.addOrUpdateChild({name:n.shareDialogTelemetryName,type:s.f.Interaction,behavior:s.c.Share,content:Object.assign(Object.assign({},t),{headline:n.shareDialogTelemetryName}),action:s.b.Click}),this.articleShareTelemetryObject=this.shareDialogTelemetryObject.addOrUpdateChild({name:n.shareArticleTelemetryName,type:s.f.Headline,behavior:s.c.Navigate,content:Object.assign(Object.assign({},t),{headline:n.shareArticleTelemetryName})}),this.closeShareButtonTelemetryObject=this.shareDialogTelemetryObject.addOrUpdateChild({name:n.closeModuleTelemetryName,behavior:s.c.Close,action:s.b.Click,content:Object.assign(Object.assign({},t),{headline:n.closeHeadlineTelemetryName})}),this.copyShareButtonTelemetryObject=this.shareDialogTelemetryObject.addOrUpdateChild({name:n.copyTelemetryName,behavior:s.c.Share,action:s.b.Click,content:Object.assign(Object.assign({},t),{headline:n.copyTelemetryName})}),this.socialMediaShareIconTelemetryObjects={},this.menuItemsTelemetryObjects={},this.reportDialogPrivacyStatementLinkTelemetryObject=a.addOrUpdateChild({name:n.reportDialogPrivacyStatementTelemetryName,behavior:s.c.Navigate,content:Object.assign(Object.assign({},t),{headline:n.reportDialogPrivacyStatementTelemetryName})})}setTelemetryObjectContract(e,t,i){return e.contract&&(e.contract.content.id=t,e.contract.content.type=s.d.Article,e.contract.destinationUrl=i||""),e}}},"x/PH":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var s=i("D57K"),n=i("rvYQ"),a=i("msIb"),r=i("KETb"),o=i("XlyT"),c=i("HxRh"),d=i("X9Vi");class l{constructor(e,t){this.fetchImpl=e,this.config=t,this.ocid="Peregrine",this.localizeLocationApi="weather/locations/search"}getLocalisedLocationDetails(e){return Object(s.b)(this,void 0,void 0,(function*(){if(!d.b.isValid(e))return;const t=yield a.a.getBaseRequestData("GET"),i=[...a.a.getCommonParams2(this.ocid),{key:"lat",value:e.latitude},{key:"lon",value:e.longitude},{key:"locale",value:n.b.CurrentMarket}],h=new URL(`${this.localizeLocationApi}${n.b.ServiceUrlBase.search}`,n.b.ServiceUrlBase);let u;i.forEach(e=>{e.value&&h.searchParams.set(e.key,e.value)}),h.searchParams.delete("fdhead"),this.config&&this.config.noDynamicQueryParams&&(h.searchParams.delete("user"),h.searchParams.delete("activityId"));try{const i=yield Object(r.a)(()=>Object(s.b)(this,void 0,void 0,(function*(){const e=yield this.fetchImpl(h.href,t);if(!e.ok)throw u=`code=${e.status}, ${e.statusText}`,Error(e.statusText);return e.json()})),"getLocalizedLocation");return l.convertResponse(i,e,h.href)}catch(e){u||(u=e&&e.toString()),Object(o.c)(e,c.Pj,u+","+this.localizeLocationApi,h.href)}}))}static convertResponse(e,t,i){const s=e&&e.value&&e.value[0]&&e.value[0].responses||[],a=s[0]&&s[0].locations[0];let r=void 0;if(a&&(r={latitude:t.latitude,longitude:t.longitude,isDetected:t.isDetected,locality:a.locality,region:a.adminDistrict,subRegion:a.adminDistrict2,country:a.countryRegion,isoCode:a.countryCode,language:n.b.CurrentMarket},r.displayName=d.b.getDisplayName(r)),r&&r.displayName)return r;Object(o.b)(c.Pj,"unable to construct valid display name",i)}}},y4Tj:function(e,t){},zZnt:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return r})),i.d(t,"a",(function(){return o}));var s=i("Cj5D"),n=i("dTwT");const a={bingShoppingVisible:!0,moneyVisible:!0,sportsVisible:!0,weatherVisible:!0,horoscopeVisible:!0,onThisDayVisible:!0,electionsVisible:!0,esportsVisible:!0,lotteryVisible:!0,qnaVisible:!0},r="localCardState";function o(e,t){switch(e){case s.a.edgePageSettings:{const e=t,i=e?e.getCurrentState():void 0;return{weatherVisible:!(!i||!i.weatherVisible),sportsVisible:!(!i||!i.sportsVisible),moneyVisible:!(!i||!i.moneyVisible),bingShoppingVisible:!(!i||!i.bingShoppingVisible),horoscopeVisible:!(!i||!i.horoscopeVisible),onThisDayVisible:!(!i||!i.onThisDayVisible),electionsVisible:!(!i||!i.electionsVisible),esportsVisible:!(!i||!i.esportsVisible),lotteryVisible:!(!i||!i.lotteryVisible),qnaVisible:!(!i||!i.qnaVisible)}}case s.a.chromiumPageSettings:{const e=t,i=e?e.getCurrentState():void 0;return{weatherVisible:!!(i&&i.sdCardSettings&&i.sdCardSettings.weatherVisible),sportsVisible:!!(i&&i.sdCardSettings&&i.sdCardSettings.sportsVisible),moneyVisible:!!(i&&i.sdCardSettings&&i.sdCardSettings.moneyVisible),bingShoppingVisible:!!(i&&i.sdCardSettings&&i.sdCardSettings.bingShoppingVisible),horoscopeVisible:!!(i&&i.sdCardSettings&&i.sdCardSettings.horoscopeVisible),onThisDayVisible:!!(i&&i.sdCardSettings&&i.sdCardSettings.onThisDayVisible),electionsVisible:!!(i&&i.sdCardSettings&&i.sdCardSettings.electionsVisible),esportsVisible:!!(i&&i.sdCardSettings&&i.sdCardSettings.esportsVisible),lotteryVisible:!!(i&&i.sdCardSettings&&i.sdCardSettings.lotteryVisible),qnaVisible:!!(i&&i.sdCardSettings&&i.sdCardSettings.qnaVisible)}}case s.a.localStorageSettings:return Object(n.a)().supported?Object(n.a)().getObject(r,a):a;default:return}}}}]);